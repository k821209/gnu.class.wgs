<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGS 기초 이론 - WGS Data Characteristics</title>
    <style>

        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide.active { display: block; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #2980b9; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; }
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #27ae60; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #229954; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .table th { background: #f8f9fa; font-weight: bold; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .image-placeholder { width: 100%; height: 300px; background: #ecf0f1; border: 2px dashed #bdc3c7; display: flex; align-items: center; justify-content: center; color: #7f8c8d; font-size: 16px; margin: 20px 0; border-radius: 8px; }
    
    </style>
</head>
<body>

<div class="slide">
<div class="slide-title">WGS 데이터 특성 (25분)</div>
    <div class="slide-content">
        <h2>📊 FASTQ 포맷 구조</h2>
        <div class="code-block">
@시퀀스식별자 (Sequence Identifier)
ATCGATCGATCGATCG... (DNA 시퀀스)
+ (구분자)
IIIIIIIIIIIIIII... (품질 점수)
        </div>
        
        <h3>🔤 품질 점수 (Quality Score)</h3>
        <ul>
            <li><span class="highlight">Phred Score</span>: Q = -10 × log₁₀(P)</li>
            <li><span class="highlight">ASCII 인코딩</span>: 33-126 (Phred+33)</li>
            <li><span class="highlight">품질 기준</span>:
                <ul>
                    <li>Q30: 99.9% 정확도 (1/1000 오류율)</li>
                    <li>Q20: 99% 정확도 (1/100 오류율)</li>
                    <li>Q10: 90% 정확도 (1/10 오류율)</li>
                </ul>
            </li>
        </ul>

        <h3>📊 플랫폼별 Q30 성능 비교</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>플랫폼</th>
                    <th>Q30 비율</th>
                    <th>Q40 비율</th>
                    <th>특징</th>
                    <th>참조</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background: #e3f2fd;">
                    <td><strong>Illumina NovaSeq X</strong></td>
                    <td>>95%</td>
                    <td>>85% (Q40 bin >90%)</td>
                    <td>XLEAP-SBS chemistry, Q40 시대</td>
                    <td><small>Illumina v1.2 software 2024</small></td>
                </tr>
                <tr>
                    <td><strong>Illumina NovaSeq 6000</strong></td>
                    <td>85-90%</td>
                    <td>75-80%</td>
                    <td>안정적 성능</td>
                    <td><small>Illumina Specification</small></td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>MGI DNBSEQ-T7</strong></td>
                    <td>94.22%</td>
                    <td>>85%</td>
                    <td>StandardMPS 2.0 reagent</td>
                    <td><small>MGI AGBT 2024</small></td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>PacBio Revio HiFi</strong></td>
                    <td>90%</td>
                    <td>N/A</td>
                    <td>긴 읽기, >99.9% 정확도</td>
                    <td><small>PacBio Revio Spec 2024</small></td>
                </tr>
                <tr style="background: #f3e5f5;">
                    <td><strong>Oxford Nanopore</strong></td>
                    <td>40-70% (Duplex Q30), Q26-Q32 (Dorado v5)</td>
                    <td>N/A</td>
                    <td>R10.4.1 + Kit 14, Dorado v1.0</td>
                    <td><small>Dorado v5.2 models 2024</small></td>
                </tr>
            </tbody>
        </table>

        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #2196f3;">
                <h4>🏆 품질 순위 (Q30 기준)</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>1위</strong>: Illumina NovaSeq X (>95% Q30)</li>
                    <li><strong>2위</strong>: MGI DNBSEQ-T7 (94.22% Q30)</li>
                    <li><strong>3위</strong>: PacBio Revio HiFi (90% Q30)</li>
                    <li><strong>4위</strong>: Illumina NovaSeq 6000 (85-90% Q30)</li>
                    <li><strong>5위</strong>: Oxford Nanopore (40-70% Duplex Q30)</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #ff9800;">
                <h4>💰 비용 대비 품질</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>최고</strong>: MGI DNBSEQ</li>
                    <li><strong>우수</strong>: Illumina NovaSeq 6000</li>
                    <li><strong>프리미엄</strong>: Illumina NovaSeq X</li>
                    <li><strong>특수용도</strong>: PacBio, Oxford Nanopore</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #4caf50;">
                <h4>🎯 권장 사용처</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>일반 WGS</strong>: MGI, Illumina</li>
                    <li><strong>고정밀 분석</strong>: NovaSeq X, PacBio</li>
                    <li><strong>긴 읽기 필요</strong>: PacBio, Nanopore</li>
                    <li><strong>실시간 분석</strong>: Oxford Nanopore</li>
                </ul>
            </div>
        </div>

        <h3>🔬 Oxford Nanopore 최신 Basecaller 업데이트</h3>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #9c27b0;">
                <h4>🚀 Dorado v1.0 (2024)</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>v5.2 모델</strong>: 최고 정확도 달성</li>
                    <li><strong>SUP + Duplex</strong>: Q32 (99.93%) 정확도</li>
                    <li><strong>Simplex</strong>: Q26 (99.75%) 정확도</li>
                    <li><strong>속도 개선</strong>: 2-3배 향상 (vs Guppy)</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #ff5722;">
                <h4>⚡ Basecaller 모델 비교</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>Fast</strong>: 빠른 속도, 기본 정확도</li>
                    <li><strong>HAC</strong>: 속도-정확도 균형</li>
                    <li><strong>SUP</strong>: 최고 정확도, 높은 연산량</li>
                    <li><strong>Duplex</strong>: Q30+ 달성 가능</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #795548;">
                <h4>📈 정확도 발전 추이</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>2023</strong>: Q20+ 달성 (99%)</li>
                    <li><strong>2024</strong>: Q26-Q32 달성</li>
                    <li><strong>Duplex</strong>: Q30 일관성 확보</li>
                    <li><strong>목표</strong>: Duplex 75% 비율</li>
                </ul>
            </div>
        </div>

        <h3>🔄 Duplex 시퀀싱 정의 및 현황</h3>
        <div style="background: #e8f5e8; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #2e7d32; margin-top: 0;">💡 Duplex 시퀀싱이란?</h4>
            <p style="margin: 10px 0; font-size: 16px;">
                <strong>Duplex 시퀀싱</strong>은 DNA의 <strong>양쪽 가닥(template + complement strand)</strong>을 모두 시퀀싱하여 
                <strong>consensus basecall</strong>을 생성하는 기술입니다. 이를 통해 Q30 (99.9%) 정확도를 달성할 수 있습니다.
            </p>
            
            <div class="comparison-table" style="margin-top: 15px;">
                <div class="comparison-item" style="border-left-color: #4caf50;">
                    <h4>🔬 Duplex 현재 성능 (2024)</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>일반적</strong>: 40% duplex rate</li>
                        <li><strong>최고 달성</strong>: 50-70% duplex rate</li>
                        <li><strong>연구 예시</strong>: >70% (E.coli dataset)</li>
                        <li><strong>최장 duplex</strong>: 146kb Q30 달성</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #ff9800;">
                    <h4>🧬 Single Cell에서의 Duplex</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>권장 모델</strong>: SUP basecalling</li>
                        <li><strong>적용 분야</strong>: 저빈도 변이 분석</li>
                        <li><strong>준비 시간</strong>: 3시간 (short read 불필요)</li>
                        <li><strong>분석 파이프라인</strong>: wf-single-cell</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #9c27b0;">
                    <h4>⚡ Kit 14 개선사항</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Motor protein</strong>: 업그레이드</li>
                        <li><strong>Nanopore</strong>: 개선된 pore 디자인</li>
                        <li><strong>Second strand</strong>: 향상된 capture 율</li>
                        <li><strong>Transformer 모델</strong>: 새로운 basecalling 구조</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>❓ Duplex Rate의 의미</h3>
        <div style="background: #fff3e0; border: 2px solid #ff9800; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #e65100; margin-top: 0;">🤔 왜 모든 reads가 duplex가 되지 않을까?</h4>
            
            <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 15px 0;">
                <h5 style="color: #2e7d32; margin-top: 0;">🧬 Duplex 조건:</h5>
                <p style="margin: 5px 0; font-size: 14px;">
                    동일한 DNA 분자의 <strong>양쪽 가닥</strong>이 <strong>같은 nanopore</strong>를 통과해야 함:<br>
                    1️⃣ Template strand가 먼저 통과<br>
                    2️⃣ Complement strand가 바로 이어서 통과<br>
                    3️⃣ 두 신호가 성공적으로 페어링되어 consensus 생성
                </p>
                
                <div style="text-align: center; margin: 15px 0;">
                    <img src="data/nanopore_duplex.png" alt="Oxford Nanopore Duplex Sequencing Process" 
                         style="max-width: 100%; height: auto; border: 1px solid #ddd; border-radius: 5px;">
                    <p style="font-size: 12px; color: #666; margin: 5px 0;">
                        <em>Oxford Nanopore Duplex 시퀀싱 과정: Template과 Complement strand의 연속적 통과</em><br>
                        <strong>출처:</strong> <a href="https://nanoporetech.com/document/kit-14-device-and-informatics" target="_blank" style="color: #2980b9;">Kit 14 sequencing and duplex basecalling - Oxford Nanopore Technologies</a>
                    </p>
                </div>
            </div>
            
            <div class="comparison-table" style="margin-top: 15px;">
                <div class="comparison-item" style="border-left-color: #f44336;">
                    <h4>❌ Duplex 실패 원인</h4>
                    <ul style="font-size: 13px; margin: 0; padding-left: 20px;">
                        <li><strong>Second strand 손실</strong>: 보체 가닥이 따라오지 않음</li>
                        <li><strong>Pore 막힘</strong>: 두 번째 가닥 전에 nanopore 차단</li>
                        <li><strong>DNA 단편화</strong>: 라이브러리 준비 중 가닥 분리</li>
                        <li><strong>Motor protein 실패</strong>: 두 번째 가닥 가이드 실패</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #2196f3;">
                    <h4>📊 현재 성공률</h4>
                    <ul style="font-size: 13px; margin: 0; padding-left: 20px;">
                        <li><strong>40% duplex</strong>: 10개 중 4개만 duplex 성공</li>
                        <li><strong>60% simplex</strong>: 10개 중 6개는 단일 가닥</li>
                        <li><strong>목표 75%</strong>: 10개 중 7.5개 duplex 달성</li>
                        <li><strong>품질 차이</strong>: Duplex Q30 vs Simplex Q20+</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #4caf50;">
                    <h4>⚡ Kit 14 개선</h4>
                    <ul style="font-size: 13px; margin: 0; padding-left: 20px;">
                        <li><strong>향상된 Motor protein</strong>: 더 나은 가닥 가이드</li>
                        <li><strong>개선된 Pore</strong>: 안정적인 이중 가닥 포획</li>
                        <li><strong>새로운 Chemistry</strong>: 가닥 분리 감소</li>
                        <li><strong>Transformer 모델</strong>: 더 정확한 페어링</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; margin-top: 15px;">
                <p style="margin: 0; font-size: 14px; color: #1976d2;">
                    <strong>💡 핵심:</strong> Duplex rate는 전체 데이터 중 <strong>고정밀도(Q30)</strong>를 얻을 수 있는 
                    비율을 의미합니다. 나머지는 표준 정확도(Q20+)로 처리됩니다.
                </p>
            </div>
        </div>

        <h3>📚 참고 문헌 및 데이터 출처 (2024년 웹 검색 기반)</h3>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; font-size: 14px; margin: 20px 0;">
            <ul style="margin: 0; padding-left: 20px;">
                <li><strong>Illumina NovaSeq X Q40 Data</strong>: XLEAP-SBS chemistry enables Q40 and above data quality
                    <br><a href="https://www.illumina.com/science/genomics-research/articles/data-quality-q-scores.html" target="_blank" style="color: #2980b9;">https://www.illumina.com/science/genomics-research/articles/data-quality-q-scores.html</a></li>
                <li><strong>NovaSeq X v1.2 Software</strong>: NovaSeq X v1.2 software enables sequencing with 80% of bases >= Q40
                    <br><a href="https://www.illumina.com/systems/sequencing-platforms/novaseq-x-plus/specifications.html" target="_blank" style="color: #2980b9;">https://www.illumina.com/systems/sequencing-platforms/novaseq-x-plus/specifications.html</a></li>
                <li><strong>MGI DNBSEQ-T7 StandardMPS 2.0</strong>: DNBSEQ sequencing platform comprehensively supports WGS with Q40 data
                    <br><a href="https://en.mgi-tech.com/news/439/" target="_blank" style="color: #2980b9;">https://en.mgi-tech.com/news/439/</a></li>
                <li><strong>PacBio Revio HiFi Performance</strong>: 90% of bases achieve Q30 or higher quality
                    <br><a href="https://www.pacb.com/revio/" target="_blank" style="color: #2980b9;">https://www.pacb.com/revio/</a></li>
                <li><strong>Oxford Nanopore R10.4.1 Duplex</strong>: Q30 nanopore single molecule reads with Duplex technology
                    <br><a href="https://nanoporetech.com/news/news-oxford-nanopore-tech-update-new-duplex-method-q30-nanopore-single-molecule-reads-0" target="_blank" style="color: #2980b9;">https://nanoporetech.com/news/news-oxford-nanopore-tech-update-new-duplex-method-q30-nanopore-single-molecule-reads-0</a></li>
                <li><strong>Oxford Nanopore Accuracy Overview</strong>: Nanopore sequencing accuracy information
                    <br><a href="https://nanoporetech.com/platform/accuracy" target="_blank" style="color: #2980b9;">https://nanoporetech.com/platform/accuracy</a></li>
                <li><strong>Dorado Basecaller GitHub</strong>: Oxford Nanopore's Basecaller with v5.2 models
                    <br><a href="https://github.com/nanoporetech/dorado" target="_blank" style="color: #2980b9;">https://github.com/nanoporetech/dorado</a></li>
                <li><strong>Dorado v1.0 Release</strong>: Latest basecaller with improved accuracy
                    <br><a href="https://github.com/nanoporetech/dorado/releases" target="_blank" style="color: #2980b9;">https://github.com/nanoporetech/dorado/releases</a></li>
            </ul>
        </div>
    </div>
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToFirst()">🏠 처음</button>
    <button class="nav-btn" onclick="prevSlide()">◀ 이전</button>
    <button class="nav-btn" onclick="nextSlide()">다음 ▶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶ 전체화면</button>
</div>

<div class="slide-number">슬라이드 15 / 21</div>

<script>
    function prevSlide() {
        window.location.href = "slide14.html";
    }
    
    function nextSlide() {
        window.location.href = "slide16.html";
    }
    
    function jumpToFirst() {
        window.location.href = "slide01.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToFirst();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
</script>

</body>
</html>