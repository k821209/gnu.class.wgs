<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGS 기초 이론 - Sequencing Errors</title>
    <style>

        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide.active { display: block; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #2980b9; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; }
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #27ae60; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #229954; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .table th { background: #f8f9fa; font-weight: bold; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .image-placeholder { width: 100%; height: 300px; background: #ecf0f1; border: 2px dashed #bdc3c7; display: flex; align-items: center; justify-content: center; color: #7f8c8d; font-size: 16px; margin: 20px 0; border-radius: 8px; }
    
    </style>
</head>
<body>

<div class="slide">
<div class="slide-title">Hybrid Assembly 전략</div>
    <div class="slide-content">
        <h2>⚠️ 주요 에러 유형</h2>
        
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4>치환 에러 (Substitution)</h4>
                <ul style="font-size: 14px;">
                    <li>A → T, G → C 등</li>
                    <li>가장 흔한 에러</li>
                    <li>Illumina에서 주로 발생</li>
                    <li>SNP 호출에 영향</li>
                </ul>
            </div>
            <div class="comparison-item" style="border-left-color: #f39c12;">
                <h4>삽입/결실 에러 (Indel)</h4>
                <ul style="font-size: 14px;">
                    <li>염기 삽입 또는 삭제</li>
                    <li>동일 염기 반복 구간</li>
                    <li>PacBio/Nanopore에서 많음</li>
                    <li>프레임시프트 변이 유발</li>
                </ul>
            </div>
            <div class="comparison-item" style="border-left-color: #9b59b6;">
                <h4>🔗 Homopolymer 문제</h4>
                <ul style="font-size: 14px;">
                    <li><strong>AAAA, TTTT, GGGG</strong> 등</li>
                    <li>길이 판정 어려움</li>
                    <li>Long-read의 주요 약점</li>
                    <li>Hybrid로 해결 가능</li>
                </ul>
            </div>
        </div>

        <h3>🔗 Homopolymer 에러의 특징</h3>
        <div style="background: #fff3e0; border: 2px solid #ff9800; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #e65100; margin-top: 0;">⚠️ Homopolymer란?</h4>
            <p style="margin: 10px 0; font-size: 16px;">
                <strong>동일한 염기가 연속으로 반복되는 서열</strong> (예: AAAAA, TTTTTT, GGGGG, CCCCCC)
            </p>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f5f5f5; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #c0392b; margin-top: 0;">❌ 문제점</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>길이 측정 오류</strong>: A₅ vs A₆ 구분 어려움</li>
                        <li><strong>삽입/결실 에러</strong>: 반복 수 잘못 계산</li>
                        <li><strong>조립 오류</strong>: 잘못된 contig 연결</li>
                        <li><strong>변이 호출 실패</strong>: 진짜 변이 놓침</li>
                    </ul>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #27ae60; margin-top: 0;">✅ 해결 방법</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Transformer Basecaller</strong>: ONT 2024 혁신</li>
                        <li><strong>R10.4.1 Nanopore</strong>: 이중 리더 시스템</li>
                        <li><strong>Hybrid Assembly</strong>: Short-read로 교정</li>
                        <li><strong>Consensus 알고리즘</strong>: 다중 읽기 비교</li>
                        <li><strong>특화 도구</strong>: Homopolymer 전용 교정</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>📊 플랫폼별 Homopolymer 에러율</h3>
        <table class="table" style="font-size: 14px;">
            <thead>
                <tr>
                    <th>플랫폼</th>
                    <th>Homopolymer 에러율</th>
                    <th>주요 문제 길이</th>
                    <th>해결 방법</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background: #e3f2fd;">
                    <td><strong>Illumina</strong></td>
                    <td>낮음 (~0.1%)</td>
                    <td>긴 homopolymer (>8bp)</td>
                    <td>일반적으로 문제없음</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>MGI DNBSEQ</strong></td>
                    <td>낮음 (~0.1%)</td>
                    <td>긴 homopolymer (>8bp)</td>
                    <td>Illumina와 유사</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>PacBio CLR</strong></td>
                    <td>높음 (~15%)</td>
                    <td>4bp 이상</td>
                    <td>CCS/HiFi로 개선</td>
                </tr>
                <tr style="background: #ffe8e8;">
                    <td><strong>PacBio HiFi</strong></td>
                    <td>낮음 (~0.1%)</td>
                    <td>매우 긴 homopolymer</td>
                    <td>Consensus 통해 해결</td>
                </tr>
                <tr style="background: #f3e5f5;">
                    <td><strong>Oxford Nanopore (기존)</strong></td>
                    <td>높음 (~5-10%)</td>
                    <td>3bp 이상</td>
                    <td>Duplex/Consensus 필요</td>
                </tr>
                <tr style="background: #e8f4e8;">
                    <td><strong>Oxford Nanopore (Transformer)</strong></td>
                    <td>개선됨 (~1-3%)</td>
                    <td>5bp 이상</td>
                    <td>단독으로도 상당히 개선</td>
                </tr>
            </tbody>
        </table>

        <h3>🧠 Oxford Nanopore Transformer Basecaller (2024)</h3>
        <div style="background: #e8f4fd; border: 2px solid #2196f3; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #1976d2; margin-top: 0;">🚀 Transformer 모델의 Homopolymer 개선</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2c3e50; margin-top: 0;">🔬 기술적 개선사항</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Q26 정확도</strong>: 99.75% simplex 달성</li>
                        <li><strong>R10.4.1 이중 리더</strong>: 더 많은 염기 정보</li>
                        <li><strong>신호 전체 활용</strong>: 전체 시퀀스 컨텍스트</li>
                        <li><strong>Neural architecture</strong>: RNN + Transformer</li>
                    </ul>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #27ae60; margin-top: 0;">📈 Homopolymer 성능</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>에러율 감소</strong>: 5-10% → 1-3%</li>
                        <li><strong>문제 길이 증가</strong>: 3bp → 5bp+</li>
                        <li><strong>T2T 게놈</strong>: 단일 플로우셀 가능</li>
                        <li><strong>단독 사용</strong>: Hybrid 없이도 개선</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 5px; margin-top: 15px;">
                <p style="margin: 0; font-size: 14px; color: #e65100;">
                    <strong>💡 핵심:</strong> 2024년 Oxford Nanopore의 Transformer basecaller는 homopolymer 정확도를 
                    획기적으로 개선하여 단독으로도 고품질 게놈 조립이 가능해졌습니다.
                </p>
            </div>
        </div>

        <h2>🔗 Hybrid Assembly 전략</h2>
        
        <h3>💡 Hybrid Assembly란?</h3>
        <p style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 15px 0;">
            <strong>Hybrid Assembly</strong>는 <strong>Long-read</strong>의 연속성과 <strong>Short-read</strong>의 정확도를 
            결합하여 최고 품질의 게놈 조립을 달성하는 방법입니다.
        </p>

        <h3>🛠️ 두 가지 주요 전략</h3>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #3498db;">
                <h4>📈 Assembly → Correction</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>1단계</strong>: Long-read로 초기 조립</li>
                    <li><strong>2단계</strong>: Short-read로 오류 교정</li>
                    <li><strong>장점</strong>: 빠른 처리, 단순한 파이프라인</li>
                    <li><strong>도구</strong>: Flye + Pilon</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4>🔧 Correction → Assembly</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>1단계</strong>: Short-read로 Long-read 교정</li>
                    <li><strong>2단계</strong>: 교정된 Long-read 조립</li>
                    <li><strong>장점</strong>: 높은 정확도</li>
                    <li><strong>도구</strong>: LoRDEC + Canu</li>
                </ul>
            </div>
        </div>

        <h3>🔬 주요 Hybrid Assembly 도구 (2024)</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>도구</th>
                    <th>전략</th>
                    <th>특징</th>
                    <th>성능</th>
                    <th>권장 용도</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background: #e3f2fd;">
                    <td><strong>Hybracter</strong></td>
                    <td>Long-read first</td>
                    <td>자동화, 고정밀</td>
                    <td>Unicycler보다 빠름</td>
                    <td>세균 게놈</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>NextDenovo</strong></td>
                    <td>Error correction</td>
                    <td>고효율 교정</td>
                    <td>높은 정확도</td>
                    <td>Noisy long reads</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>HASLR</strong></td>
                    <td>Hybrid</td>
                    <td>빠른 속도</td>
                    <td>최소 misassembly</td>
                    <td>빠른 조립</td>
                </tr>
                <tr style="background: #f3e5f5;">
                    <td><strong>LongStitch</strong></td>
                    <td>Scaffolding</td>
                    <td>확장성</td>
                    <td>높은 연속성</td>
                    <td>대형 게놈</td>
                </tr>
                <tr style="background: #fce4ec;">
                    <td><strong>hybridSPAdes</strong></td>
                    <td>Synergy</td>
                    <td>적은 long-read</td>
                    <td>정확한 조립</td>
                    <td>제한된 데이터</td>
                </tr>
                <tr style="background: #e1f5fe;">
                    <td><strong>hifiasm</strong></td>
                    <td>PacBio HiFi 특화</td>
                    <td>단상형/이배체</td>
                    <td>최고 연속성</td>
                    <td>HiFi 전용</td>
                </tr>
                <tr style="background: #f3e5f5;">
                    <td><strong>FALCON</strong></td>
                    <td>PacBio CLR 특화</td>
                    <td>고속, 확장성</td>
                    <td>대형 게놈</td>
                    <td>CLR/legacy</td>
                </tr>
            </tbody>
        </table>

        <h3>⚡ Polishing & Correction 도구</h3>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #2196f3;">
                <h4>📊 Short-read Polishing</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>Pilon</strong>: 가장 널리 사용</li>
                    <li><strong>POLCA</strong>: MaSuRCA 내장</li>
                    <li><strong>NextPolish</strong>: 빠른 처리</li>
                    <li><strong>목적</strong>: SNP/Indel 교정</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #4caf50;">
                <h4>🧬 Long-read Assembly</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>hifiasm</strong>: PacBio HiFi 최적화</li>
                    <li><strong>FALCON</strong>: PacBio CLR 전용</li>
                    <li><strong>Flye</strong>: 범용 long-read</li>
                    <li><strong>Canu</strong>: 전통적 선택</li>
                    <li><strong>목적</strong>: 고품질 contig 생성</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #ff9800;">
                <h4>🔄 Error Correction</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>LoRDEC</strong>: Long-read 교정</li>
                    <li><strong>Canu</strong>: 자체 교정 기능</li>
                    <li><strong>NECAT</strong>: 효율적 조립</li>
                    <li><strong>목적</strong>: 사전 오류 제거</li>
                </ul>
            </div>
        </div>

        <h3>🔄 Hybrid Assembly 워크플로우</h3>
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #2c3e50; margin-top: 0;">📋 전형적인 파이프라인</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h5 style="color: #3498db;">Assembly → Correction</h5>
                    <ol style="font-size: 14px;">
                        <li>Long-read 품질 확인 (FastQC)</li>
                        <li>Long-read 조립 (hifiasm/Flye/Canu)</li>
                        <li>Short-read mapping (BWA/Minimap2)</li>
                        <li>오류 교정 (Pilon/NextPolish)</li>
                        <li>최종 검증 (BUSCO/QUAST)</li>
                    </ol>
                </div>
                <div>
                    <h5 style="color: #e74c3c;">Correction → Assembly</h5>
                    <ol style="font-size: 14px;">
                        <li>Short-read 전처리 (Trimmomatic)</li>
                        <li>Long-read 교정 (LoRDEC/Canu)</li>
                        <li>교정된 read 조립 (Canu/Flye)</li>
                        <li>추가 polishing (Racon/Medaka)</li>
                        <li>최종 검증 (BUSCO/QUAST)</li>
                    </ol>
                </div>
            </div>
        </div>

        <h3>🎯 hifiasm: PacBio HiFi 전용 조립기</h3>
        <div style="background: #e8f4fd; border: 2px solid #2196f3; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #1976d2; margin-top: 0;">🚀 hifiasm의 특징과 성능</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2c3e50; margin-top: 0;">🔬 핵심 기능</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>HiFi 최적화</strong>: PacBio HiFi 전용 설계</li>
                        <li><strong>단상형 조립</strong>: Haplotype-resolved</li>
                        <li><strong>빠른 속도</strong>: 효율적 알고리즘</li>
                        <li><strong>높은 연속성</strong>: 긴 contig 생성</li>
                    </ul>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #27ae60; margin-top: 0;">📈 성능 지표</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>N50</strong>: 40-100 Mb 달성</li>
                        <li><strong>정확도</strong>: >99.9%</li>
                        <li><strong>속도</strong>: 수 시간 내 완료</li>
                        <li><strong>메모리</strong>: 상대적으로 효율적</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 5px; margin-top: 15px;">
                <p style="margin: 0; font-size: 14px; color: #e65100;">
                    <strong>💡 핵심:</strong> hifiasm은 PacBio HiFi 데이터에 특화되어 설계된 조립기로, 
                    단상형 분해능과 높은 연속성을 동시에 달성할 수 있는 최신 도구입니다.
                </p>
            </div>
        </div>

        <h3>🦅 FALCON: PacBio CLR 전용 조립기</h3>
        <div style="background: #fce4ec; border: 2px solid #e91e63; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #c2185b; margin-top: 0;">🚀 FALCON의 특징과 역할</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2c3e50; margin-top: 0;">🔬 핵심 기능</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>CLR 특화</strong>: PacBio CLR 전용 설계</li>
                        <li><strong>에러 교정</strong>: 내장 error correction</li>
                        <li><strong>확장성</strong>: 대형 게놈 지원</li>
                        <li><strong>분산 처리</strong>: 병렬 연산 최적화</li>
                    </ul>
                </div>
                <div style="background: #fff3e0; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #e65100; margin-top: 0;">📈 성능 특성</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>속도</strong>: 고속 처리</li>
                        <li><strong>메모리</strong>: 효율적 사용</li>
                        <li><strong>정확도</strong>: CLR 대비 우수</li>
                        <li><strong>현재 상태</strong>: Legacy tool</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #ffebee; padding: 15px; border-radius: 5px; margin-top: 15px;">
                <p style="margin: 0; font-size: 14px; color: #c62828;">
                    <strong>⚠️ 주의:</strong> FALCON은 PacBio CLR 데이터를 위해 개발된 도구로, 
                    현재는 HiFi 데이터가 주류가 되면서 주로 legacy 시스템에서 사용됩니다.
                </p>
            </div>
        </div>

        <h3>🔄 PacBio 기술 진화: FALCON → hifiasm</h3>
        <div style="background: #f0f4c3; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #827717; margin-top: 0;">📅 PacBio 조립 도구의 발전</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #ffcdd2; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #c62828; margin-top: 0;">🦅 FALCON 시대 (2015-2020)</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>대상</strong>: PacBio CLR (15% 에러율)</li>
                        <li><strong>전략</strong>: 강력한 error correction</li>
                        <li><strong>특징</strong>: 분산 처리, 확장성</li>
                        <li><strong>성과</strong>: 첫 long-read 인간 게놈</li>
                    </ul>
                </div>
                <div style="background: #c8e6c9; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2e7d32; margin-top: 0;">🎯 hifiasm 시대 (2020-현재)</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>대상</strong>: PacBio HiFi (0.1% 에러율)</li>
                        <li><strong>전략</strong>: 단상형 분해능</li>
                        <li><strong>특징</strong>: 빠른 속도, T2T 가능</li>
                        <li><strong>성과</strong>: 인간 pangenome 표준</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>🛠️ 기존 에러 보정 방법</h3>
        <ul>
            <li><span class="highlight">품질 필터링</span>: 낮은 품질 읽기 제거</li>
            <li><span class="highlight">트리밍</span>: 읽기 끝부분 제거</li>
            <li><span class="highlight">에러 보정</span>: 알고리즘 기반 보정</li>
        </ul>
    </div>
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToFirst()">🏠 처음</button>
    <button class="nav-btn" onclick="prevSlide()">◀ 이전</button>
    <button class="nav-btn" onclick="nextSlide()">다음 ▶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶ 전체화면</button>
</div>

<div class="slide-number">슬라이드 17 / 21</div>

<script>
    function prevSlide() {
        window.location.href = "slide16.html";
    }
    
    function nextSlide() {
        window.location.href = "slide18.html";
    }
    
    function jumpToFirst() {
        window.location.href = "slide01.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToFirst();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
</script>

</body>
</html>