<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGS 기초 이론 - FastQC Report Analysis</title>
    <style>

        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide.active { display: block; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #2980b9; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; }
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #27ae60; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #229954; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .table th { background: #f8f9fa; font-weight: bold; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .image-placeholder { width: 100%; height: 300px; background: #ecf0f1; border: 2px dashed #bdc3c7; display: flex; align-items: center; justify-content: center; color: #7f8c8d; font-size: 16px; margin: 20px 0; border-radius: 8px; }
    
    </style>
</head>
<body>

<div class="slide">
<div class="slide-title">FastQC 리포트 분석</div>
    <div class="slide-content">
        <h2>📈 FastQC 주요 분석 항목</h2>
        
        <table class="table">
            <thead>
                <tr>
                    <th>분석 항목</th>
                    <th>상태</th>
                    <th>정상 기준</th>
                    <th>주의 사항</th>
                    <th>설명</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background: #e8f5e8;">
                    <td><strong>Basic Statistics</strong></td>
                    <td>🟢 PASS</td>
                    <td>기본 정보 요약</td>
                    <td>파일 크기, 총 서열 수</td>
                    <td>전체 데이터셋의 기본 통계 정보</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Per base sequence quality</strong></td>
                    <td>🟢 PASS</td>
                    <td>Q30 이상</td>
                    <td>읽기 끝부분 품질 저하</td>
                    <td>각 위치별 품질 점수 분포</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>Per tile sequence quality</strong></td>
                    <td>⚠️ WARNING</td>
                    <td>타일 간 균등</td>
                    <td>특정 타일 품질 저하</td>
                    <td>플로우셀 타일별 품질 편차</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Per sequence quality scores</strong></td>
                    <td>🟢 PASS</td>
                    <td>Q20 이상 대부분</td>
                    <td>이중 봉우리 패턴</td>
                    <td>전체 서열의 평균 품질 분포</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>Per base sequence content</strong></td>
                    <td>⚠️ WARNING</td>
                    <td>A=T, G=C 비슷</td>
                    <td>첫 10bp 편향, 어댑터</td>
                    <td>각 위치별 A, T, G, C 비율</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Per sequence GC content</strong></td>
                    <td>🟢 PASS</td>
                    <td>예상 GC% 근사</td>
                    <td>GC 편향, 오염</td>
                    <td>전체 서열의 GC 함량 분포</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Per base N content</strong></td>
                    <td>🟢 PASS</td>
                    <td>5% 미만</td>
                    <td>높은 N 비율</td>
                    <td>각 위치별 미결정 염기(N) 비율</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Sequence Length Distribution</strong></td>
                    <td>🟢 PASS</td>
                    <td>예상 길이 범위</td>
                    <td>길이 편차</td>
                    <td>서열 길이의 분포 패턴</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>Sequence Duplication Levels</strong></td>
                    <td>⚠️ WARNING</td>
                    <td>70% 이하</td>
                    <td>PCR 증폭 bias, 오염</td>
                    <td>중복 서열의 비율과 패턴</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Overrepresented sequences</strong></td>
                    <td>🟢 PASS</td>
                    <td>0.1% 미만</td>
                    <td>어댑터, 프라이머 오염</td>
                    <td>과도하게 나타나는 특정 서열</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>Adapter Content</strong></td>
                    <td>🟢 PASS</td>
                    <td>0%</td>
                    <td>어댑터 오염</td>
                    <td>시퀀싱 어댑터의 잔존 비율</td>
                </tr>
            </tbody>
        </table>

        <h3>🔬 롱리드(Long Read) 플랫폼을 위한 QC 툴</h3>
        <p style="font-size: 16px; margin-bottom: 20px;">
            FastQC는 단일 염기 오류율이 낮은 숏리드(short-read) 데이터에 최적화되어 있습니다. PacBio나 Oxford Nanopore 같은 롱리드(long-read) 플랫폼은 고유한 특성(예: 긴 길이, 높은 오류율, homopolymer 문제)을 가지므로, 전용 QC 툴을 사용하는 것이 더 효과적입니다.
        </p>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #9c27b0;">
                <h4>📊 NanoPlot</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>플랫폼:</strong> Oxford Nanopore</li>
                    <li><strong>특징:</strong> FASTQ 또는 시퀀싱 요약 파일에서 통계 생성</li>
                    <li>리드 길이, 품질 분포 등 다양한 시각화 제공</li>
                    <li>HTML 리포트, 로그 파일, 다양한 그래프 이미지 생성</li>
                    <li>실행이 간편하고 가장 널리 사용됨</li>
                </ul>
                <footer style="font-size: 10px; margin-top: 10px; color: #666;">
                    De Coster, W. et al. (2018) Bioinformatics. <a href="https://doi.org/10.1093/bioinformatics/bty149" target="_blank">doi:10.1093/bioinformatics/bty149</a>
                </footer>
            </div>
            
            <div class="comparison-item" style="border-left-color: #e91e63;">
                <h4>📈 PycoQC</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>플랫폼:</strong> Oxford Nanopore</li>
                    <li><strong>특징:</strong> 실시간 QC에 초점</li>
                    <li>MinKNOW가 생성하는 `sequencing_summary.txt` 파일 기반</li>
                    <li>시간 경과에 따른 채널 활성, 처리량 등 모니터링</li>
                    <li>대화형(interactive) HTML 리포트 생성</li>
                </ul>
                <footer style="font-size: 10px; margin-top: 10px; color: #666;">
                    Leger, A. & Leonardi, T. (2019) JOSS. <a href="https://doi.org/10.21105/joss.01236" target="_blank">doi:10.21105/joss.01236</a>
                </footer>
            </div>
            
            <div class="comparison-item" style="border-left-color: #4caf50;">
                <h4>🧬 LongQC</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>플랫폼:</strong> PacBio & Oxford Nanopore</li>
                    <li><strong>특징:</strong> 범용 롱리드 QC 툴</li>
                    <li>GC 함량, homopolymer 정확도, 키메라 리드 등 평가</li>
                    <li>플랫폼별 특화된 지표 제공</li>
                    <li>샘플 간 비교 기능 포함</li>
                </ul>
                <footer style="font-size: 10px; margin-top: 10px; color: #666;">
                    Fukasawa, Y. et al. (2020) G3. <a href="https://doi.org/10.1534/g3.119.400864" target="_blank">doi:10.1534/g3.119.400864</a>
                </footer>
            </div>
        </div>

        <h3>📊 Sequence Duplication Levels 상세 분석</h3>
        <div style="background: #fff3e0; border: 2px solid #ff9800; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #e65100; margin-top: 0;">⚠️ Sequence Duplication이란?</h4>
            <p style="margin: 10px 0; font-size: 16px;">
                <strong>완전히 동일한 전체 서열(entire read sequence)이 여러 번 나타나는 현상</strong>으로, 생물학적 원인과 기술적 원인으로 구분됩니다.
            </p>
            
            <div style="background: #e3f2fd; border: 1px solid #2196f3; padding: 15px; border-radius: 5px; margin: 15px 0;">
                <h5 style="color: #1976d2; margin-top: 0;">🔍 FastQC가 측정하는 것</h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background: #e8f5e8; padding: 10px; border-radius: 3px;">
                        <h6 style="color: #2e7d32; margin: 0 0 5px 0;">✅ FastQC 측정 대상</h6>
                        <ul style="font-size: 13px; margin: 0; padding-left: 15px;">
                            <li><strong>완전히 동일한 reads</strong></li>
                            <li>처음부터 끝까지 100% 일치</li>
                            <li>품질 점수도 동일해야 함</li>
                            <li>전체 길이가 같아야 함</li>
                        </ul>
                    </div>
                    <div style="background: #ffebee; padding: 10px; border-radius: 3px;">
                        <h6 style="color: #c62828; margin: 0 0 5px 0;">❌ FastQC가 측정하지 않는 것</h6>
                        <ul style="font-size: 13px; margin: 0; padding-left: 15px;">
                            <li><strong>부분적 유사성</strong></li>
                            <li>일부 염기만 같은 경우</li>
                            <li>동일 영역의 다른 reads</li>
                            <li>k-mer 중복</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div style="background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 15px 0;">
                <h5 style="color: #424242; margin-top: 0;">💡 예시로 이해하기</h5>
                <div class="code-block" style="font-size: 12px; background: #fff; white-space: pre-line; line-height: 1.8;">
<strong>Read 1:</strong> ATCGATCGATCGATCGATCG... (150bp)

<strong>Read 2:</strong> ATCGATCGATCGATCGATCG... (150bp) ← <span style="color: #e74c3c;">완전히 동일 = Duplication!</span>

<strong>Read 3:</strong> ATCGATCGATCGATCGATCC... (150bp) ← <span style="color: #27ae60;">끝 부분 다름 = 다른 read</span>

<strong>Read 4:</strong> CGATCGATCGATCGATCGAT... (150bp) ← <span style="color: #27ae60;">시작 부분 다름 = 다른 read</span>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f5f5f5; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2e7d32; margin-top: 0;">✅ 정상적인 중복 (생물학적)</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>높은 발현 유전자</strong>: rRNA, histone 등</li>
                        <li><strong>반복 서열</strong>: LINE, SINE, 위성 DNA</li>
                        <li><strong>미토콘드리아 DNA</strong>: 세포당 수백-수천 copy</li>
                        <li><strong>클로날 증폭</strong>: 단세포 분석 등</li>
                    </ul>
                </div>
                <div style="background: #ffebee; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #c62828; margin-top: 0;">❌ 문제가 되는 중복 (기술적)</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>PCR 과증폭</strong>: 라이브러리 제작 중</li>
                        <li><strong>Bridge amplification bias</strong>: 클러스터 생성</li>
                        <li><strong>Optical duplicates</strong>: 동일 클러스터 중복 읽기</li>
                        <li><strong>어댑터 dimer</strong>: 빈 insert</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>📈 중복 수준별 의미</h3>
        <table class="table" style="font-size: 14px;">
            <thead>
                <tr>
                    <th>중복 수준</th>
                    <th>비율 기준</th>
                    <th>해석</th>
                    <th>권장 조치</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background: #e8f5e8;">
                    <td><strong>정상 (Pass)</strong></td>
                    <td><70% 중복</td>
                    <td>정상적인 라이브러리</td>
                    <td>추가 조치 불필요</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>주의 (Warning)</strong></td>
                    <td>70-90% 중복</td>
                    <td>PCR bias 의심, 복잡도 감소</td>
                    <td>Deduplication 고려</td>
                </tr>
                <tr style="background: #ffebee;">
                    <td><strong>실패 (Fail)</strong></td>
                    <td>>90% 중복</td>
                    <td>심각한 기술적 문제</td>
                    <td>라이브러리 재제작 권장</td>
                </tr>
            </tbody>
        </table>

        <h3>📈 FastQC Duplication Graph 해석법</h3>
        <div style="background: #e3f2fd; border: 2px solid #2196f3; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #1976d2; margin-top: 0;">📊 그래프 축(Axis) 설명</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2c3e50; margin-top: 0;">📏 X축: Duplication Level</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>1</strong>: 고유한 서열 (1번만 나타남)</li>
                        <li><strong>2</strong>: 2번 중복된 서열</li>
                        <li><strong>3</strong>: 3번 중복된 서열</li>
                        <li><strong>10+</strong>: 10번 이상 중복된 서열</li>
                        <li><strong>50+</strong>: 50번 이상 중복된 서열</li>
                        <li><strong>100+</strong>: 100번 이상 중복된 서열</li>
                        <li><strong>500+</strong>: 500번 이상 중복된 서열</li>
                        <li><strong>1k+</strong>: 1000번 이상 중복된 서열</li>
                    </ul>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #27ae60; margin-top: 0;">📊 Y축: Percentage of Total</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>0-100%</strong>: 전체 서열 중 비율</li>
                        <li><strong>예시</strong>: X=1에서 Y=70%</li>
                        <li>→ 전체 서열의 70%가 고유함</li>
                        <li><strong>예시</strong>: X=10+에서 Y=5%</li>
                        <li>→ 전체 서열의 5%가 10번 이상 중복</li>
                        <li><strong>합계</strong>: 모든 Y값의 합 = 100%</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #fff3e0; padding: 15px; border-radius: 5px; margin-top: 15px;">
                <h5 style="color: #e65100; margin-top: 0;">🔍 그래프 읽는 방법</h5>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <h6 style="color: #2e7d32; margin: 0 0 5px 0;">✅ 정상적인 그래프</h6>
                        <div class="code-block" style="font-size: 12px; background: #f8f9fa; white-space: pre-line;">
X=1 (고유): Y=85% ← 대부분 고유
X=2: Y=8%
X=3-5: Y=4%
X=10+: Y=2%
X=50+: Y=1%
X=100+: Y=0%
                        </div>
                    </div>
                    <div>
                        <h6 style="color: #c62828; margin: 0 0 5px 0;">❌ 문제가 있는 그래프</h6>
                        <div class="code-block" style="font-size: 12px; background: #f8f9fa; white-space: pre-line;">
X=1 (고유): Y=30% ← 고유 서열 적음
X=2: Y=15%
X=10+: Y=25% ← 높은 중복
X=100+: Y=20% ← 매우 높은 중복
X=1k+: Y=10% ← 극도로 높은 중복
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <h3>🔬 중복 패턴 분석</h3>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #4caf50;">
                <h4>📊 정상 패턴</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>단일 중복</strong>: X=1에서 Y=80%+ (대부분 고유)</li>
                    <li><strong>낮은 고중복</strong>: X=10+에서 Y<5%</li>
                    <li><strong>점진적 감소</strong>: 중복 수에 따른 지수적 감소</li>
                    <li><strong>생물학적 의미</strong>: 유전자 발현 반영</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #ff9800;">
                <h4>⚠️ PCR Bias 패턴</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>낮은 고유율</strong>: X=1에서 Y=50-70%</li>
                    <li><strong>높은 중복률</strong>: X=10+에서 Y=10-30%</li>
                    <li><strong>특정 서열 과증폭</strong>: GC bias로 인한 불균등</li>
                    <li><strong>라이브러리 복잡도 감소</strong>: 유효 읽기 수 감소</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #f44336;">
                <h4>❌ 심각한 문제 패턴</h4>
                <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                    <li><strong>극도로 낮은 고유율</strong>: X=1에서 Y<50%</li>
                    <li><strong>극도로 높은 중복</strong>: X=100+에서 Y>20%</li>
                    <li><strong>어댑터 dimer</strong>: X=1k+에서 높은 값</li>
                    <li><strong>라이브러리 실패</strong>: 재제작 필요</li>
                </ul>
            </div>
        </div>

        <h3>🛠️ 해결 방법</h3>
        <div style="background: #e3f2fd; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #1976d2; margin-top: 0;">💡 단계별 해결 전략</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2c3e50; margin-top: 0;">🔧 예방 조치</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>라이브러리 최적화</strong>: PCR cycle 수 감소</li>
                        <li><strong>UMI 사용</strong>: Unique Molecular Identifier</li>
                        <li><strong>충분한 input DNA</strong>: 1μg 이상 권장</li>
                        <li><strong>PCR-free 방법</strong>: 가능한 경우</li>
                    </ul>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #27ae60; margin-top: 0;">📈 사후 처리</h5>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Deduplication</strong>: Picard MarkDuplicates</li>
                        <li><strong>UMI deduplication</strong>: UMI-tools</li>
                        <li><strong>품질 필터링</strong>: 낮은 품질 중복 제거</li>
                        <li><strong>통계 보정</strong>: 중복률 고려 정규화</li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="width: 100%; height: 600px; border: 2px solid #ddd; border-radius: 8px; overflow: hidden; margin: 20px 0;">
            <iframe src="data/Sample_1_DKDN250008246-1A_22YL2YLT3_L1_1_fastqc.html" 
                    style="width: 100%; height: 100%; border: none;"
                    title="FastQC Report for Sample_1_DKDN250008246-1A_22YL2YLT3_L1_1">
            </iframe>
            <p style="font-size: 12px; color: #666; text-align: center; margin: 10px 0;">
                <strong>실제 FastQC 리포트:</strong> Sample_1_DKDN250008246-1A_22YL2YLT3_L1_1_fastqc.html
            </p>
        </div>
    </div>
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToFirst()">🏠 처음</button>
    <button class="nav-btn" onclick="prevSlide()">◀ 이전</button>
    <button class="nav-btn" onclick="nextSlide()">다음 ▶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶ 전체화면</button>
</div>

<div class="slide-number">슬라이드 19 / 21</div>

<script>
    function prevSlide() {
        window.location.href = "slide18.html";
    }
    
    function nextSlide() {
        window.location.href = "slide20.html";
    }
    
    function jumpToFirst() {
        window.location.href = "slide01.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToFirst();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
</script>

</body>
</html>