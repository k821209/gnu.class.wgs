<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGS 기초 이론 - Quality Assessment Guidelines</title>
    <style>

        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide.active { display: block; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #2980b9; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { background: #f8f9fa; border: 1px solid #e9ecef; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; }
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #27ae60; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #229954; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .table th { background: #f8f9fa; font-weight: bold; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .image-placeholder { width: 100%; height: 300px; background: #ecf0f1; border: 2px dashed #bdc3c7; display: flex; align-items: center; justify-content: center; color: #7f8c8d; font-size: 16px; margin: 20px 0; border-radius: 8px; }
    
    </style>
</head>
<body>

<div class="slide">
<div class="slide-title">품질 평가 가이드라인</div>
    <div class="slide-content">
        <h2>🔍 플랫폼별 시퀀싱 결과 검토 가이드</h2>
        
        <h3>📊 Illumina/MGI 플랫폼 검토 포인트</h3>
        <div style="background: #e3f2fd; border: 2px solid #2196f3; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <div class="comparison-table">
                <div class="comparison-item" style="border-left-color: #2196f3;">
                    <h4>🧬 DNA-seq (WGS/WES)</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Per base quality</strong>: Q30 >85%</li>
                        <li><strong>Per tile quality</strong>: 타일 간 균등성</li>
                        <li><strong>Sequence content</strong>: 첫 10-15bp 편향 확인</li>
                        <li><strong>Duplication</strong>: <30% (WGS), <70% (WES)</li>
                        <li><strong>GC content</strong>: 40-45% (인간 게놈)</li>
                        <li><strong>Insert size</strong>: 예상 범위 확인</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #ff9800;">
                    <h4>🧮 RNA-seq (전사체)</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Per base quality</strong>: Q30 >80%</li>
                        <li><strong>Sequence content</strong>: random priming 편향</li>
                        <li><strong>Duplication</strong>: 50-80% 정상 (발현량 차이)</li>
                        <li><strong>GC content</strong>: 생물종별 다양</li>
                        <li><strong>Overrepresented</strong>: rRNA, globin 확인</li>
                        <li><strong>5'/3' bias</strong>: RNA 품질 반영</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #4caf50;">
                    <h4>🎯 공통 주의사항</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Adapter content</strong>: <1%</li>
                        <li><strong>N content</strong>: <5%</li>
                        <li><strong>Optical duplicates</strong>: 클러스터 밀도</li>
                        <li><strong>Index hopping</strong>: NovaSeq 특히 주의</li>
                        <li><strong>Read length 분포</strong>: 예상 길이 확인</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>🧬 PacBio 플랫폼 검토 포인트</h3>
        <div style="background: #e8f5e8; border: 2px solid #4caf50; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <div class="comparison-table">
                <div class="comparison-item" style="border-left-color: #4caf50;">
                    <h4>🔬 HiFi DNA-seq</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Read quality</strong>: Q20 >90%</li>
                        <li><strong>Read length</strong>: >10kb 평균</li>
                        <li><strong>CCS passes</strong>: ≥3 권장</li>
                        <li><strong>Polymerase read</strong>: >20kb</li>
                        <li><strong>Loading concentration</strong>: 최적화</li>
                        <li><strong>ZMW productivity</strong>: >70%</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #ff5722;">
                    <h4>📏 CLR/subreads</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Subread length</strong>: N50 >8kb</li>
                        <li><strong>Subread quality</strong>: 정확도 고려</li>
                        <li><strong>SMRTbell 적응</strong>: 어댑터 dimer</li>
                        <li><strong>Movie 시간</strong>: 충분한 수집</li>
                        <li><strong>Yield</strong>: Gb당 비용 고려</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #9c27b0;">
                    <h4>🎯 특별 고려사항</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Homopolymer</strong>: 긴 반복 확인</li>
                        <li><strong>AT/GC 밸런스</strong>: 증폭 bias</li>
                        <li><strong>Size selection</strong>: 타겟 크기 달성</li>
                        <li><strong>Damage 패턴</strong>: 오래된 DNA</li>
                        <li><strong>Chimeric reads</strong>: 라이브러리 문제</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>🧩 Oxford Nanopore 플랫폼 검토 포인트</h3>
        <div style="background: #f3e5f5; border: 2px solid #9c27b0; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <div class="comparison-table">
                <div class="comparison-item" style="border-left-color: #9c27b0;">
                    <h4>⚡ Simplex DNA-seq</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Read quality</strong>: Q15+ 평균 (Q20+ 목표)</li>
                        <li><strong>Read length</strong>: N50 >20kb</li>
                        <li><strong>Active channels</strong>: >2000 유지</li>
                        <li><strong>Pore 수명</strong>: 시간당 감소율</li>
                        <li><strong>Translocation speed</strong>: 일정성</li>
                        <li><strong>Strand bias</strong>: template/complement 밸런스</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #e91e63;">
                    <h4>🔄 Duplex 모드</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Duplex rate</strong>: >40% 달성</li>
                        <li><strong>Duplex quality</strong>: Q30+ 확인</li>
                        <li><strong>Second strand capture</strong>: 효율성</li>
                        <li><strong>Motor protein</strong>: 정상 기능</li>
                        <li><strong>Chemistry 최적화</strong>: Kit 14 권장</li>
                        <li><strong>Basecalling model</strong>: SUP/Dorado v5</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #795548;">
                    <h4>🎯 특별 모니터링</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Homopolymer 정확도</strong>: >5bp 길이</li>
                        <li><strong>Methylation 신호</strong>: 필요시</li>
                        <li><strong>Real-time QC</strong>: MinKNOW 모니터링</li>
                        <li><strong>Adapter 효율</strong>: 라이브러리 성공율</li>
                        <li><strong>Temperature 안정성</strong>: 장시간 런</li>
                    </ul>
                </div>
            </div>
        </div>

        <h2>🎯 실험 목적별 우선순위</h2>
        
        <h3>🧬 DNA-seq vs RNA-seq 주요 차이점</h3>
        <table class="table">
            <thead>
                <tr>
                    <th>검토 항목</th>
                    <th>DNA-seq 기준</th>
                    <th>RNA-seq 기준</th>
                    <th>이유/설명</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background: #e3f2fd;">
                    <td><strong>Sequence Duplication</strong></td>
                    <td>낮을수록 좋음 (<30%)</td>
                    <td>높아도 정상 (50-80%)</td>
                    <td>유전자 발현량 차이로 인한 자연스러운 중복</td>
                </tr>
                <tr style="background: #fff3e0;">
                    <td><strong>Per base content</strong></td>
                    <td>A=T, G=C 균등</td>
                    <td>편향 허용</td>
                    <td>Random priming, polyA 선택으로 인한 편향</td>
                </tr>
                <tr style="background: #e8f5e8;">
                    <td><strong>GC content</strong></td>
                    <td>게놈 평균 (인간: 41%)</td>
                    <td>발현 유전자 편향</td>
                    <td>높은 발현 유전자가 특정 GC% 가질 수 있음</td>
                </tr>
                <tr style="background: #f3e5f5;">
                    <td><strong>Overrepresented sequences</strong></td>
                    <td>최소화 필요</td>
                    <td>rRNA, globin 예상</td>
                    <td>높은 발현 유전자 자연 출현</td>
                </tr>
                <tr style="background: #ffebee;">
                    <td><strong>Read length uniformity</strong></td>
                    <td>일정한 길이</td>
                    <td>5'/3' bias 확인</td>
                    <td>RNA 분해로 인한 길이 편향 가능</td>
                </tr>
            </tbody>
        </table>

        <div style="background: #fffbeb; border: 2px solid #fdd835; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #f9a825; margin-top: 0; font-size: 20px;">💡 5'/3' Bias 심층 이해</h4>
            <p style="font-size: 16px;">
                <strong>5'/3' Bias</strong>는 개별 시퀀싱 리드(read)의 5'과 3' 끝을 의미하는 것이 아닙니다. 이 개념은 훨씬 긴 원본 mRNA 분자(transcript)의 <strong>어느 위치에서</strong> 그 짧은 리드가 유래했는지를 나타냅니다.
            </p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #e8f5e8; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #2e7d32; margin-top: 0;">✅ 고품질 RNA (편향 없음)</h5>
                    <p style="font-size: 14px; margin-bottom: 10px;">RNA가 온전하면, 유전자 전체 길이에 걸쳐 리드가 균일하게 분포합니다.</p>
                    <div style="background: #f1f8e9; border: 1px solid #dcedc8; padding: 10px; font-family: monospace; font-size: 12px; white-space: pre;">유전자: [==============================]
리드  :   [--]  [--]  [--]  [--]  [--]
커버리지: ***************************** (균일)</div>
                </div>
                <div style="background: #ffebee; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #c62828; margin-top: 0;">❌ 손상된 RNA (5'/3' 편향)</h5>
                    <p style="font-size: 14px; margin-bottom: 10px;">RNA가 분해되면, 3' 말단에 가까운 조각들만 시퀀싱되어 리드가 한쪽으로 쏠립니다.</p>
                    <div style="background: #ffcdd2; border: 1px solid #ef9a9a; padding: 10px; font-family: monospace; font-size: 12px; white-space: pre;">유전자: [==============================]
리드  :                       [--] [--]
커버리지: ...................********** (3' 편향)</div>
                </div>
            </div>
        </div>

        <h3>⚠️ 플랫폼별 특별 주의사항</h3>
        <div style="background: #fff3e0; border: 2px solid #ff9800; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <div class="comparison-table">
                <div class="comparison-item" style="border-left-color: #2196f3;">
                    <h4>🔵 Illumina 특별 주의</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Index hopping</strong>: NovaSeq 1-2%</li>
                        <li><strong>Optical duplicates</strong>: 클러스터 밀도</li>
                        <li><strong>PhiX spike-in</strong>: 다양성 확보</li>
                        <li><strong>Flow cell aging</strong>: 품질 저하</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #4caf50;">
                    <h4>🟢 PacBio 특별 주의</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Size selection 실패</strong>: 짧은 reads</li>
                        <li><strong>Polymerase 결합 실패</strong>: 낮은 productivity</li>
                        <li><strong>SMRTbell damage</strong>: 라이브러리 문제</li>
                        <li><strong>Loading 농도</strong>: 과포화/부족</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #9c27b0;">
                    <h4>🟣 Nanopore 특별 주의</h4>
                    <ul style="font-size: 14px; margin: 0; padding-left: 20px;">
                        <li><strong>Pore 막힘</strong>: 급격한 감소</li>
                        <li><strong>Bubble 형성</strong>: 유동 문제</li>
                        <li><strong>Temperature 변화</strong>: 성능 영향</li>
                        <li><strong>Basecalling 지연</strong>: 실시간 처리</li>
                    </ul>
                </div>
            </div>
        </div>

        <h3>✅ 종합 품질 판단 체크리스트</h3>
        <div style="background: #e8f5e8; padding: 20px; border-radius: 8px; margin: 20px 0;">
            <h4 style="color: #2e7d32; margin-top: 0;">🎯 실험 진행 결정 기준</h4>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                <div style="background: #c8e6c9; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #1b5e20; margin-top: 0;">✅ 실험 진행</h5>
                    <ul style="font-size: 13px; margin: 0; padding-left: 15px;">
                        <li>플랫폼별 기준 충족</li>
                        <li>목적에 맞는 품질</li>
                        <li>커버리지 충분</li>
                        <li>비용 대비 효율적</li>
                    </ul>
                </div>
                <div style="background: #fff3e0; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #e65100; margin-top: 0;">⚠️ 추가 검토</h5>
                    <ul style="font-size: 13px; margin: 0; padding-left: 15px;">
                        <li>일부 지표 경계선</li>
                        <li>파일럿 분석 수행</li>
                        <li>전처리로 개선 가능</li>
                        <li>샘플링 증가 고려</li>
                    </ul>
                </div>
                <div style="background: #ffcdd2; padding: 15px; border-radius: 5px;">
                    <h5 style="color: #c62828; margin-top: 0;">❌ 재실험 권장</h5>
                    <ul style="font-size: 13px; margin: 0; padding-left: 15px;">
                        <li>기준 크게 미달</li>
                        <li>라이브러리 문제</li>
                        <li>기술적 실패</li>
                        <li>목적 달성 불가</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToFirst()">🏠 처음</button>
    <button class="nav-btn" onclick="prevSlide()">◀ 이전</button>
    <button class="nav-btn" onclick="nextSlide()">다음 ▶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶ 전체화면</button>
</div>

<div class="slide-number">슬라이드 20 / 21</div>

<script>
    function prevSlide() {
        window.location.href = "slide19.html";
    }
    
    function nextSlide() {
        window.location.href = "slide21.html";
    }
    
    function jumpToFirst() {
        window.location.href = "slide01.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToFirst();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
</script>

</body>
</html>