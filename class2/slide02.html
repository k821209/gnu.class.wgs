<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGS 분석 파이프라인 - 전처리</title>
    <style>

        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide.active { display: block; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #2980b9; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { 
            background: #1e1e1e; 
            border: 1px solid #333; 
            padding: 20px; 
            border-radius: 8px; 
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace; 
            margin: 15px 0; 
            color: #00ff00;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: relative;
        }
        .code-block::before {
            content: "";
            color: #00ff00;
            font-weight: bold;
        }
        .code-block code { 
            white-space: pre-wrap; 
            color: #00ff00;
            font-size: 14px;
            line-height: 1.4;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #333;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .copy-btn:hover {
            opacity: 1;
            background: #555;
        }
        .copy-btn.copied {
            background: #00ff00;
            color: #000;
        }
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #27ae60; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #229954; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .table th { background: #f8f9fa; font-weight: bold; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .image-placeholder { width: 100%; height: 300px; background: #ecf0f1; border: 2px dashed #bdc3c7; display: flex; align-items: center; justify-content: center; color: #7f8c8d; font-size: 16px; margin: 20px 0; border-radius: 8px; }
        .tool-comparison { display: flex; justify-content: space-around; margin-top: 40px; flex-wrap: wrap; }
        .tool-card { background: #ffffff; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin: 15px; padding: 25px; width: 48%; min-width: 400px; box-sizing: border-box; transition: transform 0.2s; }
        .tool-card:hover { transform: translateY(-5px); }
        .tool-card h3 { color: #3498db; font-size: 22px; margin-top: 0; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-bottom: 20px; }
        .tool-card ul { list-style: none; padding: 0; margin: 0; }
        .tool-card li { margin-bottom: 10px; padding-left: 25px; position: relative; }
        .tool-card li::before { content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0; }
    
    </style>
</head>
<body>

<div class="slide">
    <div class="slide-title">단계 1: 전처리 (Pre-processing)</div>
    <div class="slide-content">
        <h2>🗑️ 왜 전처리가 필요한가?</h2>
        <p>"Garbage in, garbage out." 원본 데이터에 포함된 어댑터 서열, 낮은 품질의 염기, PCR 중복 등은 부정확한 변이 검출로 이어질 수 있습니다. 따라서, 분석의 정확도를 높이기 위해 반드시 거쳐야 하는 과정입니다.</p>

        <h2>📊 FASTQ 품질 점수 시스템 (Phred Quality Score)</h2>
        <p>FASTQ 파일의 품질 점수는 ASCII 문자로 인코딩되어 있으며, 각 염기의 정확도를 나타냅니다.</p>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
            <h4 style="color: #2c3e50; margin-top: 0;">🔢 ASCII → Phred Quality Score 변환</h4>
            <p style="margin: 10px 0; font-family: monospace; background: #e9ecef; padding: 10px; border-radius: 4px;">
                <strong>공식:</strong> Phred Score = ASCII value - 33
            </p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(60px, 1fr)); gap: 5px; margin: 20px 0;">
                <div style="background: #dc3545; color: white; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">!</div>
                    <div>Q0</div>
                </div>
                <div style="background: #fd7e14; color: white; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">"</div>
                    <div>Q1</div>
                </div>
                <div style="background: #ffc107; color: black; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">#</div>
                    <div>Q2</div>
                </div>
                <div style="background: #fd7e14; color: white; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">@</div>
                    <div>Q31</div>
                </div>
                <div style="background: #20c997; color: white; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">A</div>
                    <div>Q32</div>
                </div>
                <div style="background: #28a745; color: white; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">F</div>
                    <div>Q37</div>
                </div>
                <div style="background: #17a2b8; color: white; padding: 8px; text-align: center; border-radius: 4px; font-size: 12px;">
                    <div style="font-weight: bold;">I</div>
                    <div>Q40</div>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h5 style="color: #2c3e50;">품질 점수 해석:</h5>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin: 10px 0;">
                    <span style="background: #dc3545; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px;">Q0-Q19: 저품질</span>
                    <span style="background: #ffc107; color: black; padding: 5px 10px; border-radius: 15px; font-size: 12px;">Q20-Q29: 보통품질</span>
                    <span style="background: #28a745; color: white; padding: 5px 10px; border-radius: 15px; font-size: 12px;">Q30+: 고품질</span>
                </div>
                <p style="font-size: 14px; color: #6c757d; margin-top: 10px;">
                    Q30 = 99.9% 정확도 (1/1000 오류율), Q40 = 99.99% 정확도 (1/10000 오류율)
                </p>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef;">
                <h4 style="color: #2c3e50; margin-top: 0;">📋 저품질 ASCII 문자 (Q0-Q19)</h4>
                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                    <thead>
                        <tr style="background: #e9ecef;">
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">ASCII</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">Phred</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">정확도</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #fff5f5;">
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">!</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q0</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">50.0%</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">"</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q1</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">68.4%</td>
                        </tr>
                        <tr style="background: #fff5f5;">
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">#</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q2</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">73.7%</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">+</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q10</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">90.0%</td>
                        </tr>
                        <tr style="background: #fff5f5;">
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">5</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q20</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">99.0%</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef;">
                <h4 style="color: #2c3e50; margin-top: 0;">📋 고품질 ASCII 문자 (Q20+)</h4>
                <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                    <thead>
                        <tr style="background: #e9ecef;">
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">ASCII</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">Phred</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">정확도</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: #f0f8ff;">
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">?</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q30</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">99.9%</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">F</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q37</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">99.98%</td>
                        </tr>
                        <tr style="background: #f0f8ff;">
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">I</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q40</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">99.99%</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">J</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q41</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">99.992%</td>
                        </tr>
                        <tr style="background: #f0f8ff;">
                            <td style="border: 1px solid #dee2e6; padding: 8px; font-family: monospace; font-weight: bold;">~</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">Q93</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">99.999995%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107;">
            <h4 style="color: #856404; margin-top: 0;">💡 트림밍 임계값 (Trimming Thresholds)</h4>
            <ul style="color: #856404; margin: 10px 0;">
                <li><strong>Q20 (99% 정확도):</strong> 일반적인 최소 품질 임계값</li>
                <li><strong>Q30 (99.9% 정확도):</strong> 고품질 분석을 위한 권장 임계값</li>
                <li><strong>슬라이딩 윈도우:</strong> 연속된 여러 염기의 평균 품질로 판단</li>
            </ul>
        </div>

        <h2>🔍 품질 평가: FastQC</h2>
        <p>트림밍 전후 데이터의 품질을 평가하고 시각화하는 필수 도구입니다. 다양한 품질 지표를 통해 데이터의 문제점을 파악할 수 있습니다.</p>

        <div style="background: #ffffff; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin: 20px 0; padding: 25px;">
            <h3 style="color: #3498db; font-size: 22px; margin-top: 0; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-bottom: 20px;">FastQC</h3>
            <ul style="list-style: none; padding: 0; margin: 0;">
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    시퀀싱 데이터의 종합적인 품질 평가 도구
                </li>
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    HTML 형태의 시각적 보고서 생성
                </li>
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    <strong>주요 분석 항목:</strong> 품질 점수 분포, GC 함량, 어댑터 오염, 과대표 서열, N 함량
                </li>
            </ul>
            
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">복사</button>
                <code># 단일 파일 분석
fastqc input.fastq.gz -o output_directory
# 여러 파일 동시 분석
fastqc *.fastq.gz -o fastqc_results/ -t 8
# 트림밍 전후 비교
fastqc raw_data/*.fastq.gz -o fastqc_before/
fastqc trimmed_data/*.fastq.gz -o fastqc_after/</code>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #3498db;">
                <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                    <li><strong>-o</strong>: 출력 디렉토리 지정</li>
                    <li><strong>-t</strong>: 사용할 스레드 수</li>
                    <li><strong>*.fastq.gz</strong>: 와일드카드로 여러 파일 동시 처리</li>
                </ul>
            </div>

            <div style="background: #e8f4f8; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #17a2b8;">
                <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📊 주요 분석 결과</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                    <div>
                        <h5 style="color: #2c3e50; margin: 0 0 8px 0; font-size: 14px;">✅ 정상 지표</h5>
                        <ul style="font-size: 12px; margin: 0; padding-left: 15px; color: #2c3e50;">
                            <li>Per base sequence quality > Q20</li>
                            <li>GC content 40-60%</li>
                            <li>Adapter content < 5%</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="color: #e74c3c; margin: 0 0 8px 0; font-size: 14px;">⚠️ 문제 지표</h5>
                        <ul style="font-size: 12px; margin: 0; padding-left: 15px; color: #2c3e50;">
                            <li>Quality drop at 3' end</li>
                            <li>High adapter contamination</li>
                            <li>Overrepresented sequences</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <h2>📏 Long Read 시퀀싱 품질 평가</h2>
        <p>PacBio, Oxford Nanopore 등의 장거리 시퀀싱 데이터는 다른 특성과 오류 패턴을 가지므로 전용 품질 평가 도구가 필요합니다.</p>

        <div style="background: #ffffff; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin: 20px 0; padding: 25px;">
            <h3 style="color: #e67e22; font-size: 22px; margin-top: 0; border-bottom: 2px solid #e67e22; padding-bottom: 10px; margin-bottom: 20px;">NanoPlot</h3>
            <ul style="list-style: none; padding: 0; margin: 0;">
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    Oxford Nanopore 시퀀싱 데이터 전용 품질 분석 도구
                </li>
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    길이 분포, 품질 분포, 시간별 처리량 등 장거리 특화 분석
                </li>
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    <strong>주요 분석 항목:</strong> 리드 길이 분포, N50, 품질 점수 분포, 처리량 시계열
                </li>
            </ul>
            
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">복사</button>
                <code># FASTQ 파일 분석
NanoPlot --fastq input_nanopore.fastq.gz -o nanoplot_output/ -t 8
# BAM 파일 분석 (alignment 정보 포함)
NanoPlot --bam aligned_reads.bam -o nanoplot_bam/ -t 8
# 요약 파일에서 분석
NanoPlot --summary sequencing_summary.txt -o nanoplot_summary/</code>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #e67e22;">
                <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                    <li><strong>--fastq</strong>: FASTQ 파일 입력</li>
                    <li><strong>--bam</strong>: BAM 파일 입력 (정렬 정보 포함 분석)</li>
                    <li><strong>--summary</strong>: Nanopore 요약 파일 입력</li>
                    <li><strong>-o</strong>: 출력 디렉토리</li>
                    <li><strong>-t</strong>: 스레드 수</li>
                </ul>
            </div>
        </div>

        <div style="background: #ffffff; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.05); margin: 20px 0; padding: 25px;">
            <h3 style="color: #8e44ad; font-size: 22px; margin-top: 0; border-bottom: 2px solid #8e44ad; padding-bottom: 10px; margin-bottom: 20px;">LongQC</h3>
            <ul style="list-style: none; padding: 0; margin: 0;">
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    PacBio와 Nanopore 모두 지원하는 범용 장거리 품질 평가 도구
                </li>
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    참조 유전체 기반 정렬 품질 분석 제공
                </li>
                <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                    <span style="content: '•'; color: #27ae60; font-weight: bold; position: absolute; left: 0; top: 0;">•</span>
                    <strong>주요 분석 항목:</strong> 길이별 품질, 오류 패턴, 커버리지 분포, 반복 서열 분석
                </li>
            </ul>
            
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">복사</button>
                <code># 기본 분석 (참조 유전체 없이)
python longQC.py sampleqc -x pb-rs2 -o longqc_output/ input.fastq
# 참조 유전체 기반 분석
python longQC.py sampleqc -x ont-ligation -r reference.fasta \
    -o longqc_output/ input.fastq</code>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #8e44ad;">
                <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                    <li><strong>-x</strong>: 시퀀싱 플랫폼 (pb-rs2, ont-ligation, ont-rapid 등)</li>
                    <li><strong>-r</strong>: 참조 유전체 파일 (선택적)</li>
                    <li><strong>-o</strong>: 출력 디렉토리</li>
                    <li><strong>sampleqc</strong>: 샘플 품질 분석 모드</li>
                </ul>
            </div>

            <div style="background: #e8f4f8; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #17a2b8;">
                <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📊 장거리 시퀀싱 품질 지표</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                    <div>
                        <h5 style="color: #2c3e50; margin: 0 0 8px 0; font-size: 14px;">✅ 좋은 지표</h5>
                        <ul style="font-size: 12px; margin: 0; padding-left: 15px; color: #2c3e50;">
                            <li>N50 > 10kb (Nanopore)</li>
                            <li>평균 품질 > Q7-Q10</li>
                            <li>균등한 길이 분포</li>
                            <li>낮은 어댑터 오염</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="color: #e74c3c; margin: 0 0 8px 0; font-size: 14px;">⚠️ 문제 지표</h5>
                        <ul style="font-size: 12px; margin: 0; padding-left: 15px; color: #2c3e50;">
                            <li>짧은 리드 위주 분포</li>
                            <li>높은 키메라 리드 비율</li>
                            <li>시간별 품질 저하</li>
                            <li>과도한 어댑터 잔여</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <h2>✂️ 트림밍 전/후 FASTQ 시퀀스 예시</h2>
        <p>아래는 실제 시퀀싱 데이터에서 발생하는 문제점들과 트림밍 과정을 통한 해결 과정을 보여주는 예시입니다.</p>

        <h3>트림밍 전 (Before Trimming)</h3>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">복사</button>
            <code>
@M03127:25:000000000-A2G5L:1:1101:15823:1574 1:N:0:1
GATCGGAAGAGCACACGTCTGAACTCCAGTCACATCACGATCTCGTATGCCGTCTTCTGCTTGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
+
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII@@@###!!!!!!!!

            </code>
        </div>

        <h3>트림밍 후 (After Trimming)</h3>
        <div class="code-block">
            <button class="copy-btn" onclick="copyCode(this)">복사</button>
            <code>
@M03127:25:000000000-A2G5L:1:1101:15823:1574 1:N:0:1
GATCGGAAGAGCACACGTCTGAACTCCAGTCACATCACGATCTCGTATGCCGTCTTCTGCTTGAAAAAAAAAAAAAAAA
+
IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII         
            </code>
        </div>

        <div style="background: #e8f4f8; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #3498db;">
            <h4 style="color: #2c3e50; margin-top: 0;">🔍 트림밍 결과 분석</h4>
            <ul style="color: #34495e; margin: 10px 0;">
                <li><strong>첫 번째 시퀀스:</strong> 완전히 제거됨 (어댑터 서열로만 구성)</li>
                <li><strong>두 번째 시퀀스:</strong> 33bp로 트림됨 (어댑터 서열 제거, 고품질 부분만 유지)</li>
                <li><strong>세 번째 시퀀스:</strong> 저품질 부분 제거 후 유지</li>
            </ul>
        </div>

        <div class="tool-comparison">
            <div class="tool-card">
                <h3>Trimmomatic</h3>
                <ul>
                    <li>자바 기반의 유연하고 강력한 전처리 도구.</li>
                    <li>다양한 옵션을 통해 정교한 필터링 가능.</li>
                    <li><strong>주요 기능:</strong> 어댑터 제거, 슬라이딩 윈도우 품질 필터링, 최소 길이 필터링.</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                    <code>java -jar trimmomatic.jar PE -phred33 input_R1.fastq.gz input_R2.fastq.gz \<br>
        output_R1_paired.fastq.gz output_R1_unpaired.fastq.gz \<br>
        output_R2_paired.fastq.gz output_R2_unpaired.fastq.gz \<br>
        ILLUMINACLIP:adapters.fa:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36</code>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #3498db;">
                    <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                    <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                        <li><strong>PE</strong>: Paired-End 모드</li>
                        <li><strong>-phred33</strong>: ASCII+33 품질 인코딩 (Illumina 1.8+)</li>
                        <li><strong>ILLUMINACLIP:adapters.fa:2:30:10</strong>
                            <ul style="margin-top: 5px; font-size: 12px;">
                                <li>어댑터 파일: adapters.fa</li>
                                <li>허용 불일치: 2개</li>
                                <li>간단한 클립 임계값: 30</li>
                                <li>회문 클립 임계값: 10</li>
                            </ul>
                        </li>
                        <li><strong>LEADING:3</strong>: 5' 끝에서 Q3 이하 염기 제거</li>
                        <li><strong>TRAILING:3</strong>: 3' 끝에서 Q3 이하 염기 제거</li>
                        <li><strong>SLIDINGWINDOW:4:15</strong>: 4bp 윈도우에서 평균 Q15 이하 시 자르기</li>
                        <li><strong>MINLEN:36</strong>: 최소 길이 36bp 이하 시퀀스 제거</li>
                    </ul>
                </div>
            </div>
            <div class="tool-card">
                <h3>fastp</h3>
                <ul>
                    <li>C++로 작성되어 매우 빠른 속도를 자랑하는 올인원 도구.</li>
                    <li>어댑터 자동 감지, 품질 필터링, UMI 처리 등을 한 번에 수행.</li>
                    <li><strong>주요 기능:</strong> 자동 어댑터 탐지, 품질 필터링, HTML 리포트 생성.</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                    <code>fastp -i input_R1.fastq.gz -I input_R2.fastq.gz \<br>
            -o output_R1.fastq.gz -O output_R2.fastq.gz \<br>
            -h report.html -j report.json</code>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #3498db;">
                    <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                    <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                        <li><strong>-i</strong>: 입력 파일 1 (Read 1)</li>
                        <li><strong>-I</strong>: 입력 파일 2 (Read 2)</li>
                        <li><strong>-o</strong>: 출력 파일 1 (필터링된 Read 1)</li>
                        <li><strong>-O</strong>: 출력 파일 2 (필터링된 Read 2)</li>
                        <li><strong>-h</strong>: HTML 보고서 생성</li>
                        <li><strong>-j</strong>: JSON 보고서 생성</li>
                    </ul>
                    <div style="background: #e8f5e8; padding: 10px; border-radius: 4px; margin-top: 10px;">
                        <p style="margin: 0; font-size: 12px; color: #2d5a2d;">
                            <strong>💡 자동 기능:</strong> fastp는 별도 옵션 없이도 어댑터 자동 감지, 품질 필터링(Q15), 길이 필터링(15bp) 등을 자동으로 수행합니다.
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <h2>📏 Long Read 전처리 도구</h2>
        <p>장거리 시퀀싱 데이터의 전처리는 어댑터 제거와 길이 기반 필터링이 중심입니다.</p>

        <div class="tool-comparison">
            <div class="tool-card">
                <h3>Porechop</h3>
                <ul>
                    <li>Oxford Nanopore 시퀀싱 데이터 전용 어댑터 제거 도구</li>
                    <li>배코딩(barcode) 및 어댑터 서열 자동 감지</li>
                    <li><strong>주요 기능:</strong> 어댑터 트림밍, 키메라 리드 분할, 배코드 분리</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                    <code>porechop -i input_nanopore.fastq.gz \<br>
            -o output_trimmed.fastq.gz \<br>
            --threads 8 --discard_middle</code>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #3498db;">
                    <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                    <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                        <li><strong>-i</strong>: 입력 FASTQ 파일</li>
                        <li><strong>-o</strong>: 출력 파일</li>
                        <li><strong>--threads</strong>: 사용할 CPU 코어 수</li>
                        <li><strong>--discard_middle</strong>: 중간 어댑터가 있는 리드 제거</li>
                    </ul>
                </div>
            </div>

            <div class="tool-card">
                <h3>Filtlong</h3>
                <ul>
                    <li>장거리 시퀀싱 데이터의 품질 기반 필터링 도구</li>
                    <li>길이와 품질을 동시에 고려한 최적화 필터링</li>
                    <li><strong>주요 기능:</strong> 길이 기반 필터링, 품질 점수 기반 필터링, 상위 N% 리드 선택</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">복사</button>
                    <code>filtlong --min_length 1000 --keep_percent 90 \<br>
            --target_bases 500000000 \<br>
            input_nanopore.fastq.gz > output_filtered.fastq</code>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 15px; border-left: 3px solid #3498db;">
                    <h4 style="color: #2c3e50; margin-top: 0; font-size: 16px;">📝 옵션 설명</h4>
                    <ul style="font-size: 13px; line-height: 1.5; margin: 10px 0; padding-left: 20px;">
                        <li><strong>--min_length</strong>: 최소 리드 길이 (1000bp)</li>
                        <li><strong>--keep_percent</strong>: 상위 90% 품질 리드 유지</li>
                        <li><strong>--target_bases</strong>: 목표 총 염기 수 (500M)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107;">
            <h4 style="color: #856404; margin-top: 0;">⚖️ Short Read vs Long Read 전처리 비교</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div>
                    <h5 style="color: #856404; margin-top: 0;">Short Read (Illumina)</h5>
                    <ul style="color: #856404; font-size: 13px;">
                        <li>높은 정확도 (99.9%)</li>
                        <li>짧은 길이 (50-300bp)</li>
                        <li>품질 점수 기반 트림밍</li>
                        <li>어댑터 오염 문제</li>
                    </ul>
                </div>
                <div>
                    <h5 style="color: #856404; margin-top: 0;">Long Read (PacBio/Nanopore)</h5>
                    <ul style="color: #856404; font-size: 13px;">
                        <li>낮은 정확도 (85-95%)</li>
                        <li>긴 길이 (1kb-1Mb)</li>
                        <li>길이 기반 필터링 중심</li>
                        <li>키메라 리드 문제</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToFirst()">🏠 처음</button>
    <button class="nav-btn" onclick="prevSlide()">◀ 이전</button>
    <button class="nav-btn" onclick="nextSlide()">다음 ▶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶ 전체화면</button>
</div>

<div class="slide-number">슬라이드 2 / 5</div>

<script>
    function prevSlide() {
        window.location.href = "slide01.html";
    }
    
    function nextSlide() {
        window.location.href = "slide03.html";
    }
    
    function jumpToFirst() {
        window.location.href = "slide01.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    function copyCode(button) {
        const codeBlock = button.nextElementSibling;
        const codeText = codeBlock.textContent.trim();
        
        navigator.clipboard.writeText(codeText).then(function() {
            button.textContent = '복사됨!';
            button.classList.add('copied');
            setTimeout(function() {
                button.textContent = '복사';
                button.classList.remove('copied');
            }, 2000);
        }).catch(function() {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = codeText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                button.textContent = '복사됨!';
                button.classList.add('copied');
                setTimeout(function() {
                    button.textContent = '복사';
                    button.classList.remove('copied');
                }, 2000);
            } catch (err) {
                console.error('Copy failed:', err);
            }
            document.body.removeChild(textArea);
        });
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToFirst();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
</script>

</body>
</html>