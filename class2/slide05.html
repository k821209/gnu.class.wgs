<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGS ë¶„ì„ íŒŒì´í”„ë¼ì¸ - ë³€ì´ ê²€ì¶œ</title>
    <style>

        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide.active { display: block; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #2980b9; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { 
            background: #1e1e1e; 
            border: 1px solid #333; 
            padding: 20px; 
            border-radius: 8px; 
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace; 
            margin: 15px 0; 
            color: #00ff00;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: relative;
        }
        .code-block::before {
            content: "";
            color: #00ff00;
            font-weight: bold;
        }
        .code-block code { 
            white-space: pre-wrap; 
            color: #00ff00;
            font-size: 14px;
            line-height: 1.4;
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #333;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        .copy-btn:hover {
            opacity: 1;
            background: #555;
        }
        .copy-btn.copied {
            background: #00ff00;
            color: #000;
        }
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #27ae60; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #229954; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .table th { background: #f8f9fa; font-weight: bold; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .image-placeholder { width: 100%; height: 300px; background: #ecf0f1; border: 2px dashed #bdc3c7; display: flex; align-items: center; justify-content: center; color: #7f8c8d; font-size: 16px; margin: 20px 0; border-radius: 8px; }
    
    </style>
</head>
<body>

<div class="slide">
    <div class="slide-title">ë‹¨ê³„ 4: ë³€ì´ ê²€ì¶œ (Variant Calling)</div>
    <div class="slide-content">
        <h2>ğŸ’ ê²Œë†ˆì˜ ì°¨ì´ì  ë°œê²¬í•˜ê¸°</h2>
        <p>ë³€ì´ ê²€ì¶œì€ ì˜ ì •ë ¬ëœ ë¦¬ë“œì™€ ì°¸ì¡° ê²Œë†ˆì„ ë¹„êµí•˜ì—¬ SNP(Single Nucleotide Polymorphism), Indel(Insertion/Deletion) ë“± ìœ ì „ì  ë³€ì´ë¥¼ ì°¾ì•„ë‚´ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì´ ë‹¨ê³„ì˜ ê²°ê³¼ë¬¼ì¸ VCF(Variant Call Format) íŒŒì¼ì€ í›„ì† ìœ ì „ì²´ ë¶„ì„ì˜ í•µì‹¬ì´ ë©ë‹ˆë‹¤.</p>

        <h3>ğŸ”§ ê¸°ë³¸ ë³€ì´ ê²€ì¶œ: SAMtools + bcftools</h3>
        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #6c757d;">
            <p><strong>SAMtoolsì™€ bcftoolsë¥¼ ì´ìš©í•œ ë³€ì´ ê²€ì¶œ</strong>ì€ ê°€ì¥ ê¸°ë³¸ì ì´ê³  ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ ì¡°í•©ì€ ë¹ ë¥´ê³  íš¨ìœ¨ì ì´ë©°, ëŒ€ë¶€ë¶„ì˜ ì—°êµ¬ì—ì„œ ì¶©ë¶„í•œ ì •í™•ë„ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</p>
            
            <h4>ğŸ“Š 2ë‹¨ê³„ ì²˜ë¦¬ ê³¼ì •</h4>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #1976d2; margin-top: 0;">1ï¸âƒ£ mpileup (Pileup ìƒì„±)</h5>
                    <ul style="font-size: 14px; color: #1976d2;">
                        <li>ê° ê²Œë†ˆ ìœ„ì¹˜ì—ì„œ ë¦¬ë“œ ì •ë³´ ìˆ˜ì§‘</li>
                        <li>Base quality, mapping quality ê³ ë ¤</li>
                        <li>Genotype likelihood ê³„ì‚°</li>
                        <li>ê²°ê³¼: BCF í˜•íƒœì˜ likelihood ë°ì´í„°</li>
                    </ul>
                </div>
                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #388e3c; margin-top: 0;">2ï¸âƒ£ call (ë³€ì´ í˜¸ì¶œ)</h5>
                    <ul style="font-size: 14px; color: #388e3c;">
                        <li>Likelihood ë°ì´í„°ì—ì„œ ë³€ì´ ê²°ì •</li>
                        <li>í†µê³„ì  ëª¨ë¸ë¡œ ë³€ì´ ì‹ ë¢°ë„ ê³„ì‚°</li>
                        <li>í•„í„°ë§ ë° í’ˆì§ˆ ì ìˆ˜ ë¶€ì—¬</li>
                        <li>ê²°ê³¼: ìµœì¢… VCF íŒŒì¼</li>
                    </ul>
                </div>
            </div>
            
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                <code># ë°©ë²• 1: íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í•œ ë²ˆì— ì²˜ë¦¬
bcftools mpileup -f reference.fasta final.bam | \
    bcftools call -mv -O v -o variants.vcf

# ë°©ë²• 2: ë‹¨ê³„ë³„ ì²˜ë¦¬ (ëŒ€ìš©ëŸ‰ ë°ì´í„° ê¶Œì¥)
# Step 1: mpileupìœ¼ë¡œ genotype likelihood ê³„ì‚°
bcftools mpileup -f reference.fasta final.bam -O b -o raw.bcf

# Step 2: callë¡œ ë³€ì´ í˜¸ì¶œ
bcftools call -mv raw.bcf -O v -o variants.vcf</code>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #ffc107;">
                <h5 style="color: #856404; margin-top: 0;">ğŸ¯ ì£¼ìš” íŒŒë¼ë¯¸í„° ì„¤ëª…</h5>
                <ul style="color: #856404; font-size: 14px;">
                    <li><strong>-f reference.fasta:</strong> ì°¸ì¡° ê²Œë†ˆ íŒŒì¼ ì§€ì •</li>
                    <li><strong>-m:</strong> Alternative alleleì„ í¬í•¨í•œ multiallelic calling</li>
                    <li><strong>-v:</strong> Variant siteë§Œ ì¶œë ¥ (referenceì™€ ë‹¤ë¥¸ ìœ„ì¹˜ë§Œ)</li>
                    <li><strong>-O v:</strong> VCF í˜•ì‹ìœ¼ë¡œ ì¶œë ¥ (b=BCF, z=ì••ì¶•VCF)</li>
                </ul>
            </div>
        </div>

        <div class="tool-comparison">
            <div class="tool-card">
                <h3>GATK HaplotypeCaller</h3>
                <ul>
                    <li>ìœ ì „ ë³€ì´ ë¶„ì„ì˜ ì‚°ì—… í‘œì¤€(de facto standard)ìœ¼ë¡œ ì—¬ê²¨ì§€ëŠ” ë„êµ¬.</li>
                    <li>êµ­ì†Œì  de novo ì–´ì…ˆë¸”ë¦¬ë¥¼ í†µí•´ ë§¤ìš° ì •í™•í•œ ë³€ì´ ê²€ì¶œ.</li>
                    <li><strong>ì¥ì :</strong> ë§¤ìš° ë†’ì€ ì •í™•ë„, ì‹ ë¢°ì„± ìˆëŠ” ê²°ê³¼, í’ë¶€í•œ ë¬¸ì„œ.</li>
                    <li><strong>ë‹¨ì :</strong> ë‹¤ì†Œ ëŠë¦° ì†ë„, ë³µì¡í•œ íŒŒì´í”„ë¼ì¸.</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                    <code>gatk HaplotypeCaller \
    -R reference.fasta \
    -I final.bam \
    -O variants.vcf</code>
                </div>
                
                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #28a745;">
                    <h5 style="color: #155724; margin-top: 0;">ğŸ§¬ ì¸ê°„ ê²Œë†ˆ ë¶„ì„ì—ì„œ GATKì˜ íŠ¹ë³„í•œ ì¥ì </h5>
                    <ul style="color: #155724; font-size: 14px;">
                        <li><strong>dbSNP í†µí•©:</strong> ê¸°ì¡´ SNP ë°ì´í„°ë² ì´ìŠ¤ í™œìš©ìœ¼ë¡œ known variants ìš°ì„  ê²€ì¶œ</li>
                        <li><strong>BQSR (Base Quality Score Recalibration):</strong> ì•Œë ¤ì§„ ë³€ì´ ìœ„ì¹˜ë¥¼ ì´ìš©í•œ í’ˆì§ˆ ì ìˆ˜ ì¬ë³´ì •</li>
                        <li><strong>VQSR (Variant Quality Score Recalibration):</strong> ê³ í’ˆì§ˆ ë³€ì´ ì„¸íŠ¸ë¡œ í•„í„°ë§ ëª¨ë¸ í•™ìŠµ</li>
                        <li><strong>Best Practices:</strong> ì¸ê°„ ê²Œë†ˆ íŠ¹í™”ëœ ê²€ì¦ëœ ì›Œí¬í”Œë¡œìš° ì œê³µ</li>
                    </ul>
                    <div class="code-block" style="margin-top: 10px;">
                        <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                        <code># dbSNPë¥¼ í™œìš©í•œ GATK ë³€ì´ ê²€ì¶œ
gatk HaplotypeCaller \
    -R reference.fasta \
    -I final.bam \
    --dbsnp dbsnp.vcf \
    -O variants.g.vcf \
    -ERC GVCF

# BQSRì„ í†µí•œ í’ˆì§ˆ ì¬ë³´ì •
gatk BaseRecalibrator \
    -R reference.fasta \
    -I final.bam \
    --known-sites dbsnp.vcf \
    -O recal_data.table</code>
                    </div>
                </div>
            </div>
            <div class="tool-card">
                <h3>FreeBayes</h3>
                <ul>
                    <li>ë² ì´ì¦ˆ í†µê³„(Bayesian statistics)ì— ê¸°ë°˜í•œ ë³€ì´ ê²€ì¶œ ë„êµ¬.</li>
                    <li>ë°°ìˆ˜ì„±(ploidy)ê³¼ í’€ë§ëœ ìƒ˜í”Œ(pooled samples) ë¶„ì„ì— ê°•ì .</li>
                    <li><strong>ì¥ì :</strong> ë¹ ë¥¸ ì†ë„, ìœ ì—°í•œ íŒŒë¼ë¯¸í„°, ì§‘ë‹¨ ìœ ì „í•™ ì—°êµ¬ì— ìœ ìš©.</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                    <code>freebayes -f reference.fasta -p 2 final.bam > variants.vcf</code>
                </div>
            </div>
            <div class="tool-card">
                <h3>bcftools call</h3>
                <ul>
                    <li>SAMtools íŒ¨í‚¤ì§€ì˜ ë³€ì´ ê²€ì¶œ ë„êµ¬ë¡œ ë§¤ìš° ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„.</li>
                    <li>ëŒ€ìš©ëŸ‰ ë°ì´í„°ì™€ ë©€í‹°ìƒ˜í”Œ ë¶„ì„ì— íŠ¹í™”.</li>
                    <li><strong>ì¥ì :</strong> ë§¤ìš° ë¹ ë¥¸ ì†ë„, ë‚®ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰, ê°„ë‹¨í•œ ì›Œí¬í”Œë¡œìš°.</li>
                    <li><strong>ìš©ë„:</strong> ì´ˆê¸° ìŠ¤í¬ë¦¬ë‹, ëŒ€ê·œëª¨ ì½”í˜¸íŠ¸ ë¶„ì„.</li>
                </ul>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                    <code># mpileupìœ¼ë¡œ genotype likelihood ê³„ì‚° í›„ ë³€ì´ í˜¸ì¶œ
bcftools mpileup -f reference.fasta final.bam | \
    bcftools call -mv -O v -o variants.vcf</code>
                </div>
            </div>
        </div>

        <h3>ğŸ†š ë³€ì´ ê²€ì¶œ ë„êµ¬ ë¹„êµ</h3>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4><i class="fas fa-balance-scale"></i> ì •í™•ë„ vs ì†ë„</h4>
                <ul>
                    <li><strong>GATK:</strong> ìµœê³  ì •í™•ë„, ëŠë¦° ì†ë„ (â˜…â˜…â˜…â˜…â˜… ì •í™•ë„, â˜…â˜…â˜†â˜†â˜† ì†ë„)</li>
                    <li><strong>FreeBayes:</strong> ë†’ì€ ì •í™•ë„, ì¤‘ê°„ ì†ë„ (â˜…â˜…â˜…â˜…â˜† ì •í™•ë„, â˜…â˜…â˜…â˜†â˜† ì†ë„)</li>
                    <li><strong>bcftools:</strong> ì–‘í˜¸í•œ ì •í™•ë„, ë¹ ë¥¸ ì†ë„ (â˜…â˜…â˜…â˜†â˜† ì •í™•ë„, â˜…â˜…â˜…â˜…â˜… ì†ë„)</li>
                </ul>
            </div>
            <div class="comparison-item" style="border-left-color: #3498db;">
                <h4><i class="fas fa-cogs"></i> ì‚¬ìš© ì‚¬ë¡€ë³„ ê¶Œì¥</h4>
                <ul>
                    <li><strong>ì„ìƒ/ì—°êµ¬ìš© ì •ë°€ ë¶„ì„:</strong> GATK HaplotypeCaller</li>
                    <li><strong>ì¸ê°„ ê²Œë†ˆ (dbSNP í™œìš©):</strong> GATK with known sites</li>
                    <li><strong>ì§‘ë‹¨ ìœ ì „í•™/ë°°ìˆ˜ì„± ë¶„ì„:</strong> FreeBayes</li>
                    <li><strong>ë¹„ëª¨ë¸ ìƒë¬¼ ê²Œë†ˆ:</strong> bcftools call</li>
                    <li><strong>ëŒ€ê·œëª¨ ìŠ¤í¬ë¦¬ë‹/QC:</strong> bcftools call</li>
                </ul>
            </div>
            <div class="comparison-item" style="border-left-color: #28a745;">
                <h4><i class="fas fa-rocket"></i> ì¶”ê°€ ë„êµ¬ë“¤</h4>
                <ul>
                    <li><strong>DeepVariant:</strong> Googleì˜ ë”¥ëŸ¬ë‹ ê¸°ë°˜ ë³€ì´ ê²€ì¶œ (ë†’ì€ ì •í™•ë„)</li>
                    <li><strong>Octopus:</strong> ë‹¤ë°°ìˆ˜ì²´ ë° ë³µì¡í•œ ë³€ì´ ê°ì§€</li>
                    <li><strong>Strelka2:</strong> ì²´ì„¸í¬ ë³€ì´ ê²€ì¶œ íŠ¹í™”</li>
                    <li><strong>VarScan:</strong> ì²´ì„¸í¬/ìƒì‹ì„¸í¬ ë³€ì´ êµ¬ë¶„</li>
                </ul>
            </div>
        </div>

        <div style="background: #f0f8f0; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #28a745;">
            <h3 style="color: #155724; margin-top: 0;">ğŸŒ± ì‹ë¬¼ ê²Œë†ˆì—ì„œëŠ” ì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div>
                    <h4 style="color: #155724; margin-top: 0;">âŒ GATK ì‚¬ìš©ì´ ì œí•œì ì¸ ì´ìœ </h4>
                    <ul style="color: #155724; font-size: 14px;">
                        <li><strong>Known sites ë¶€ì¡±:</strong> ëŒ€ë¶€ë¶„ ì‹ë¬¼ì¢…ì—ì„œ dbSNP ê°™ì€ í¬ê´„ì  ë³€ì´ ë°ì´í„°ë² ì´ìŠ¤ ë¶€ì¬</li>
                        <li><strong>BQSR íš¨ê³¼ ì œí•œ:</strong> Known variants ì—†ì´ëŠ” í’ˆì§ˆ ì¬ë³´ì •ì˜ ì´ì  ë¯¸ë¯¸</li>
                        <li><strong>ì¸ê°„ ê²Œë†ˆ íŠ¹í™”:</strong> GATK Best PracticesëŠ” ì£¼ë¡œ ì¸ê°„ ê²Œë†ˆ ê¸°ì¤€ìœ¼ë¡œ ìµœì í™”</li>
                        <li><strong>ë³µì¡ì„± ëŒ€ë¹„ íš¨ê³¼:</strong> ë³µì¡í•œ íŒŒì´í”„ë¼ì¸ì— ë¹„í•´ ì„±ëŠ¥ í–¥ìƒ ì œí•œì </li>
                    </ul>
                </div>
                <div>
                    <h4 style="color: #155724; margin-top: 0;">âœ… ì‹ë¬¼ ê²Œë†ˆ ê¶Œì¥ ì „ëµ</h4>
                    <ul style="color: #155724; font-size: 14px;">
                        <li><strong>bcftools:</strong> ë¹ ë¥´ê³  íš¨ìœ¨ì , ëŒ€ë¶€ë¶„ ì‹ë¬¼ ì—°êµ¬ì— ì¶©ë¶„</li>
                        <li><strong>FreeBayes:</strong> ì§‘ë‹¨ ë¶„ì„ì´ë‚˜ polyploid ì‹ë¬¼ì— ìœ ë¦¬</li>
                        <li><strong>GATK (ì œí•œì ):</strong> ê³ í’ˆì§ˆ ì°¸ì¡°ê²Œë†ˆ + known sites ìˆëŠ” ì£¼ìš” ì‘ë¬¼ë§Œ</li>
                        <li><strong>ì¡°í•© ì‚¬ìš©:</strong> bcftoolsë¡œ ì´ˆê¸° ë¶„ì„ â†’ GATKë¡œ ì •ë°€ ê²€ì¦</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin-top: 15px;">
                <h4 style="color: #155724; margin-top: 0;">ğŸ’¡ ì‹¤ìš©ì  ê¶Œì¥ì‚¬í•­</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 10px;">
                    <div style="text-align: center;">
                        <strong style="color: #155724;">ğŸŒ¾ ì£¼ìš” ì‘ë¬¼</strong><br>
                        <span style="font-size: 12px; color: #155724;">(ë²¼, ì˜¥ìˆ˜ìˆ˜, ë°€ ë“±)</span><br>
                        <span style="font-size: 14px; color: #155724;">GATK ê³ ë ¤ ê°€ëŠ¥</span>
                    </div>
                    <div style="text-align: center;">
                        <strong style="color: #155724;">ğŸŒ¿ ì¼ë°˜ ì‹ë¬¼</strong><br>
                        <span style="font-size: 12px; color: #155724;">(Arabidopsis ë“±)</span><br>
                        <span style="font-size: 14px; color: #155724;">bcftools ê¶Œì¥</span>
                    </div>
                    <div style="text-align: center;">
                        <strong style="color: #155724;">ğŸ§¬ ì§‘ë‹¨/ì§„í™” ì—°êµ¬</strong><br>
                        <span style="font-size: 12px; color: #155724;">(ë‹¤ì–‘ì„±, ê³„í†µë¶„ì„)</span><br>
                        <span style="font-size: 14px; color: #155724;">FreeBayes ê¶Œì¥</span>
                    </div>
                </div>
            </div>
        </div>

        <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #ffc107;">
            <h3 style="color: #856404; margin-top: 0;">âš ï¸ ë©€í‹°ìƒ˜í”Œ VCF ìƒì„± ì‹œ ì¤‘ìš”í•œ ê³ ë ¤ì‚¬í•­</h3>
            
            <div style="background: #f8d7da; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #dc3545;">
                <h4 style="color: #721c24; margin-top: 0;">ğŸš¨ ì¼ê´€ëœ íŒŒì´í”„ë¼ì¸ì˜ ì¤‘ìš”ì„±</h4>
                <p style="color: #721c24; margin-bottom: 10px;">
                    <strong>ëª¨ë“  ìƒ˜í”Œì— ë™ì¼í•œ ë³€ì´ ê²€ì¶œ ë„êµ¬ì™€ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤!</strong>
                </p>
                <ul style="color: #721c24; font-size: 14px;">
                    <li><strong>ë„êµ¬ í˜¼ìš© ê¸ˆì§€:</strong> ì¼ë¶€ëŠ” GATK, ì¼ë¶€ëŠ” bcftools ì‚¬ìš© ì‹œ systematic bias ë°œìƒ</li>
                    <li><strong>íŒŒë¼ë¯¸í„° ì¼ê´€ì„±:</strong> ë™ì¼í•œ í•„í„°ë§ ê¸°ì¤€, í’ˆì§ˆ ì„ê³„ê°’ ì ìš© í•„ìˆ˜</li>
                    <li><strong>ì°¸ì¡° ê²Œë†ˆ í†µì¼:</strong> ëª¨ë“  ìƒ˜í”Œì— ë™ì¼í•œ reference genome ì‚¬ìš©</li>
                    <li><strong>ì „ì²˜ë¦¬ í†µì¼:</strong> ë™ì¼í•œ alignment, post-processing íŒŒì´í”„ë¼ì¸ ì ìš©</li>
                </ul>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div style="background: #f8d7da; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #721c24; margin-top: 0;">âŒ ì˜ëª»ëœ ì˜ˆì‹œ</h5>
                    <div style="font-family: monospace; font-size: 12px; color: #721c24;">
                        <div>ìƒ˜í”Œ1-10: bcftools call</div>
                        <div>ìƒ˜í”Œ11-20: GATK HaplotypeCaller</div>
                        <div style="margin-top: 10px; font-weight: bold;">â†’ ë¶„ì„ ê²°ê³¼ ë¹„êµ ë¶ˆê°€ëŠ¥!</div>
                    </div>
                </div>
                <div style="background: #d4edda; padding: 15px; border-radius: 8px;">
                    <h5 style="color: #155724; margin-top: 0;">âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ</h5>
                    <div style="font-family: monospace; font-size: 12px; color: #155724;">
                        <div>ì „ì²´ ìƒ˜í”Œ: bcftools mpileup + call</div>
                        <div>ë™ì¼ íŒŒë¼ë¯¸í„°: -mv -O v</div>
                        <div style="margin-top: 10px; font-weight: bold;">â†’ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë¹„êµ ë¶„ì„!</div>
                    </div>
                </div>
            </div>
            
            <div class="code-block">
                <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                <code># ë©€í‹°ìƒ˜í”Œ ì¼ê´€ëœ íŒŒì´í”„ë¼ì¸ ì˜ˆì‹œ
# ëª¨ë“  ìƒ˜í”Œì— ë™ì¼í•œ ëª…ë ¹ì–´ ì ìš©
for sample in sample1 sample2 sample3 ... sample20; do
    bcftools mpileup -f reference.fasta ${sample}.bam | \
        bcftools call -mv -O v -o ${sample}.vcf
done

# ë˜ëŠ” í•œ ë²ˆì— ë©€í‹°ìƒ˜í”Œ ì²˜ë¦¬
bcftools mpileup -f reference.fasta sample1.bam sample2.bam ... sample20.bam | \
    bcftools call -mv -O v -o multisample.vcf</code>
            </div>
            
            <div style="background: #cce5ff; padding: 15px; border-radius: 8px; margin-top: 15px;">
                <h4 style="color: #004085; margin-top: 0;">ğŸ’¡ ì™œ ì¼ê´€ì„±ì´ ì¤‘ìš”í•œê°€?</h4>
                <ul style="color: #004085; font-size: 14px;">
                    <li><strong>í†µê³„ì  ê²€ì •ë ¥:</strong> ë™ì¼í•œ ì˜¤ë¥˜ìœ¨ê³¼ ê°ë„ë¡œ ë³€ì´ ê²€ì¶œë˜ì–´ì•¼ ì •í™•í•œ ë¹„êµ ê°€ëŠ¥</li>
                    <li><strong>Batch effect ìµœì†Œí™”:</strong> ê¸°ìˆ ì  ë³€ì´ë¥¼ ì¤„ì—¬ ìƒë¬¼í•™ì  ì°¨ì´ì— ì§‘ì¤‘</li>
                    <li><strong>ì¬í˜„ì„± í™•ë³´:</strong> ë™ì¼í•œ ì¡°ê±´ì—ì„œ ë¶„ì„ ë°˜ë³µ ì‹œ ì¼ê´€ëœ ê²°ê³¼</li>
                    <li><strong>ë©”íƒ€ë¶„ì„ ê°€ëŠ¥:</strong> ë‹¤ë¥¸ ì—°êµ¬ì™€ì˜ ë°ì´í„° í†µí•© ë¶„ì„ ì‹œ ì‹ ë¢°ì„± ë³´ì¥</li>
                </ul>
            </div>
        </div>

        <div style="background: #e8f4fd; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #2196f3;">
            <h3 style="color: #1565c0; margin-top: 0;">ğŸ“„ VCF vs gVCF: íŒŒì¼ í˜•ì‹ì˜ ì°¨ì´ì </h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <h4 style="color: #856404; margin-top: 0;">ğŸ“Š VCF (Variant Call Format)</h4>
                    <ul style="color: #856404; font-size: 14px;">
                        <li><strong>ë‚´ìš©:</strong> ë³€ì´ê°€ ê²€ì¶œëœ ìœ„ì¹˜ë§Œ ê¸°ë¡</li>
                        <li><strong>íŠ¹ì§•:</strong> ì°¸ì¡° ê²Œë†ˆê³¼ ë‹¤ë¥¸ ìœ„ì¹˜ë§Œ í¬í•¨</li>
                        <li><strong>í¬ê¸°:</strong> ìƒëŒ€ì ìœ¼ë¡œ ì‘ì€ íŒŒì¼ í¬ê¸°</li>
                        <li><strong>ìš©ë„:</strong> ë‹¨ì¼ ìƒ˜í”Œ ë¶„ì„, ìµœì¢… ê²°ê³¼ ì €ì¥</li>
                        <li><strong>ì •ë³´ ì†ì‹¤:</strong> Non-variant ìœ„ì¹˜ ì •ë³´ ì—†ìŒ</li>
                    </ul>
                    <div style="background: #f8f8f8; padding: 10px; border-radius: 4px; margin-top: 10px; font-family: monospace; font-size: 12px;">
                        <div style="font-weight: bold;">VCF ì˜ˆì‹œ (ë³€ì´ ìœ„ì¹˜ë§Œ):</div>
                        <div>chr1  1000  SNP  A  G  60  PASS</div>
                        <div>chr1  2500  SNP  T  C  45  PASS</div>
                        <div style="color: #666;">â†’ ë³€ì´ ì—†ëŠ” ìœ„ì¹˜ëŠ” ê¸°ë¡ë˜ì§€ ì•ŠìŒ</div>
                    </div>
                </div>
                
                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
                    <h4 style="color: #155724; margin-top: 0;">ğŸ” gVCF (Genomic VCF)</h4>
                    <ul style="color: #155724; font-size: 14px;">
                        <li><strong>ë‚´ìš©:</strong> ëª¨ë“  ê²Œë†ˆ ìœ„ì¹˜ì˜ ì •ë³´ ê¸°ë¡</li>
                        <li><strong>íŠ¹ì§•:</strong> Variant + Non-variant ìœ„ì¹˜ ëª¨ë‘ í¬í•¨</li>
                        <li><strong>í¬ê¸°:</strong> í›¨ì”¬ í° íŒŒì¼ í¬ê¸°</li>
                        <li><strong>ìš©ë„:</strong> ë©€í‹°ìƒ˜í”Œ ë¶„ì„ ì¤‘ê°„ ë‹¨ê³„</li>
                        <li><strong>ì •ë³´ ë³´ì¡´:</strong> ëª¨ë“  ìœ„ì¹˜ì˜ likelihood ì •ë³´ ìœ ì§€</li>
                    </ul>
                    <div style="background: #f8f8f8; padding: 10px; border-radius: 4px; margin-top: 10px; font-family: monospace; font-size: 12px;">
                        <div style="font-weight: bold;">gVCF ì˜ˆì‹œ (ëª¨ë“  ìœ„ì¹˜):</div>
                        <div>chr1  999   .   G  &lt;NON_REF&gt;  .  .</div>
                        <div>chr1  1000  SNP A  G,&lt;NON_REF&gt; 60 PASS</div>
                        <div>chr1  1001  .   T  &lt;NON_REF&gt;  .  .</div>
                        <div style="color: #666;">â†’ ëª¨ë“  ìœ„ì¹˜ì˜ ì •ë³´ê°€ ë³´ì¡´ë¨</div>
                    </div>
                </div>
            </div>
            
            <div style="background: #f0f8ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <h4 style="color: #1565c0; margin-top: 0;">ğŸ”„ gVCF ì›Œí¬í”Œë¡œìš° ë¹„êµ</h4>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; border-left: 4px solid #2196f3;">
                        <h5 style="color: #1565c0; margin-top: 0;">ğŸ§¬ GATK gVCF ì›Œí¬í”Œë¡œìš°</h5>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; text-align: center; margin: 10px 0;">
                            <div style="background: #bbdefb; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>1. Individual gVCF</strong><br>
                                HaplotypeCaller
                            </div>
                            <div style="background: #c8e6c9; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>2. CombineGVCFs</strong><br>
                                ì—¬ëŸ¬ gVCF í†µí•©
                            </div>
                            <div style="background: #ffe0b2; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>3. GenotypeGVCFs</strong><br>
                                ìµœì¢… VCF ìƒì„±
                            </div>
                            <div style="background: #f8bbd9; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>4. Analysis</strong><br>
                                downstream ë¶„ì„
                            </div>
                        </div>
                        
                        <div class="code-block" style="margin-top: 10px;">
                            <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                            <code># GATK gVCF ì›Œí¬í”Œë¡œìš°
# 1. ê° ìƒ˜í”Œë³„ gVCF ìƒì„±
gatk HaplotypeCaller \
    -R reference.fasta \
    -I sample1.bam \
    -O sample1.g.vcf \
    -ERC GVCF

# 2. ì—¬ëŸ¬ gVCF í†µí•©
gatk CombineGVCFs \
    -R reference.fasta \
    --variant sample1.g.vcf \
    --variant sample2.g.vcf \
    -O cohort.g.vcf

# 3. ìµœì¢… ë©€í‹°ìƒ˜í”Œ VCF ìƒì„±
gatk GenotypeGVCFs \
    -R reference.fasta \
    --variant cohort.g.vcf \
    -O final_multisample.vcf</code>
                        </div>
                    </div>
                    
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <h5 style="color: #2e7d32; margin-top: 0;">âš¡ bcftools gVCF ì›Œí¬í”Œë¡œìš°</h5>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; text-align: center; margin: 10px 0;">
                            <div style="background: #c8e6c9; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>1. mpileup gVCF</strong><br>
                                -a ì˜µì…˜ìœ¼ë¡œ ëª¨ë“  ìœ„ì¹˜
                            </div>
                            <div style="background: #dcedc8; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>2. merge (ì„ íƒ)</strong><br>
                                ì—¬ëŸ¬ gVCF í†µí•©
                            </div>
                            <div style="background: #f1f8e9; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>3. call</strong><br>
                                ìµœì¢… VCF ìƒì„±
                            </div>
                            <div style="background: #f8bbd9; padding: 8px; border-radius: 4px; font-size: 12px;">
                                <strong>4. Analysis</strong><br>
                                downstream ë¶„ì„
                            </div>
                        </div>
                        
                        <div class="code-block" style="margin-top: 10px;">
                            <button class="copy-btn" onclick="copyCode(this)">ë³µì‚¬</button>
                            <code># bcftools gVCF ì›Œí¬í”Œë¡œìš°
# 1. ê° ìƒ˜í”Œë³„ gVCF ìƒì„± (-a ì˜µì…˜ìœ¼ë¡œ ëª¨ë“  ìœ„ì¹˜ í¬í•¨)
bcftools mpileup -f reference.fasta \
    -a FORMAT/DP,FORMAT/AD,INFO/AD \
    sample1.bam -O b -o sample1.g.bcf

# 2. ì—¬ëŸ¬ gVCF í†µí•© (ì„ íƒì‚¬í•­)
bcftools merge sample1.g.bcf sample2.g.bcf \
    -O b -o cohort.g.bcf

# 3. ìµœì¢… ë©€í‹°ìƒ˜í”Œ VCF ìƒì„±
bcftools call -mv cohort.g.bcf \
    -O v -o final_multisample.vcf

# ë˜ëŠ” í•œ ë²ˆì— ë©€í‹°ìƒ˜í”Œ ì²˜ë¦¬
bcftools mpileup -f reference.fasta \
    -a FORMAT/DP,FORMAT/AD \
    sample1.bam sample2.bam sample3.bam | \
    bcftools call -mv -O v -o multisample.vcf</code>
                        </div>
                        
                        <div style="background: #c8e6c9; padding: 10px; border-radius: 4px; margin-top: 10px;">
                            <strong style="color: #2e7d32; font-size: 14px;">bcftoolsì˜ ì¥ì :</strong>
                            <ul style="color: #2e7d32; font-size: 12px; margin: 5px 0; padding-left: 15px;">
                                <li>ë” ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„</li>
                                <li>ë‚®ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</li>
                                <li>íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì—°ê²° ê°€ëŠ¥</li>
                                <li>ì‹ë¬¼ ê²Œë†ˆì— ë” ì í•©</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #ffc107;">
                    <h5 style="color: #856404; margin-top: 0;">ğŸ”„ ì›Œí¬í”Œë¡œìš° ì„ íƒ ê°€ì´ë“œ</h5>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 10px;">
                        <div>
                            <strong style="color: #856404;">GATK gVCF ì‚¬ìš© ì‹œ:</strong>
                            <ul style="color: #856404; font-size: 13px; margin: 5px 0;">
                                <li>ì¸ê°„ ê²Œë†ˆ ë¶„ì„</li>
                                <li>ìµœê³  ì •í™•ë„ í•„ìš”</li>
                                <li>Known sites í™œìš© ê°€ëŠ¥</li>
                                <li>ëŒ€ê·œëª¨ ì½”í˜¸íŠ¸ ì—°êµ¬</li>
                            </ul>
                        </div>
                        <div>
                            <strong style="color: #856404;">bcftools gVCF ì‚¬ìš© ì‹œ:</strong>
                            <ul style="color: #856404; font-size: 13px; margin: 5px 0;">
                                <li>ì‹ë¬¼/ë¹„ëª¨ë¸ ìƒë¬¼ ê²Œë†ˆ</li>
                                <li>ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„ ì¤‘ìš”</li>
                                <li>ì œí•œëœ ì»´í“¨íŒ… ìì›</li>
                                <li>ê°„ë‹¨í•œ íŒŒì´í”„ë¼ì¸ ì„ í˜¸</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #ffc107;">
                <h4 style="color: #856404; margin-top: 0;">ğŸ’¡ ì–¸ì œ ì–´ë–¤ í˜•ì‹ì„ ì‚¬ìš©í•´ì•¼ í• ê¹Œ?</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 10px;">
                    <div>
                        <h5 style="color: #856404; margin-top: 0;">ğŸ“Š VCF ì‚¬ìš© ì‹œê¸°</h5>
                        <ul style="color: #856404; font-size: 14px;">
                            <li>ë‹¨ì¼ ìƒ˜í”Œ ë¶„ì„</li>
                            <li>ìµœì¢… ê²°ê³¼ë¬¼ ì €ì¥</li>
                            <li>bcftools, FreeBayes ì‚¬ìš©</li>
                            <li>ì €ì¥ ê³µê°„ ì ˆì•½ í•„ìš”</li>
                        </ul>
                    </div>
                    <div>
                        <h5 style="color: #856404; margin-top: 0;">ğŸ” gVCF ì‚¬ìš© ì‹œê¸°</h5>
                        <ul style="color: #856404; font-size: 14px;">
                            <li>ëŒ€ê·œëª¨ ë©€í‹°ìƒ˜í”Œ ë¶„ì„</li>
                            <li>GATK Best Practices</li>
                            <li>ì ì§„ì  ìƒ˜í”Œ ì¶”ê°€ ì˜ˆì •</li>
                            <li>ì •í™•í•œ joint calling í•„ìš”</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToFirst()">ğŸ  ì²˜ìŒ</button>
    <button class="nav-btn" onclick="prevSlide()">â—€ ì´ì „</button>
    <button class="nav-btn" onclick="nextSlide()">ë‹¤ìŒ â–¶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">â›¶ ì „ì²´í™”ë©´</button>
</div>

<div class="slide-number">ìŠ¬ë¼ì´ë“œ 5 / 7</div>

<script>
    function prevSlide() {
        window.location.href = "slide04.html";
    }
    
    function nextSlide() {
        window.location.href = "slide06.html";
    }
    
    function jumpToFirst() {
        window.location.href = "slide01.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    function copyCode(button) {
        const codeBlock = button.nextElementSibling;
        const codeText = codeBlock.textContent.trim();
        
        navigator.clipboard.writeText(codeText).then(function() {
            button.textContent = 'ë³µì‚¬ë¨!';
            button.classList.add('copied');
            setTimeout(function() {
                button.textContent = 'ë³µì‚¬';
                button.classList.remove('copied');
            }, 2000);
        }).catch(function() {
            // Fallback for older browsers
            const textArea = document.createElement('textarea');
            textArea.value = codeText;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                button.textContent = 'ë³µì‚¬ë¨!';
                button.classList.add('copied');
                setTimeout(function() {
                    button.textContent = 'ë³µì‚¬';
                    button.classList.remove('copied');
                }, 2000);
            } catch (err) {
                console.error('Copy failed:', err);
            }
            document.body.removeChild(textArea);
        });
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToFirst();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
</script>

</body>
</html>