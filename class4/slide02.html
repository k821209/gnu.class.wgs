<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>데이터 탐색 - FASTQ 파일 구조 이해 및 품질 평가</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #27ae60; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #27ae60; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { background: #1e1e1e; color: #f8f8f2; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; font-size: 14px; white-space: pre-wrap; border: 1px solid #444; position: relative; }
        .code-block-container { position: relative; }
        .copy-button { position: absolute; top: 10px; right: 10px; background: #444; color: #f8f8f2; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; opacity: 0.7; transition: opacity 0.2s; }
        .copy-button:hover { opacity: 1; background: #555; }
        .copy-button.copied { background: #27ae60; color: white; }
        .copy-button.copied:after { content: " ✓"; }
        
        /* Syntax highlighting color classes */
        .comment { color: #75715e; } /* Comments */
        .keyword { color: #f92672; } /* Keywords */
        .function { color: #a6e22e; } /* Function names */
        .string { color: #e6db74; } /* Strings */
        .number { color: #ae81ff; } /* Numbers */
        .param { color: #fd971f; } /* Parameters */
        .variable { color: #f8f8f2; } /* Variables */
        .builtin { color: #a6e22e; } /* Built-in functions */
        .operator { color: #f92672; } /* Operators */
        .shebang { color: #75715e; } /* Shebang */
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #27ae60; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #229954; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #3498db; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #2980b9; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #27ae60; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .setup-steps { background: #e8f4fd; border-left: 4px solid #3498db; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .fastq-example { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin: 15px 0; font-family: 'Courier New', monospace; font-size: 14px; }
        .fastq-line { margin: 5px 0; padding: 3px 8px; border-radius: 3px; }
        .fastq-header { background: #e3f2fd; color: #1565c0; }
        .fastq-sequence { background: #e8f5e8; color: #2e7d32; }
        .fastq-plus { background: #fff3e0; color: #ef6c00; }
        .fastq-quality { background: #fce4ec; color: #c2185b; }
        .quality-table { width: 100%; border-collapse: collapse; margin: 15px 0; }
        .quality-table th, .quality-table td { border: 1px solid #dee2e6; padding: 8px; text-align: center; font-size: 14px; }
        .quality-table th { background: #f8f9fa; font-weight: bold; }
    </style>
</head>
<body>

<div class="slide">
    <div class="slide-title">🔍 데이터 탐색</div>
    <div class="slide-content">
        <h2>📊 FASTQ 파일 구조 이해</h2>
        <p>생물정보학 분석의 첫 번째 단계는 데이터의 구조를 이해하는 것입니다. FASTQ 파일은 NGS(Next Generation Sequencing) 데이터의 표준 형식입니다.</p>

        <h3>🧬 FASTQ 파일 형식</h3>
        <p>FASTQ 파일은 4줄로 구성된 블록이 반복되는 구조입니다:</p>
        
        <div class="fastq-example">
            <div class="fastq-line fastq-header">@ERR3184150.1 1 length=150</div>
            <div class="fastq-line fastq-sequence">ATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCGATCG</div>
            <div class="fastq-line fastq-plus">+</div>
            <div class="fastq-line fastq-quality">IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII</div>
        </div>
        
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #1565c0;">
                <h4><i class="fas fa-info-circle"></i> 줄별 설명</h4>
                <ul>
                    <li><strong>1줄 (Header):</strong> '@'로 시작하는 서열 식별자</li>
                    <li><strong>2줄 (Sequence):</strong> 실제 DNA 서열 (A, T, G, C, N)</li>
                    <li><strong>3줄 (Plus):</strong> '+'로 시작하는 구분자</li>
                    <li><strong>4줄 (Quality):</strong> 각 염기의 품질 점수</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #2e7d32;">
                <h4><i class="fas fa-dna"></i> 서열 정보</h4>
                <ul>
                    <li><strong>길이:</strong> 일반적으로 150bp (이 실습에서는 150bp)</li>
                    <li><strong>방향:</strong> 5' → 3' 방향</li>
                    <li><strong>염기:</strong> A(아데닌), T(티민), G(구아닌), C(시토신)</li>
                    <li><strong>N:</strong> 결정되지 않은 염기</li>
                </ul>
            </div>
        </div>

        <h3>📈 품질 점수 (Quality Score)</h3>
        <p>FASTQ 파일의 4번째 줄은 각 염기의 품질을 나타냅니다. 품질 점수는 Phred 점수로 표현됩니다.</p>
        
        <div class="setup-steps">
            <h4><i class="fas fa-calculator"></i> Phred 품질 점수 계산</h4>
            <p><strong>공식:</strong> Q = -10 × log₁₀(P)</p>
            <ul>
                <li><strong>Q:</strong> Phred 품질 점수</li>
                <li><strong>P:</strong> 염기 호출 오류 확률</li>
                <li><strong>예시:</strong> Q30 = 99.9% 정확도 (오류율 0.1%)</li>
            </ul>
        </div>

        <table class="quality-table">
            <tr>
                <th>문자</th>
                <th>ASCII 값</th>
                <th>Phred 점수</th>
                <th>정확도</th>
                <th>오류율</th>
            </tr>
            <tr>
                <td>!</td>
                <td>33</td>
                <td>0</td>
                <td>0%</td>
                <td>100%</td>
            </tr>
            <tr>
                <td>*</td>
                <td>42</td>
                <td>9</td>
                <td>87.4%</td>
                <td>12.6%</td>
            </tr>
            <tr>
                <td>9</td>
                <td>57</td>
                <td>24</td>
                <td>99.37%</td>
                <td>0.63%</td>
            </tr>
            <tr>
                <td>?</td>
                <td>63</td>
                <td>30</td>
                <td>99.9%</td>
                <td>0.1%</td>
            </tr>
            <tr>
                <td>I</td>
                <td>73</td>
                <td>40</td>
                <td>99.99%</td>
                <td>0.01%</td>
            </tr>
        </table>


        <div style="background: #d4edda; padding: 15px; margin: 15px 0; border-radius: 6px; border-left: 4px solid #28a745;">
            <h4 style="color: #155724; margin: 0 0 10px 0;"><i class="fas fa-lightbulb"></i> 데이터 품질 평가 기준</h4>
            <ul style="color: #155724; margin: 0; font-size: 14px;">
                <li><strong>Q30 이상:</strong> 매우 높은 품질 (99.9% 정확도)</li>
                <li><strong>Q20-Q30:</strong> 좋은 품질 (99-99.9% 정확도)</li>
                <li><strong>Q20 미만:</strong> 낮은 품질 (품질 관리 필요)</li>
                <li><strong>GC 함량:</strong> 종별 특성에 따라 다름 (콩: ~34%)</li>
                <li><strong>N의 비율:</strong> 1% 미만이 이상적</li>
            </ul>
        </div>

        <h2>📁 주요 생물정보학 파일 형식</h2>
        <p>WGS 분석 과정에서 만나게 될 주요 파일 형식들을 이해해보겠습니다. 각 단계에서 생성되는 파일들의 구조와 특징을 알아봅시다.</p>

        <h3>🧾 SAM/BAM 파일 (정렬 결과)</h3>
        <p>FASTQ 파일을 참조 게놈에 정렬한 결과를 저장하는 형식입니다.</p>
        
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #3498db;">
                <h4><i class="fas fa-file-alt"></i> SAM (Sequence Alignment/Map)</h4>
                <ul>
                    <li><strong>형식:</strong> 텍스트 파일 (.sam)</li>
                    <li><strong>구조:</strong> 헤더 + 정렬 정보</li>
                    <li><strong>크기:</strong> 큼 (압축되지 않음)</li>
                    <li><strong>사용:</strong> 디버깅, 수동 확인</li>
                    <li><strong>가독성:</strong> 사람이 읽기 가능</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #2980b9;">
                <h4><i class="fas fa-file-archive"></i> BAM (Binary SAM)</h4>
                <ul>
                    <li><strong>형식:</strong> 이진 파일 (.bam)</li>
                    <li><strong>구조:</strong> 압축된 SAM</li>
                    <li><strong>크기:</strong> 작음 (고효율 압축)</li>
                    <li><strong>사용:</strong> 실제 분석, 저장</li>
                    <li><strong>속도:</strong> 빠른 처리</li>
                </ul>
            </div>
        </div>

        <div class="setup-steps">
            <h4><i class="fas fa-table"></i> SAM 파일 구조 (11개 필수 컬럼)</h4>
            <div class="fastq-example">
                <div style="font-weight: bold; margin-bottom: 10px;">@HD	VN:1.6	SO:coordinate</div>
                <div style="font-weight: bold; margin-bottom: 10px;">@SQ	SN:glyma.Wm82.gnm2.Gm01	LN:56831624</div>
                <div style="font-family: monospace; font-size: 12px;">
ERR3184150.1	99	glyma.Wm82.gnm2.Gm01	1000	60	150M	=	1150	300	ATCGATCGAT...	IIIIIIIIII...	NM:i:0	MD:Z:150
                </div>
            </div>
            
            <table class="quality-table" style="margin-top: 15px;">
                <tr>
                    <th>컬럼</th>
                    <th>이름</th>
                    <th>설명</th>
                    <th>예시</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>QNAME</td>
                    <td>리드 이름</td>
                    <td>ERR3184150.1</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>FLAG</td>
                    <td>정렬 속성</td>
                    <td>99 (paired, proper)</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>RNAME</td>
                    <td>염색체</td>
                    <td>glyma.Wm82.gnm2.Gm01</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>POS</td>
                    <td>정렬 위치</td>
                    <td>1000</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>MAPQ</td>
                    <td>매핑 품질</td>
                    <td>60</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>CIGAR</td>
                    <td>정렬 형태</td>
                    <td>150M (150bp 매치)</td>
                </tr>
            </table>
        </div>

        <h4>🎯 CIGAR 문자열 상세 설명</h4>
        <p>CIGAR (Compact Idiosyncratic Gapped Alignment Report)는 리드가 참조 게놈에 어떻게 정렬되었는지를 간결하게 표현하는 문자열입니다.</p>
        
        <div class="setup-steps">
            <h4><i class="fas fa-code"></i> CIGAR 연산자</h4>
            <table class="quality-table">
                <tr>
                    <th>연산자</th>
                    <th>이름</th>
                    <th>설명</th>
                    <th>예시</th>
                </tr>
                <tr>
                    <td><strong>M</strong></td>
                    <td>Match/Mismatch</td>
                    <td>정렬된 염기 (매치 또는 미스매치)</td>
                    <td>100M = 100bp 정렬</td>
                </tr>
                <tr>
                    <td><strong>=</strong></td>
                    <td>Sequence Match</td>
                    <td>참조와 정확히 일치하는 염기</td>
                    <td>50= = 50bp 정확한 매치</td>
                </tr>
                <tr>
                    <td><strong>X</strong></td>
                    <td>Sequence Mismatch</td>
                    <td>참조와 다른 염기 (SNP 등)</td>
                    <td>1X = 1bp 미스매치</td>
                </tr>
                <tr>
                    <td><strong>I</strong></td>
                    <td>Insertion</td>
                    <td>리드에만 있는 염기 (삽입)</td>
                    <td>3I = 3bp 삽입</td>
                </tr>
                <tr>
                    <td><strong>D</strong></td>
                    <td>Deletion</td>
                    <td>참조에만 있는 염기 (결실)</td>
                    <td>2D = 2bp 결실</td>
                </tr>
                <tr>
                    <td><strong>S</strong></td>
                    <td>Soft Clipping</td>
                    <td>정렬되지 않은 리드 끝부분</td>
                    <td>10S = 10bp 소프트 클리핑</td>
                </tr>
                <tr>
                    <td><strong>H</strong></td>
                    <td>Hard Clipping</td>
                    <td>완전히 제거된 리드 부분</td>
                    <td>5H = 5bp 하드 클리핑</td>
                </tr>
                <tr>
                    <td><strong>N</strong></td>
                    <td>Skipped Region</td>
                    <td>참조에서 건너뛴 영역 (인트론 등)</td>
                    <td>1000N = 1000bp 건너뜀</td>
                </tr>
                <tr>
                    <td><strong>P</strong></td>
                    <td>Padding</td>
                    <td>정렬에서 무시된 영역</td>
                    <td>5P = 5bp 패딩</td>
                </tr>
            </table>
        </div>

        <h4>📖 CIGAR 해석 예시</h4>
        <p>실제 CIGAR 문자열들을 분석해보겠습니다:</p>

        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #27ae60;">
                <h4><i class="fas fa-check-circle"></i> 완벽한 정렬</h4>
                <div class="fastq-example" style="margin: 10px 0;">
                    <div style="font-family: monospace; font-weight: bold;">CIGAR: 150M</div>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        150개 염기가 모두 참조 게놈에 정렬됨<br>
                        (매치 또는 미스매치 포함)
                    </div>
                </div>
                <div style="background: #e8f5e8; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px;">
참조: ATCGATCGATCG...(150bp)<br>
리드: ATCGATCGATCG...(150bp)<br>
     ||||||||||||<br>
     150M
                </div>
            </div>
            
            <div class="comparison-item" style="border-left-color: #f39c12;">
                <h4><i class="fas fa-cut"></i> 소프트 클리핑</h4>
                <div class="fastq-example" style="margin: 10px 0;">
                    <div style="font-family: monospace; font-weight: bold;">CIGAR: 10S140M</div>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        앞 10bp는 정렬되지 않음<br>
                        나머지 140bp는 정렬됨
                    </div>
                </div>
                <div style="background: #fff3e0; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px;">
참조:     ATCGATCGATCG...(140bp)<br>
리드: NNNNNNNNNN ATCGATCGATCG...(150bp)<br>
     10S      140M
                </div>
            </div>
        </div>

        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4><i class="fas fa-exchange-alt"></i> 삽입과 결실</h4>
                <div class="fastq-example" style="margin: 10px 0;">
                    <div style="font-family: monospace; font-weight: bold;">CIGAR: 50M3I47M2D50M</div>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        50bp 매치 → 3bp 삽입 → 47bp 매치 → 2bp 결실 → 50bp 매치
                    </div>
                </div>
                <div style="background: #fce4ec; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px;">
참조: ATCG...TCGA--CGATCG...AATTCC<br>
리드: ATCG...TCGAAACGATCG...AA--CC<br>
     50M   3I   47M     2D 50M
                </div>
            </div>
            
            <div class="comparison-item" style="border-left-color: #9b59b6;">
                <h4><i class="fas fa-dna"></i> RNA-seq 정렬</h4>
                <div class="fastq-example" style="margin: 10px 0;">
                    <div style="font-family: monospace; font-weight: bold;">CIGAR: 75M1000N75M</div>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        75bp 매치 → 1000bp 건너뜀(인트론) → 75bp 매치
                    </div>
                </div>
                <div style="background: #f3e5f5; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px;">
참조: EXON1---[INTRON 1000bp]---EXON2<br>
리드: EXON1..................EXON2<br>
     75M        1000N        75M
                </div>
            </div>
        </div>


        <div style="background: #d4edda; padding: 15px; margin: 15px 0; border-radius: 6px; border-left: 4px solid #28a745;">
            <h4 style="color: #155724; margin: 0 0 10px 0;"><i class="fas fa-lightbulb"></i> CIGAR 해석 팁</h4>
            <ul style="color: #155724; margin: 0; font-size: 14px;">
                <li><strong>정렬 품질 평가:</strong> 너무 많은 I, D, S는 낮은 품질 정렬을 의미</li>
                <li><strong>변이 검출:</strong> I, D 영역은 INDEL 변이 후보</li>
                <li><strong>RNA-seq:</strong> N 연산자는 스플라이싱 접합부를 나타냄</li>
                <li><strong>품질 관리:</strong> 과도한 소프트 클리핑(S)은 어댑터 잔존 가능성</li>
                <li><strong>게놈 구조:</strong> 복잡한 CIGAR는 구조 변이를 시사할 수 있음</li>
            </ul>
        </div>

        <h3>🧬 VCF/gVCF 파일 (변이 정보)</h3>
        <p>유전적 변이 (SNP, INDEL)를 저장하는 표준 형식입니다.</p>
        
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4><i class="fas fa-dna"></i> VCF (Variant Call Format)</h4>
                <ul>
                    <li><strong>내용:</strong> 확인된 변이만 저장</li>
                    <li><strong>크기:</strong> 상대적으로 작음</li>
                    <li><strong>용도:</strong> 최종 변이 분석</li>
                    <li><strong>형식:</strong> 탭 구분 텍스트</li>
                    <li><strong>표준:</strong> 가장 널리 사용</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #c0392b;">
                <h4><i class="fas fa-layer-group"></i> gVCF (Genomic VCF)</h4>
                <ul>
                    <li><strong>내용:</strong> 모든 위치 정보 포함</li>
                    <li><strong>크기:</strong> 큼 (전체 게놈)</li>
                    <li><strong>용도:</strong> 다중 샘플 분석</li>
                    <li><strong>장점:</strong> 변이 재호출 가능</li>
                    <li><strong>GATK:</strong> HaplotypeCaller 출력</li>
                </ul>
            </div>
        </div>

        <h4>🔍 VCF vs gVCF 실제 비교 예시</h4>
        <div class="setup-steps" style="background: #f8f9fa; border-left-color: #6c757d;">
            <h5><i class="fas fa-microscope"></i> 동일한 게놈 영역의 VCF와 gVCF 출력 비교</h5>
            
            <p style="margin-bottom: 15px;">같은 샘플의 glyma.Wm82.gnm2.Gm01:1000-1010 영역에서 위치 1005에 A→G SNP가 있다고 가정해보겠습니다:</p>
            
            <div class="comparison-table">
                <div class="comparison-item" style="border-left-color: #e74c3c;">
                    <h4><i class="fas fa-file-alt"></i> VCF 출력 (변이만 기록)</h4>
                    <div style="background: #1e1e1e; color: #f8f8f2; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 11px; margin: 10px 0; white-space: pre-wrap;">##fileformat=VCFv4.2
##reference=soybean_genome.fa
#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	SAMPLE1
glyma.Wm82.gnm2.Gm01	1005	.	A	G	85.2	PASS	DP=35;AF=0.5;MQ=60	GT:DP:GQ:AD	0/1:35:80:18,17</div>
                    <ul style="font-size: 13px;">
                        <li><strong>기록된 위치:</strong> 1개 (변이 위치만)</li>
                        <li><strong>파일 크기:</strong> 작음 (~수 MB)</li>
                        <li><strong>처리 속도:</strong> 빠름</li>
                        <li><strong>정보 손실:</strong> 비변이 위치 정보 없음</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #c0392b;">
                    <h4><i class="fas fa-layer-group"></i> gVCF 출력 (모든 위치 기록)</h4>
                    <div style="background: #1e1e1e; color: #f8f8f2; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 11px; margin: 10px 0; white-space: pre-wrap;">##fileformat=VCFv4.2
##reference=soybean_genome.fa
#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	SAMPLE1
glyma.Wm82.gnm2.Gm01	1000	.	C	&lt;NON_REF&gt;	.	.	END=1004	GT:DP:GQ:MIN_DP	0/0:32:90:30
glyma.Wm82.gnm2.Gm01	1005	.	A	G,&lt;NON_REF&gt;	85.2	PASS	DP=35;MQ=60	GT:DP:GQ:AD:PL	0/1:35:80:18,17,0:120,0,135,140,185,250
glyma.Wm82.gnm2.Gm01	1006	.	T	&lt;NON_REF&gt;	.	.	END=1010	GT:DP:GQ:MIN_DP	0/0:33:85:28</div>
                    <ul style="font-size: 13px;">
                        <li><strong>기록된 위치:</strong> 11개 (모든 위치)</li>
                        <li><strong>파일 크기:</strong> 큼 (~수 GB)</li>
                        <li><strong>처리 속도:</strong> 느림</li>
                        <li><strong>정보 보존:</strong> 모든 위치 신뢰도 포함</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: #e8f4fd; padding: 15px; margin: 15px 0; border-radius: 6px; border-left: 4px solid #3498db;">
                <h5 style="color: #1976d2; margin: 0 0 10px 0;"><i class="fas fa-key"></i> gVCF 핵심 특징 해설</h5>
                <div class="tool-comparison" style="grid-template-columns: 1fr 1fr; margin-top: 10px;">
                    <div class="comparison-item" style="border-left-color: #28a745; background: #ffffff;">
                        <h4><i class="fas fa-compress-alt"></i> 블록 압축 (END 태그)</h4>
                        <ul style="font-size: 13px;">
                            <li><strong>glyma.Wm82.gnm2.Gm01:1000-1004:</strong> 연속된 비변이 구간</li>
                            <li><strong>END=1004:</strong> 1000-1004 모두 동일한 특성</li>
                            <li><strong>MIN_DP=30:</strong> 구간 내 최소 깊이</li>
                            <li><strong>효과:</strong> 파일 크기 대폭 감소</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-item" style="border-left-color: #dc3545; background: #ffffff;">
                        <h4><i class="fas fa-question-circle"></i> &lt;NON_REF&gt; 의미</h4>
                        <ul style="font-size: 13px;">
                            <li><strong>정의:</strong> "참조가 아닌 모든 가능성"</li>
                            <li><strong>용도:</strong> 미래 다중샘플 분석 대비</li>
                            <li><strong>PL:</strong> 각 유전자형의 가능도</li>
                            <li><strong>장점:</strong> 재분석 시 정보 손실 없음</li>
                        </ul>
                        
                        <div style="background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; border-left: 3px solid #dc3545;">
                            <strong>🤔 &lt;NON_REF&gt; 결정 과정:</strong><br>
                            <div style="font-size: 11px; margin-top: 8px;">
                                <strong>1. 리드 분석:</strong> 각 위치의 모든 리드 검사<br>
                                <strong>2. 통계 계산:</strong> 각 염기(A,T,G,C)의 빈도와 품질<br>
                                <strong>3. 임계값 적용:</strong> 변이 호출 신뢰도 평가<br>
                                <strong>4. 결정:</strong> 확실한 변이 vs 불확실한 위치
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; margin: 15px 0; border-radius: 6px; border-left: 4px solid #ffc107;">
                <h5 style="color: #856404; margin: 0 0 10px 0;"><i class="fas fa-search"></i> &lt;NON_REF&gt; 결정 과정 상세 분석</h5>
                <p style="font-size: 13px; margin-bottom: 15px;">GATK HaplotypeCaller가 각 위치를 &lt;NON_REF&gt;로 분류하는 과정을 단계별로 살펴보겠습니다:</p>
                
                <div class="tool-comparison" style="grid-template-columns: 1fr 1fr; margin-top: 10px;">
                    <div class="comparison-item" style="border-left-color: #28a745; background: #ffffff;">
                        <h4><i class="fas fa-microscope"></i> 1. 리드 수집 및 분석</h4>
                        <div style="background: #1e1e1e; color: #f8f8f2; padding: 8px; border-radius: 4px; font-family: monospace; font-size: 10px; margin: 8px 0; white-space: pre-wrap;">위치 glyma.Wm82.gnm2.Gm01:1000 (참조: C)
리드1: CATCG... (품질: 40,38,35,...)
리드2: CATCG... (품질: 42,40,38,...)
리드3: CATCG... (품질: 39,37,36,...)
...총 32개 리드</div>
                        <ul style="font-size: 12px;">
                            <li><strong>커버리지:</strong> 32x (32개 리드)</li>
                            <li><strong>관찰 염기:</strong> 모두 C (참조와 일치)</li>
                            <li><strong>품질 분포:</strong> 평균 Q38</li>
                            <li><strong>일치율:</strong> 100% (32/32)</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-item" style="border-left-color: #17a2b8; background: #ffffff;">
                        <h4><i class="fas fa-calculator"></i> 2. 통계적 분석</h4>
                        <div style="background: #f8f9fa; padding: 8px; border-radius: 4px; font-size: 11px; margin: 8px 0;">
                            <strong>🧮 베이지안 통계 계산:</strong><br>
                            • P(0/0|data) = 0.999 (참조 호모)<br>
                            • P(0/1|data) = 0.001 (헤테로)<br>
                            • P(1/1|data) = 0.000 (변이 호모)<br>
                            • P(other|data) = 0.000 (기타)
                        </div>
                        <ul style="font-size: 12px;">
                            <li><strong>GQ:</strong> 90 (99.999% 신뢰도)</li>
                            <li><strong>DP:</strong> 32 (충분한 깊이)</li>
                            <li><strong>MIN_DP:</strong> 30 (최소 깊이)</li>
                            <li><strong>결론:</strong> 확실한 참조 호모접합</li>
                        </ul>
                    </div>
                </div>
                
                <div class="tool-comparison" style="grid-template-columns: 1fr 1fr; margin-top: 10px;">
                    <div class="comparison-item" style="border-left-color: #dc3545; background: #ffffff;">
                        <h4><i class="fas fa-balance-scale"></i> 3. 임계값 적용</h4>
                        <div style="background: #f8f9fa; padding: 8px; border-radius: 4px; font-size: 11px; margin: 8px 0;">
                            <strong>📏 GATK 기본 임계값:</strong><br>
                            • <strong>GQ ≥ 30:</strong> 신뢰할 수 있는 유전자형<br>
                            • <strong>DP ≥ 10:</strong> 충분한 커버리지<br>
                            • <strong>QUAL ≥ 30:</strong> 호출 품질 기준<br>
                            • <strong>AF < 0.1:</strong> 변이 빈도 임계값
                        </div>
                        <ul style="font-size: 12px;">
                            <li><strong>현재 값:</strong> 모든 기준 만족</li>
                            <li><strong>변이 증거:</strong> 없음</li>
                            <li><strong>품질:</strong> 높음</li>
                            <li><strong>판정:</strong> 확실한 비변이</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-item" style="border-left-color: #f39c12; background: #ffffff;">
                        <h4><i class="fas fa-decision"></i> 4. 최종 결정</h4>
                        <div style="background: #e8f4fd; padding: 8px; border-radius: 4px; font-size: 11px; margin: 8px 0;">
                            <strong>🎯 결정 로직:</strong><br>
                            <strong>IF</strong> 확실한 변이 → ALT에 구체적 염기<br>
                            <strong>ELSE IF</strong> 불확실 → &lt;NON_REF&gt; 포함<br>
                            <strong>ELSE</strong> 확실한 참조 → &lt;NON_REF&gt;만
                        </div>
                        <ul style="font-size: 12px;">
                            <li><strong>이 경우:</strong> 확실한 참조 (0/0)</li>
                            <li><strong>ALT:</strong> &lt;NON_REF&gt;</li>
                            <li><strong>의미:</strong> 참조가 아닌 모든 가능성</li>
                            <li><strong>목적:</strong> 미래 재분석 대비</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: #e8f4fd; padding: 12px; margin: 15px 0; border-radius: 4px; font-size: 12px; border-left: 3px solid #3498db;">
                    <strong>🔍 왜 &lt;NON_REF&gt;를 사용하는가?</strong><br>
                    • <strong>유연성:</strong> 미래에 다른 샘플에서 변이 발견시 재분석 가능<br>
                    • <strong>확장성:</strong> 새로운 샘플 추가시 기존 데이터 재사용<br>
                    • <strong>정확성:</strong> "변이 없음"이 아닌 "현재 변이 증거 없음"<br>
                    • <strong>효율성:</strong> 공동 변이 호출(joint calling) 시 정보 보존
                </div>
                
                <div style="background: #fff3cd; padding: 12px; margin: 15px 0; border-radius: 4px; font-size: 12px; border-left: 3px solid #ffc107;">
                    <strong>⚠️ 실무 고려사항:</strong><br>
                    • <strong>커버리지 부족:</strong> DP < 10인 경우 &lt;NON_REF&gt; 가능성 증가<br>
                    • <strong>반복 서열:</strong> 정렬 애매한 영역은 &lt;NON_REF&gt; 처리<br>
                    • <strong>품질 저하:</strong> 낮은 염기 품질은 불확실성 증가<br>
                    • <strong>식물 게놈:</strong> 복잡한 구조로 인한 &lt;NON_REF&gt; 비율 높음
                </div>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; margin: 15px 0; border-radius: 6px; border-left: 4px solid #6c757d;">
                <h5 style="color: #495057; margin: 0 0 10px 0;"><i class="fas fa-compress-arrows-alt"></i> 블록 압축 상세 예시</h5>
                <p style="font-size: 13px; margin-bottom: 15px;">gVCF의 핵심인 블록 압축이 어떻게 작동하는지 구체적인 예시로 살펴보겠습니다:</p>
                
                <div class="comparison-table" style="margin-top: 10px;">
                    <div class="comparison-item" style="border-left-color: #dc3545; background: #ffffff;">
                        <h4><i class="fas fa-times-circle"></i> 압축 없이 (모든 위치 개별 기록)</h4>
                        <div style="background: #1e1e1e; color: #f8f8f2; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 10px; margin: 10px 0; white-space: pre-wrap;">glyma.Wm82.gnm2.Gm01	1000	.	C	&lt;NON_REF&gt;	.	.	DP=32;GQ=90	GT:DP:GQ	0/0:32:90
glyma.Wm82.gnm2.Gm01	1001	.	A	&lt;NON_REF&gt;	.	.	DP=31;GQ=88	GT:DP:GQ	0/0:31:88
glyma.Wm82.gnm2.Gm01	1002	.	T	&lt;NON_REF&gt;	.	.	DP=30;GQ=85	GT:DP:GQ	0/0:30:85
glyma.Wm82.gnm2.Gm01	1003	.	G	&lt;NON_REF&gt;	.	.	DP=33;GQ=92	GT:DP:GQ	0/0:33:92
glyma.Wm82.gnm2.Gm01	1004	.	C	&lt;NON_REF&gt;	.	.	DP=32;GQ=89	GT:DP:GQ	0/0:32:89</div>
                        <ul style="font-size: 12px; color: #dc3545;">
                            <li><strong>라인 수:</strong> 5개 (각 위치마다)</li>
                            <li><strong>데이터 중복:</strong> 매우 높음</li>
                            <li><strong>파일 크기:</strong> 불필요하게 큼</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-item" style="border-left-color: #28a745; background: #ffffff;">
                        <h4><i class="fas fa-check-circle"></i> 블록 압축 적용 (END 태그 사용)</h4>
                        <div style="background: #1e1e1e; color: #f8f8f2; padding: 10px; border-radius: 4px; font-family: monospace; font-size: 10px; margin: 10px 0; white-space: pre-wrap;">glyma.Wm82.gnm2.Gm01	1000	.	C	&lt;NON_REF&gt;	.	.	END=1004;MIN_DP=30	GT:DP:GQ:MIN_DP	0/0:32:90:30</div>
                        <ul style="font-size: 12px; color: #28a745;">
                            <li><strong>라인 수:</strong> 1개 (5개 위치 압축)</li>
                            <li><strong>압축률:</strong> 5:1 효율</li>
                            <li><strong>정보 보존:</strong> MIN_DP로 최소값 기록</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: #e8f4fd; padding: 12px; margin: 15px 0; border-radius: 4px; font-size: 12px; border-left: 3px solid #3498db;">
                    <strong>🔍 END 태그 작동 원리:</strong><br>
                    • <strong>END=1004:</strong> 이 라인이 위치 1000부터 1004까지 모든 위치를 대표<br>
                    • <strong>MIN_DP=30:</strong> 해당 블록에서 가장 낮은 깊이값 기록<br>
                    • <strong>조건:</strong> 모든 위치가 동일한 유전자형(0/0)과 유사한 품질을 가져야 압축 가능<br>
                    • <strong>효과:</strong> 수백만 개 위치를 수천 개 블록으로 압축
                </div>
                
                <div style="background: #fff3cd; padding: 12px; margin: 15px 0; border-radius: 4px; font-size: 12px; border-left: 3px solid #ffc107;">
                    <strong>⚡ 실제 게놈에서의 압축 효과:</strong><br>
                    • <strong>콩 게놈 (~1Gb):</strong> 압축 없으면 ~10억 라인 → 압축 후 ~100만 라인<br>
                    • <strong>파일 크기:</strong> ~1TB → ~10GB (100:1 압축)<br>
                    • <strong>처리 속도:</strong> 메모리 사용량과 I/O 시간 대폭 단축<br>
                    • <strong>정확도:</strong> 정보 손실 없이 모든 위치 정보 보존
                </div>
            </div>
        </div>

        <h4>📊 실무 활용 시나리오</h4>
        <div class="setup-steps" style="background: #fff3cd; border-left-color: #ffc107;">
            <h5><i class="fas fa-sitemap"></i> 언제 VCF vs gVCF를 사용하는가?</h5>
            
            <div class="tool-comparison" style="grid-template-columns: 1fr 1fr 1fr;">
                <div class="tool-item" style="border-left-color: #28a745;">
                    <h4><i class="fas fa-user"></i> 단일 샘플 분석</h4>
                    <div style="background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; font-size: 12px;">
                        <strong>📋 워크플로우:</strong><br>
                        FASTQ → BAM → <strong>gVCF</strong> → VCF
                    </div>
                    <ul style="font-size: 12px;">
                        <li><strong>권장:</strong> gVCF로 시작</li>
                        <li><strong>이유:</strong> 나중에 추가 샘플과 합칠 수 있음</li>
                        <li><strong>최종:</strong> VCF로 변환해서 분석</li>
                    </ul>
                </div>
                
                <div class="tool-item" style="border-left-color: #f39c12;">
                    <h4><i class="fas fa-users"></i> 다중 샘플 분석</h4>
                    <div style="background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; font-size: 12px;">
                        <strong>📋 워크플로우:</strong><br>
                        개별 gVCF → <strong>합칠 gVCF</strong> → 공동 VCF
                    </div>
                    <ul style="font-size: 12px;">
                        <li><strong>필수:</strong> gVCF 필요</li>
                        <li><strong>이유:</strong> GenotypeGVCFs로 공동 호출</li>
                        <li><strong>장점:</strong> 희귀 변이 검출력 향상</li>
                    </ul>
                </div>
                
                <div class="tool-item" style="border-left-color: #e74c3c;">
                    <h4><i class="fas fa-download"></i> 공개 데이터 활용</h4>
                    <div style="background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; font-size: 12px;">
                        <strong>📋 일반적 형식:</strong><br>
                        dbSNP, ClinVar → <strong>VCF</strong>
                    </div>
                    <ul style="font-size: 12px;">
                        <li><strong>형태:</strong> 대부분 VCF</li>
                        <li><strong>이유:</strong> 확인된 변이만 공유</li>
                        <li><strong>활용:</strong> 주석, 필터링, 비교</li>
                    </ul>
                </div>
            </div>
        </div>

       
        <div class="setup-steps">
            <h4><i class="fas fa-table"></i> VCF 파일 구조</h4>
            <div class="fastq-example">
                <div style="font-weight: bold; margin-bottom: 10px;">##fileformat=VCFv4.2</div>
                <div style="font-weight: bold; margin-bottom: 10px;">##reference=soybean_genome.fa</div>
                <div style="font-weight: bold; margin-bottom: 5px;">#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	SAMPLE</div>
                <div style="font-family: monospace; font-size: 12px;">
glyma.Wm82.gnm2.Gm01	1000	.	A	G	60.0	PASS	DP=30;AF=0.5	GT:DP:GQ	0/1:30:60
                </div>
            </div>
            
            <table class="quality-table" style="margin-top: 15px;">
                <tr>
                    <th>컬럼</th>
                    <th>이름</th>
                    <th>설명</th>
                    <th>예시</th>
                </tr>
                <tr>
                    <td>CHROM</td>
                    <td>염색체</td>
                    <td>변이 위치의 염색체</td>
                    <td>glyma.Wm82.gnm2.Gm01</td>
                </tr>
                <tr>
                    <td>POS</td>
                    <td>위치</td>
                    <td>변이 발생 위치</td>
                    <td>1000</td>
                </tr>
                <tr>
                    <td>REF</td>
                    <td>참조 염기</td>
                    <td>참조 게놈의 염기</td>
                    <td>A</td>
                </tr>
                <tr>
                    <td>ALT</td>
                    <td>대체 염기</td>
                    <td>변이된 염기</td>
                    <td>G</td>
                </tr>
                <tr>
                    <td>QUAL</td>
                    <td>품질 점수</td>
                    <td>변이 호출 신뢰도</td>
                    <td>60.0</td>
                </tr>
                <tr style="background: #fff3cd;">
                    <td><strong>INFO</strong></td>
                    <td><strong>정보 필드</strong></td>
                    <td><strong>변이 특성 정보</strong></td>
                    <td><strong>DP=30;AF=0.5</strong></td>
                </tr>
                <tr>
                    <td>GT</td>
                    <td>유전자형</td>
                    <td>0/1 (헤테로), 1/1 (호모)</td>
                    <td>0/1</td>
                </tr>
            </table>
        </div>

        <h4>📊 VCF INFO 컬럼 상세 설명</h4>
        <div class="setup-steps" style="background: #fff3cd; border-left-color: #ffc107;">
            <h5><i class="fas fa-info-circle"></i> INFO 필드는 변이에 대한 다양한 주석 정보를 포함합니다</h5>
            
            <div style="background: #1e1e1e; color: #f8f8f2; padding: 12px; border-radius: 6px; font-family: monospace; font-size: 13px; margin: 15px 0;">
INFO=DP=45;AF=0.75;AC=3;AN=4;MQ=60.0;QD=18.2;FS=0.0;SOR=0.693;MQRankSum=-0.8;ReadPosRankSum=0.2
            </div>
            
            <div class="tool-comparison" style="grid-template-columns: 1fr;">
                <div class="tool-item" style="border-left-color: #28a745; margin-bottom: 15px;">
                    <h4><i class="fas fa-chart-bar"></i> 기본 통계 정보</h4>
                    <table class="quality-table" style="font-size: 13px;">
                        <tr>
                            <th style="width: 20%;">태그</th>
                            <th style="width: 30%;">이름</th>
                            <th style="width: 35%;">설명</th>
                            <th style="width: 15%;">예시값</th>
                        </tr>
                        <tr>
                            <td><strong>DP</strong></td>
                            <td>Total Depth</td>
                            <td>전체 리드 깊이 (모든 샘플)</td>
                            <td>45</td>
                        </tr>
                        <tr>
                            <td><strong>AF</strong></td>
                            <td>Allele Frequency</td>
                            <td>현재 샘플에서의 대립유전자 빈도 (0.0-1.0)</td>
                            <td>0.75</td>
                        </tr>
                        <tr>
                            <td><strong>AC</strong></td>
                            <td>Allele Count</td>
                            <td>대립유전자 개수</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td><strong>AN</strong></td>
                            <td>Allele Number</td>
                            <td>전체 대립유전자 수 (2 × 샘플수)</td>
                            <td>4</td>
                        </tr>
                    </table>
                    
                    <div style="background: #e8f4fd; padding: 12px; margin: 10px 0; border-radius: 4px; font-size: 12px; border-left: 3px solid #3498db;">
                        <strong>🔍 AF (Allele Frequency) 중요 구분:</strong><br>
                        • <strong>VCF INFO의 AF:</strong> 현재 분석 중인 샘플들에서의 빈도<br>
                        • <strong>집단 수준 AF:</strong> 전체 종 또는 집단에서의 빈도 (별도 데이터베이스)<br>
                        • <strong>계산:</strong> AF = AC / AN (대립유전자 개수 / 전체 대립유전자 수)<br>
                        • <strong>예시:</strong> 2개 샘플에서 AC=3, AN=4 → AF=0.75 (75%)
                    </div>
                    
                    <div style="background: #fff3cd; padding: 12px; margin: 10px 0; border-radius: 4px; font-size: 12px; border-left: 3px solid #ffc107;">
                        <strong>⚠️ 주의사항:</strong><br>
                        • VCF의 AF는 <strong>표본 특정적</strong>이며, 전체 집단을 대표하지 않음<br>
                        • 집단 수준 빈도는 dbSNP, gnomAD, 1000 Genomes 등에서 확인<br>
                        • 식물의 경우 집단 수준 데이터가 제한적일 수 있음<br>
                        • 단일 샘플 VCF에서 AF는 항상 0.0, 0.5, 또는 1.0
                    </div>
                </div>
                
                <div class="tool-item" style="border-left-color: #17a2b8; margin-bottom: 15px;">
                    <h4><i class="fas fa-microscope"></i> 품질 및 신뢰도 정보</h4>
                    <table class="quality-table" style="font-size: 13px;">
                        <tr>
                            <th style="width: 20%;">태그</th>
                            <th style="width: 30%;">이름</th>
                            <th style="width: 35%;">설명</th>
                            <th style="width: 15%;">예시값</th>
                        </tr>
                        <tr>
                            <td><strong>MQ</strong></td>
                            <td>Mapping Quality</td>
                            <td>정렬 품질 평균 (RMS)</td>
                            <td>60.0</td>
                        </tr>
                        <tr>
                            <td><strong>QD</strong></td>
                            <td>Quality by Depth</td>
                            <td>깊이당 품질 (QUAL/DP)</td>
                            <td>18.2</td>
                        </tr>
                        <tr>
                            <td><strong>FS</strong></td>
                            <td>Fisher Strand</td>
                            <td>스트랜드 편향 (낮을수록 좋음)</td>
                            <td>0.0</td>
                        </tr>
                        <tr>
                            <td><strong>SOR</strong></td>
                            <td>Strand Odds Ratio</td>
                            <td>스트랜드 비대칭성 (낮을수록 좋음)</td>
                            <td>0.693</td>
                        </tr>
                    </table>
                </div>
                
                <div class="tool-item" style="border-left-color: #dc3545; margin-bottom: 15px;">
                    <h4><i class="fas fa-balance-scale"></i> 통계적 검정 정보</h4>
                    <table class="quality-table" style="font-size: 13px;">
                        <tr>
                            <th style="width: 25%;">태그</th>
                            <th style="width: 30%;">이름</th>
                            <th style="width: 30%;">설명</th>
                            <th style="width: 15%;">예시값</th>
                        </tr>
                        <tr>
                            <td><strong>MQRankSum</strong></td>
                            <td>MQ Rank Sum Test</td>
                            <td>REF vs ALT 정렬품질 차이</td>
                            <td>-0.8</td>
                        </tr>
                        <tr>
                            <td><strong>ReadPosRankSum</strong></td>
                            <td>Read Position Rank Sum</td>
                            <td>REF vs ALT 리드 위치 편향</td>
                            <td>0.2</td>
                        </tr>
                        <tr>
                            <td><strong>BaseQRankSum</strong></td>
                            <td>Base Quality Rank Sum</td>
                            <td>REF vs ALT 염기품질 차이</td>
                            <td>1.2</td>
                        </tr>
                        <tr>
                            <td><strong>ClippingRankSum</strong></td>
                            <td>Clipping Rank Sum</td>
                            <td>REF vs ALT 클리핑 편향</td>
                            <td>0.0</td>
                        </tr>
                    </table>
                </div>
                
                <div class="tool-item" style="border-left-color: #f39c12; margin-bottom: 15px;">
                    <h4><i class="fas fa-dna"></i> 생물학적 정보</h4>
                    <table class="quality-table" style="font-size: 13px;">
                        <tr>
                            <th style="width: 20%;">태그</th>
                            <th style="width: 30%;">이름</th>
                            <th style="width: 35%;">설명</th>
                            <th style="width: 15%;">예시값</th>
                        </tr>
                        <tr>
                            <td><strong>TYPE</strong></td>
                            <td>Variant Type</td>
                            <td>변이 유형 (SNP, INDEL, etc.)</td>
                            <td>SNP</td>
                        </tr>
                        <tr>
                            <td><strong>LEN</strong></td>
                            <td>Variant Length</td>
                            <td>변이 길이 (INDEL의 경우)</td>
                            <td>-2</td>
                        </tr>
                        <tr>
                            <td><strong>EFF</strong></td>
                            <td>Effect</td>
                            <td>기능적 효과 (SnpEff 주석)</td>
                            <td>MISSENSE</td>
                        </tr>
                        <tr>
                            <td><strong>ANN</strong></td>
                            <td>Annotation</td>
                            <td>유전자 주석 정보</td>
                            <td>C|missense</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div style="background: #e8f4fd; padding: 15px; margin: 15px 0; border-radius: 6px; border-left: 4px solid #3498db;">
                <h5 style="color: #1976d2; margin: 0 0 10px 0;"><i class="fas fa-lightbulb"></i> INFO 필드 해석 가이드라인</h5>
                <div class="comparison-table" style="margin-top: 10px;">
                    <div class="comparison-item" style="border-left-color: #28a745; background: #ffffff;">
                        <h4><i class="fas fa-thumbs-up"></i> 고품질 변이 지표</h4>
                        <ul style="font-size: 13px;">
                            <li><strong>QD:</strong> > 2.0 (SNP), > 1.0 (INDEL)</li>
                            <li><strong>FS:</strong> < 60.0 (SNP), < 200.0 (INDEL)</li>
                            <li><strong>MQ:</strong> > 40.0</li>
                            <li><strong>SOR:</strong> < 3.0 (SNP), < 10.0 (INDEL)</li>
                            <li><strong>MQRankSum:</strong> > -12.5</li>
                            <li><strong>ReadPosRankSum:</strong> > -8.0</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-item" style="border-left-color: #dc3545; background: #ffffff;">
                        <h4><i class="fas fa-exclamation-triangle"></i> 필터링 기준</h4>
                        <ul style="font-size: 13px;">
                            <li><strong>낮은 QD:</strong> 위양성 가능성 높음</li>
                            <li><strong>높은 FS:</strong> 스트랜드 편향 존재</li>
                            <li><strong>낮은 MQ:</strong> 정렬 품질 문제</li>
                            <li><strong>극단적 RankSum:</strong> 체계적 편향</li>
                            <li><strong>낮은 DP:</strong> 통계적 신뢰도 부족</li>
                            <li><strong>극단적 AF:</strong> 오염 또는 오류 가능성</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        
        <h4>🧬 VCF 변이 유형 상세 예시</h4>
        <p>다양한 유형의 변이가 VCF에서 어떻게 표현되는지 살펴보겠습니다.</p>

        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #3498db;">
                <h4><i class="fas fa-exchange-alt"></i> 단순 SNP</h4>
                <div class="fastq-example" style="margin: 10px 0; font-size: 12px;">
glyma.Wm82.gnm2.Gm01	1000	.	A	G	60.0	PASS	DP=30;AF=0.5	GT:DP:GQ	0/1:30:60
                </div>
                <div style="background: #e3f2fd; padding: 10px; border-radius: 5px; font-size: 12px;">
                    <strong>해석:</strong><br>
                    • 위치: glyma.Wm82.gnm2.Gm01:1000<br>
                    • 참조: A → 변이: G<br>
                    • 유전자형: 0/1 (헤테로접합)<br>
                    • 변이 빈도: 50% (AF=0.5)
                </div>
            </div>
            
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4><i class="fas fa-plus"></i> 삽입 (Insertion)</h4>
                <div class="fastq-example" style="margin: 10px 0; font-size: 12px;">
glyma.Wm82.gnm2.Gm01	2000	.	C	CGAT	45.0	PASS	DP=25;AF=0.4	GT:DP:GQ	0/1:25:45
                </div>
                <div style="background: #fce4ec; padding: 10px; border-radius: 5px; font-size: 12px;">
                    <strong>해석:</strong><br>
                    • 위치: glyma.Wm82.gnm2.Gm01:2000<br>
                    • 참조: C → 변이: CGAT<br>
                    • 삽입: GAT (3bp 삽입)<br>
                    • 유전자형: 0/1 (헤테로접합)
                </div>
            </div>
        </div>

        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #f39c12;">
                <h4><i class="fas fa-minus"></i> 결실 (Deletion)</h4>
                <div class="fastq-example" style="margin: 10px 0; font-size: 12px;">
glyma.Wm82.gnm2.Gm01	3000	.	ATCG	A	55.0	PASS	DP=28;AF=0.6	GT:DP:GQ	0/1:28:55
                </div>
                <div style="background: #fff3e0; padding: 10px; border-radius: 5px; font-size: 12px;">
                    <strong>해석:</strong><br>
                    • 위치: glyma.Wm82.gnm2.Gm01:3000<br>
                    • 참조: ATCG → 변이: A<br>
                    • 결실: TCG (3bp 결실)<br>
                    • 유전자형: 0/1 (헤테로접합)
                </div>
            </div>
            
            <div class="comparison-item" style="border-left-color: #9b59b6;">
                <h4><i class="fas fa-layer-group"></i> 다중 대립유전자</h4>
                <div class="fastq-example" style="margin: 10px 0; font-size: 12px;">
glyma.Wm82.gnm2.Gm01	4000	.	G	A,T,C	70.0	PASS	DP=40;AF=0.3,0.2,0.1	GT:DP:GQ	1/2:40:70
                </div>
                <div style="background: #f3e5f5; padding: 10px; border-radius: 5px; font-size: 12px;">
                    <strong>해석:</strong><br>
                    • 위치: glyma.Wm82.gnm2.Gm01:4000<br>
                    • 참조: G (0번 대립유전자)<br>
                    • 변이: A (1번), T (2번), C (3번)<br>
                    • 유전자형: 1/2 (A/T 복합 헤테로)<br>
                    • 빈도: A=30%, T=20%, C=10%
                </div>
            </div>
        </div>

        <h4>🔢 다중 대립유전자 (Multi-allelic) 상세 분석</h4>
        <p>한 위치에서 여러 종류의 변이가 발견되는 경우를 자세히 살펴보겠습니다.</p>

        <div class="setup-steps">
            <h4><i class="fas fa-table"></i> 다중 대립유전자 VCF 예시</h4>
            <div class="fastq-example">
                <div style="font-weight: bold; margin-bottom: 10px;">##fileformat=VCFv4.2</div>
                <div style="font-weight: bold; margin-bottom: 5px;">#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO	FORMAT	Sample1	Sample2	Sample3</div>
                <div style="font-family: monospace; font-size: 11px; line-height: 1.3;">
glyma.Wm82.gnm2.Gm01	5000	rs123	C	A,G,T	80.0	PASS	DP=100;AF=0.4,0.3,0.2;AN=6;AC=2,2,1	GT:DP:GQ:AD	0/1:35:80:20,15,0,0	1/2:33:75:10,12,11,0	2/3:32:70:8,0,15,9
                </div>
            </div>
            
            <table class="quality-table" style="margin-top: 15px;">
                <tr>
                    <th>대립유전자</th>
                    <th>번호</th>
                    <th>서열</th>
                    <th>빈도 (AF)</th>
                    <th>개수 (AC)</th>
                </tr>
                <tr>
                    <td>REF</td>
                    <td>0</td>
                    <td>C</td>
                    <td>0.1 (10%)</td>
                    <td>1개</td>
                </tr>
                <tr>
                    <td>ALT1</td>
                    <td>1</td>
                    <td>A</td>
                    <td>0.4 (40%)</td>
                    <td>2개</td>
                </tr>
                <tr>
                    <td>ALT2</td>
                    <td>2</td>
                    <td>G</td>
                    <td>0.3 (30%)</td>
                    <td>2개</td>
                </tr>
                <tr>
                    <td>ALT3</td>
                    <td>3</td>
                    <td>T</td>
                    <td>0.2 (20%)</td>
                    <td>1개</td>
                </tr>
            </table>
        </div>

        <h4>👥 샘플별 유전자형 해석</h4>
        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #27ae60;">
                <h4><i class="fas fa-user"></i> Sample1: 0/1</h4>
                <ul style="font-size: 13px;">
                    <li><strong>유전자형:</strong> C/A (참조/변이1)</li>
                    <li><strong>깊이(DP):</strong> 35x</li>
                    <li><strong>대립유전자 깊이(AD):</strong> C=20, A=15</li>
                    <li><strong>품질(GQ):</strong> 80</li>
                    <li><strong>해석:</strong> 헤테로접합, 고품질</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #f39c12;">
                <h4><i class="fas fa-user"></i> Sample2: 1/2</h4>
                <ul style="font-size: 13px;">
                    <li><strong>유전자형:</strong> A/G (변이1/변이2)</li>
                    <li><strong>깊이(DP):</strong> 33x</li>
                    <li><strong>대립유전자 깊이(AD):</strong> C=10, A=12, G=11</li>
                    <li><strong>품질(GQ):</strong> 75</li>
                    <li><strong>해석:</strong> 복합 헤테로접합</li>
                </ul>
            </div>
        </div>

        <div class="comparison-table">
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4><i class="fas fa-user"></i> Sample3: 2/3</h4>
                <ul style="font-size: 13px;">
                    <li><strong>유전자형:</strong> G/T (변이2/변이3)</li>
                    <li><strong>깊이(DP):</strong> 32x</li>
                    <li><strong>대립유전자 깊이(AD):</strong> C=8, G=15, T=9</li>
                    <li><strong>품질(GQ):</strong> 70</li>
                    <li><strong>해석:</strong> 복합 헤테로접합</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #9b59b6;">
                <h4><i class="fas fa-chart-pie"></i> 집단 통계</h4>
                <ul style="font-size: 13px;">
                    <li><strong>총 대립유전자 수(AN):</strong> 6개 (3샘플 × 2염색체)</li>
                    <li><strong>가장 흔한 변이:</strong> A (40%)</li>
                    <li><strong>두 번째 흔한 변이:</strong> G (30%)</li>
                    <li><strong>참조 대립유전자:</strong> C (10%, 가장 드뭄)</li>
                    <li><strong>변이 다양성:</strong> 매우 높음</li>
                </ul>
            </div>
        </div>

        
</div>

<div class="navigation">
    <button class="jump-btn" onclick="jumpToIndex()">🏠 목차</button>
    <button class="nav-btn" onclick="prevSlide()">◀ 이전</button>
    <button class="nav-btn" onclick="nextSlide()">다음 ▶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">⛶ 전체화면</button>
</div>

<div class="slide-number">슬라이드 2 / 8</div>

<script>
    function prevSlide() {
        window.location.href = "slide01.html";
    }
    
    function nextSlide() {
        window.location.href = "slide03.html";
    }
    
    function jumpToIndex() {
        window.location.href = "index.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToIndex();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
    
    // Syntax highlighting function
    function highlightCode() {
        const codeBlocks = document.querySelectorAll('.code-block');
        
        codeBlocks.forEach(block => {
            const code = block.textContent;
            const language = block.classList.contains('python') ? 'python' : 
                           block.classList.contains('bash') ? 'bash' : 'python'; // default to python
            
            const highlightedCode = highlightSyntax(code, language);
            block.innerHTML = highlightedCode;
            
            // Add copy button
            addCopyButton(block, code);
        });
    }
    
    // Add copy button to code block
    function addCopyButton(codeBlock, originalCode) {
        // Check if copy button already exists
        const container = codeBlock.parentElement;
        if (container && container.querySelector('.copy-button')) {
            return; // Copy button already exists
        }
        
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-button';
        copyButton.textContent = 'Copy';
        copyButton.title = 'Copy code to clipboard';
        
        copyButton.addEventListener('click', function() {
            copyToClipboard(originalCode, copyButton);
        });
        
        // Append to container if it exists, otherwise to code block
        if (container && container.classList.contains('code-block-container')) {
            container.appendChild(copyButton);
        } else {
            codeBlock.style.position = 'relative'; // Ensure positioning context
            codeBlock.appendChild(copyButton);
        }
    }
    
    // Copy text to clipboard
    function copyToClipboard(text, button) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
            // Modern approach
            navigator.clipboard.writeText(text).then(function() {
                showCopySuccess(button);
            }).catch(function() {
                fallbackCopyToClipboard(text, button);
            });
        } else {
            // Fallback for older browsers
            fallbackCopyToClipboard(text, button);
        }
    }
    
    // Fallback copy method
    function fallbackCopyToClipboard(text, button) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            showCopySuccess(button);
        } catch (err) {
            console.error('Copy failed:', err);
        }
        
        document.body.removeChild(textArea);
    }
    
    // Show copy success feedback
    function showCopySuccess(button) {
        const originalText = button.textContent;
        button.textContent = 'Copied!';
        button.classList.add('copied');
        
        setTimeout(function() {
            button.textContent = originalText;
            button.classList.remove('copied');
        }, 2000);
    }
    
    function highlightSyntax(code, language) {
        if (language === 'python') {
            return highlightPython(code);
        } else if (language === 'bash') {
            return highlightBash(code);
        }
        return code;
    }
    
    function highlightPython(code) {
        let highlighted = code;
        
        // 1. Highlight strings first
        highlighted = highlighted.replace(/"[^"]*"/g, '<span class="string">$&</span>');
        highlighted = highlighted.replace(/'[^']*'/g, '<span class="string">$&</span>');
        
        // 2. Highlight comments
        highlighted = highlighted.replace(/#.*$/gm, '<span class="comment">$&</span>');
        
        // 3. Highlight keywords
        const keywords = ['import', 'from', 'def', 'if', 'else', 'elif', 'for', 'while', 'try', 'except', 'with', 'as', 'return', 'and', 'or', 'not', 'in', 'is', 'True', 'False', 'None'];
        keywords.forEach(keyword => {
            const regex = new RegExp(`\\b${keyword}\\b`, 'g');
            highlighted = highlighted.replace(regex, `<span class="keyword">${keyword}</span>`);
        });
        
        // 4. Highlight built-in functions
        const builtins = ['print', 'len', 'open', 'range', 'enumerate', 'gzip', 'os', 'plt', 'np', 'Counter'];
        builtins.forEach(builtin => {
            const regex = new RegExp(`\\b${builtin}\\b`, 'g');
            highlighted = highlighted.replace(regex, `<span class="builtin">${builtin}</span>`);
        });
        
        // 5. Highlight function definitions
        highlighted = highlighted.replace(/\b(def\s+)(\w+)/g, '$1<span class="function">$2</span>');
        
        // 6. Highlight numbers
        highlighted = highlighted.replace(/\b\d+\b/g, '<span class="number">$&</span>');
        
        return highlighted;
    }
    
    function highlightBash(code) {
        let highlighted = code;
        
        // Highlight comments
        highlighted = highlighted.replace(/#.*$/gm, '<span class="comment">$&</span>');
        
        // Highlight strings
        highlighted = highlighted.replace(/"[^"]*"/g, '<span class="string">$&</span>');
        highlighted = highlighted.replace(/'[^']*'/g, '<span class="string">$&</span>');
        
        // Highlight keywords
        const keywords = ['if', 'then', 'else', 'elif', 'fi', 'for', 'while', 'do', 'done', 'case', 'esac', 'function', 'return', 'local', 'export', 'echo', 'cd', 'ls', 'mkdir', 'cp', 'mv', 'rm', 'chmod', 'chown', 'grep', 'sed', 'awk', 'sort', 'uniq', 'wc', 'cat', 'head', 'tail'];
        keywords.forEach(keyword => {
            const regex = new RegExp(`\\b${keyword}\\b`, 'g');
            highlighted = highlighted.replace(regex, `<span class="keyword">${keyword}</span>`);
        });
        
        // Highlight variables
        highlighted = highlighted.replace(/\$\w+/g, '<span class="variable">$&</span>');
        
        return highlighted;
    }
    
    // Apply syntax highlighting when page loads
    document.addEventListener('DOMContentLoaded', highlightCode);
</script>

</body>
</html>