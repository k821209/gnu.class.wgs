<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹¤ìŠµ 3: ì°¸ì¡° ê²Œë†ˆ ì •ë ¬ - BWA-MEM ì •ë ¬ ë° BAM íŒŒì¼ ì²˜ë¦¬</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: #f5f5f5; }
        .slide { width: 100%; height: 100vh; display: block; padding: 40px; box-sizing: border-box; background: white; }
        .slide-title { font-size: 36px; font-weight: bold; color: #2c3e50; margin-bottom: 30px; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        .slide-content { font-size: 18px; line-height: 1.6; color: #34495e; }
        .slide-content h2 { color: #3498db; font-size: 24px; margin-top: 30px; }
        .slide-content h3 { color: #e74c3c; font-size: 20px; margin-top: 20px; }
        .slide-content ul { margin: 15px 0; padding-left: 30px; }
        .slide-content li { margin: 8px 0; }
        .highlight { background: #fff3cd; padding: 3px 8px; border-radius: 3px; }
        .code-block { background: #1e1e1e; color: #f8f8f2; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; font-size: 14px; white-space: pre-wrap; border: 1px solid #444; position: relative; }
        .code-block-container { position: relative; }
        .copy-button { position: absolute; top: 10px; right: 10px; background: #444; color: #f8f8f2; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; opacity: 0.7; transition: opacity 0.2s; }
        .copy-button:hover { opacity: 1; background: #555; }
        .copy-button.copied { background: #27ae60; color: white; }
        .copy-button.copied:after { content: " âœ“"; }
        
        /* Syntax highlighting color classes */
        .comment { color: #75715e; } /* Comments */
        .keyword { color: #f92672; } /* Keywords */
        .function { color: #a6e22e; } /* Function names */
        .string { color: #e6db74; } /* Strings */
        .number { color: #ae81ff; } /* Numbers */
        .param { color: #fd971f; } /* Parameters */
        .variable { color: #f8f8f2; } /* Variables */
        .builtin { color: #a6e22e; } /* Built-in functions */
        .operator { color: #f92672; } /* Operators */
        .shebang { color: #75715e; } /* Shebang */
        .navigation { position: fixed; bottom: 20px; right: 20px; z-index: 1000; }
        .nav-btn { background: #3498db; color: white; border: none; padding: 10px 20px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .nav-btn:hover { background: #2980b9; }
        .fullscreen-btn { background: #e74c3c; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .fullscreen-btn:hover { background: #c0392b; }
        .jump-btn { background: #3498db; color: white; border: none; padding: 10px 15px; margin: 0 5px; border-radius: 5px; cursor: pointer; }
        .jump-btn:hover { background: #2980b9; }
        .slide-number { position: fixed; bottom: 20px; left: 20px; color: #7f8c8d; font-size: 14px; }
        .comparison-table { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; }
        .comparison-item { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #3498db; }
        .comparison-item h4 { margin: 0 0 10px 0; color: #2c3e50; }
        .setup-steps { background: #e8f4fd; border-left: 4px solid #3498db; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .practical-box { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 20px; margin: 20px 0; }
        .exercise-box { background: #fff3cd; border-left: 4px solid #ffc107; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .result-box { background: #d4edda; border-left: 4px solid #28a745; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .warning-box { background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .step-box { background: #ffffff; border: 2px solid #3498db; border-radius: 8px; padding: 15px; margin: 10px 0; position: relative; }
        .step-box::before { content: "â†’"; position: absolute; right: -15px; top: 50%; transform: translateY(-50%); font-size: 24px; color: #3498db; }
        .step-box:last-child::before { display: none; }
        .terminal-output { background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 5px; font-family: 'Courier New', monospace; margin: 15px 0; font-size: 13px; white-space: pre-wrap; }
        .file-format-box { background: #ffffff; border: 2px solid #e67e22; border-radius: 8px; padding: 15px; margin: 15px 0; }
        .alignment-stats { background: #e8f4fd; padding: 15px; border-radius: 5px; margin: 15px 0; }
        .performance-tip { background: #f0f8ff; border-left: 4px solid #007bff; padding: 15px; margin: 15px 0; border-radius: 8px; }
    </style>
</head>
<body>

<div class="slide">
    <div class="slide-title">ğŸ§¬ ì‹¤ìŠµ 3: ì°¸ì¡° ê²Œë†ˆ ì •ë ¬</div>
    <div class="slide-content">
        <h2>ğŸ¯ ì‹¤ìŠµ ëª©í‘œ</h2>
        <p>ì „ì²˜ë¦¬ëœ FASTQ íŒŒì¼ì„ ì°¸ì¡° ê²Œë†ˆì— ì •ë ¬í•˜ê³ , BAM íŒŒì¼ì„ ìƒì„±í•˜ì—¬ ì •ë ¬ í’ˆì§ˆì„ í‰ê°€í•˜ëŠ” ì‹¤ìŠµì„ ì§„í–‰í•©ë‹ˆë‹¤.</p>

        <div class="comparison-table">
            <div class="comparison-item">
                <h4><i class="fas fa-bullseye"></i> í•™ìŠµ ëª©í‘œ</h4>
                <ul>
                    <li>BWA-MEM ì •ë ¬ ì•Œê³ ë¦¬ì¦˜ ì´í•´</li>
                    <li>ì°¸ì¡° ê²Œë†ˆ ì¸ë±ìŠ¤ ìƒì„±</li>
                    <li>SAM/BAM íŒŒì¼ êµ¬ì¡° ì´í•´</li>
                    <li>ì •ë ¬ í’ˆì§ˆ í‰ê°€</li>
                    <li>ì •ë ¬ í†µê³„ ë¶„ì„</li>
                </ul>
            </div>
            
            <div class="comparison-item" style="border-left-color: #e74c3c;">
                <h4><i class="fas fa-tools"></i> ì‚¬ìš© ë„êµ¬</h4>
                <ul>
                    <li><strong>BWA-MEM:</strong> ì‹œí€€ìŠ¤ ì •ë ¬ ì•Œê³ ë¦¬ì¦˜</li>
                    <li><strong>SAMtools:</strong> SAM/BAM íŒŒì¼ ì²˜ë¦¬</li>
                    <li><strong>Picard:</strong> ì¤‘ë³µ ì œê±° ë° í’ˆì§ˆ ê°œì„ </li>
                    <li><strong>Python:</strong> ì •ë ¬ í†µê³„ ë¶„ì„</li>
                </ul>
            </div>
        </div>

        <h2>ğŸ“‹ ì‹¤ìŠµ ì›Œí¬í”Œë¡œìš°</h2>
        <div class="practical-box">
            <div class="step-box">
                <h4><i class="fas fa-database"></i> 1ë‹¨ê³„: ì°¸ì¡° ê²Œë†ˆ ì¤€ë¹„</h4>
                <p>ì½© ì°¸ì¡° ê²Œë†ˆ ë‹¤ìš´ë¡œë“œ ë° BWA ì¸ë±ìŠ¤ ìƒì„±</p>
            </div>

            <div class="step-box">
                <h4><i class="fas fa-sort"></i> 2ë‹¨ê³„: BWA-MEM ì •ë ¬</h4>
                <p>ì „ì²˜ë¦¬ëœ FASTQ íŒŒì¼ì„ ì°¸ì¡° ê²Œë†ˆì— ì •ë ¬</p>
            </div>

            <div class="step-box">
                <h4><i class="fas fa-file-code"></i> 3ë‹¨ê³„: BAM íŒŒì¼ ì²˜ë¦¬</h4>
                <p>SAMì„ BAMìœ¼ë¡œ ë³€í™˜, ì •ë ¬ ë° ì¸ë±ìŠ¤ ìƒì„±</p>
            </div>

            <div class="step-box">
                <h4><i class="fas fa-chart-bar"></i> 4ë‹¨ê³„: ì •ë ¬ í’ˆì§ˆ í‰ê°€</h4>
                <p>ì •ë ¬ í†µê³„ ë¶„ì„ ë° í’ˆì§ˆ í‰ê°€</p>
            </div>

            <div class="step-box">
                <h4><i class="fas fa-broom"></i> 5ë‹¨ê³„: ì¤‘ë³µ ì œê±°</h4>
                <p>PCR ì¤‘ë³µ ì œê±° ë° ìµœì¢… BAM íŒŒì¼ ìƒì„±</p>
            </div>
        </div>

        <h2>ğŸ—‚ï¸ 1ë‹¨ê³„: ì°¸ì¡° ê²Œë†ˆ ì¤€ë¹„</h2>
        <div class="setup-steps">
            <h3><i class="fas fa-download"></i> ì°¸ì¡° ê²Œë†ˆ ë‹¤ìš´ë¡œë“œ</h3>
            <p>ì‹¤ìŠµì—ì„œëŠ” ì½©(Glycine max) ì°¸ì¡° ê²Œë†ˆì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
            
            <div class="code-block-container">
                <div class="code-block bash">
# ì°¸ì¡° ê²Œë†ˆ ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p /home/ubuntu/edu/reference
cd /home/ubuntu/edu/reference

# ì½© ì°¸ì¡° ê²Œë†ˆ ë‹¤ìš´ë¡œë“œ (ì˜ˆì‹œ)
wget -O soybean_genome.fa.gz "https://example.com/soybean_genome.fasta.gz"

# ì°¸ì¡° ê²Œë†ˆ í¬ê¸° í™•ì¸
ls -lh soybean_genome.fa.gz
</div>
            </div>
        </div>

        <div class="exercise-box">
            <h3><i class="fas fa-tasks"></i> BWA ì¸ë±ìŠ¤ ìƒì„±</h3>
            <p>BWA-MEM ì •ë ¬ì„ ìœ„í•´ ì°¸ì¡° ê²Œë†ˆì˜ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.</p>
            
            <div class="code-block-container">
                <div class="code-block bash">
# BWA ì¸ë±ìŠ¤ ìƒì„± (ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆìŒ)
bwa index soybean_genome.fa.gz

# ìƒì„±ëœ ì¸ë±ìŠ¤ íŒŒì¼ í™•ì¸
ls -la soybean_genome.fa.gz.*
</div>
            </div>
            
            <div class="terminal-output">
soybean_genome.fa.gz.amb
soybean_genome.fa.gz.ann
soybean_genome.fa.gz.bwt
soybean_genome.fa.gz.pac
soybean_genome.fa.gz.sa
</div>
        </div>

        <h2>ğŸ”„ 2ë‹¨ê³„: BWA-MEM ì •ë ¬</h2>
        <div class="practical-box">
            <h3><i class="fas fa-play"></i> ì •ë ¬ ì‹¤í–‰</h3>
            <p>ì „ì²˜ë¦¬ëœ FASTQ íŒŒì¼ì„ ì°¸ì¡° ê²Œë†ˆì— ì •ë ¬í•©ë‹ˆë‹¤.</p>
            
            <div class="code-block-container">
                <div class="code-block bash">
# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
cd /home/ubuntu/edu/
mkdir -p alignment_results

# BWA-MEM ì •ë ¬ ì‹¤í–‰
bwa mem -t 4 \
    -R "@RG\tID:soybean_sample\tSM:soybean\tPL:illumina\tLB:lib1\tPU:unit1" \
    /home/ubuntu/edu/reference/soybean_genome.fa.gz \
    trimmed_data/ERR3184150_1_paired.fastq.gz \
    trimmed_data/ERR3184150_2_paired.fastq.gz \
    > alignment_results/soybean_aligned.sam

# ì •ë ¬ ì§„í–‰ ìƒí™© í™•ì¸
ls -lh alignment_results/
</div>
            </div>
        </div>

        <div class="performance-tip">
            <h4><i class="fas fa-lightbulb"></i> ì„±ëŠ¥ ìµœì í™” íŒ</h4>
            <ul>
                <li><strong>-t ì˜µì…˜:</strong> ì‚¬ìš©í•  CPU ì½”ì–´ ìˆ˜ ì§€ì • (ê¸°ë³¸ê°’: 1)</li>
                <li><strong>-R ì˜µì…˜:</strong> Read Group ì •ë³´ ì¶”ê°€ (GATK ë“±ì—ì„œ í•„ìš”)</li>
                <li><strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰:</strong> ì°¸ì¡° ê²Œë†ˆ í¬ê¸°ì— ë”°ë¼ 4-8GB ë©”ëª¨ë¦¬ í•„ìš”</li>
                <li><strong>ì²˜ë¦¬ ì‹œê°„:</strong> ë°ì´í„° í¬ê¸°ì— ë”°ë¼ 30ë¶„-2ì‹œê°„ ì†Œìš”</li>
            </ul>
        </div>

        <h2>ğŸ“ 3ë‹¨ê³„: BAM íŒŒì¼ ì²˜ë¦¬</h2>
        <div class="practical-box">
            <h3><i class="fas fa-exchange-alt"></i> SAM to BAM ë³€í™˜</h3>
            <p>SAM íŒŒì¼ì„ BAM íŒŒì¼ë¡œ ë³€í™˜í•˜ê³  ì •ë ¬í•©ë‹ˆë‹¤.</p>
            
            <div class="code-block-container">
                <div class="code-block bash">
# SAMì„ BAMìœ¼ë¡œ ë³€í™˜ ë° ì •ë ¬
samtools view -bS alignment_results/soybean_aligned.sam | \
samtools sort -o alignment_results/soybean_sorted.bam

# BAM íŒŒì¼ ì¸ë±ìŠ¤ ìƒì„±
samtools index alignment_results/soybean_sorted.bam

# íŒŒì¼ í¬ê¸° ë¹„êµ
ls -lh alignment_results/soybean_aligned.sam
ls -lh alignment_results/soybean_sorted.bam*
</div>
            </div>
        </div>

        <div class="file-format-box">
            <h4><i class="fas fa-file-alt"></i> SAM/BAM íŒŒì¼ êµ¬ì¡°</h4>
            <div class="comparison-table">
                <div class="comparison-item" style="border-left-color: #28a745;">
                    <h4>SAM (Sequence Alignment Map)</h4>
                    <ul>
                        <li>í…ìŠ¤íŠ¸ í˜•ì‹</li>
                        <li>í—¤ë” ì„¹ì…˜ + ì •ë ¬ ì„¹ì…˜</li>
                        <li>ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆìŒ</li>
                        <li>íŒŒì¼ í¬ê¸°ê°€ í¼</li>
                    </ul>
                </div>
                
                <div class="comparison-item" style="border-left-color: #007bff;">
                    <h4>BAM (Binary Alignment Map)</h4>
                    <ul>
                        <li>ë°”ì´ë„ˆë¦¬ í˜•ì‹</li>
                        <li>SAMì˜ ì••ì¶•ëœ í˜•íƒœ</li>
                        <li>ë¹ ë¥¸ ì²˜ë¦¬ ì†ë„</li>
                        <li>íŒŒì¼ í¬ê¸°ê°€ ì‘ìŒ</li>
                    </ul>
                </div>
            </div>
        </div>

        <h2>ğŸ“Š 4ë‹¨ê³„: ì •ë ¬ í’ˆì§ˆ í‰ê°€</h2>
        <div class="practical-box">
            <h3><i class="fas fa-chart-line"></i> ì •ë ¬ í†µê³„ ë¶„ì„</h3>
            
            <div class="code-block-container">
                <div class="code-block bash">
# ì •ë ¬ í†µê³„ í™•ì¸
samtools flagstat alignment_results/soybean_sorted.bam

# ì •ë ¬ í’ˆì§ˆ ìƒì„¸ ë¶„ì„
samtools stats alignment_results/soybean_sorted.bam > alignment_results/alignment_stats.txt

# ì»¤ë²„ë¦¬ì§€ ë¶„ì„
samtools depth alignment_results/soybean_sorted.bam | head -20
</div>
            </div>
        </div>

        <div class="exercise-box">
            <h3><i class="fas fa-code"></i> Pythonì„ ì´ìš©í•œ ì •ë ¬ í†µê³„ ë¶„ì„</h3>
            
            <div class="code-block-container">
                <div class="code-block python">
# !pip install koreanize-matplotlib í„°ë¯¸ë„ì— ì…ë ¥í•˜ì—¬ ì„¤ì¹˜
# ì„¤ì¹˜ í›„ importë¡œ ë¶ˆëŸ¬ì˜¤ê¸°

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import subprocess
import numpy as np
import koreanize_matplotlib

def analyze_alignment_stats(bam_file):
    """BAM íŒŒì¼ì˜ ì •ë ¬ í†µê³„ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤."""
    
    # samtools flagstat ì‹¤í–‰
    result = subprocess.run(['samtools', 'flagstat', bam_file], 
                          capture_output=True, text=True)
    
    stats = {}
    lines = result.stdout.strip().split('\n')
    
    for line in lines:
        if 'total' in line:
            stats['total_reads'] = int(line.split()[0])
        elif 'mapped' in line and 'primary' not in line:
            stats['mapped_reads'] = int(line.split()[0])
        elif 'properly paired' in line:
            stats['properly_paired'] = int(line.split()[0])
        elif 'duplicates' in line:
            stats['duplicates'] = int(line.split()[0])
    
    return stats

def plot_alignment_summary(stats):
    """ì •ë ¬ í†µê³„ë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤."""
    
    fig, axes = plt.subplots(1, 2, figsize=(15, 6))
    
    # ì •ë ¬ ì„±ê³µë¥ 
    mapped_rate = (stats['mapped_reads'] / stats['total_reads']) * 100
    paired_rate = (stats['properly_paired'] / stats['total_reads']) * 100
    
    categories = ['Mapped', 'Properly Paired', 'Duplicates']
    values = [mapped_rate, paired_rate, 
              (stats['duplicates'] / stats['total_reads']) * 100]
    
    axes[0].bar(categories, values, color=['#2ecc71', '#3498db', '#e74c3c'])
    axes[0].set_ylabel('Percentage (%)')
    axes[0].set_title('Alignment Quality Metrics')
    axes[0].set_ylim(0, 100)
    
    # ë¦¬ë“œ ë¶„í¬
    read_counts = [stats['mapped_reads'], 
                   stats['total_reads'] - stats['mapped_reads']]
    labels = ['Mapped', 'Unmapped']
    colors = ['#2ecc71', '#e74c3c']
    
    axes[1].pie(read_counts, labels=labels, colors=colors, autopct='%1.1f%%')
    axes[1].set_title('Read Mapping Distribution')
    
    plt.tight_layout()
    plt.savefig('alignment_summary.png', dpi=300, bbox_inches='tight')
    plt.show()
    
    return stats

# ì‹¤í–‰ ì˜ˆì‹œ
bam_file = '/home/ubuntu/edu/soybean_data/alignment_results/soybean_sorted.bam'
stats = analyze_alignment_stats(bam_file)
plot_alignment_summary(stats)

print("ì •ë ¬ í†µê³„ ìš”ì•½:")
print(f"ì „ì²´ ë¦¬ë“œ ìˆ˜: {stats['total_reads']:,}")
print(f"ì •ë ¬ëœ ë¦¬ë“œ ìˆ˜: {stats['mapped_reads']:,}")
print(f"ì •ë ¬ ì„±ê³µë¥ : {(stats['mapped_reads']/stats['total_reads'])*100:.2f}%")
print(f"Properly paired: {(stats['properly_paired']/stats['total_reads'])*100:.2f}%")
</div>
            </div>
        </div>

        <div class="result-box">
            <h4><i class="fas fa-chart-bar"></i> ì˜ˆìƒ ê²°ê³¼</h4>
            <div class="terminal-output">
ì •ë ¬ í†µê³„ ìš”ì•½:
ì „ì²´ ë¦¬ë“œ ìˆ˜: 2,000,000
ì •ë ¬ëœ ë¦¬ë“œ ìˆ˜: 1,850,000 (92.5%)
ì •ë ¬ ì„±ê³µë¥ : 92.50%
Properly paired: 1,750,000 (87.5%)
ì¤‘ë³µ ë¦¬ë“œ: 150,000 (7.5%)
            </div>
        </div>

        <h2>ğŸ§¹ 5ë‹¨ê³„: ì¤‘ë³µ ì œê±°</h2>
        <div class="practical-box">
            <h3><i class="fas fa-broom"></i> Picardë¥¼ ì´ìš©í•œ ì¤‘ë³µ ì œê±°</h3>
            <p>PCR ì¤‘ë³µì„ ì œê±°í•˜ì—¬ ì •í™•í•œ ë³€ì´ í˜¸ì¶œì„ ìœ„í•œ ìµœì¢… BAM íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
            
            <div class="code-block-container">
                <div class="code-block bash">
# Picardë¥¼ ì´ìš©í•œ ì¤‘ë³µ ì œê±°
java -jar /opt/picard/picard.jar MarkDuplicates \
    I=alignment_results/soybean_sorted.bam \
    O=alignment_results/soybean_dedup.bam \
    M=alignment_results/duplicate_metrics.txt \
    REMOVE_DUPLICATES=true

# ì¤‘ë³µ ì œê±°ëœ BAM íŒŒì¼ ì¸ë±ìŠ¤ ìƒì„±
samtools index alignment_results/soybean_dedup.bam

# ì¤‘ë³µ ì œê±° ì „í›„ ë¹„êµ
samtools flagstat alignment_results/soybean_sorted.bam
samtools flagstat alignment_results/soybean_dedup.bam
</div>
            </div>
        </div>

        <div class="exercise-box">
            <h3><i class="fas fa-tasks"></i> ì‹¤ìŠµ ê³¼ì œ</h3>
            <ol>
                <li>ì •ë ¬ ì„±ê³µë¥ ì´ 90% ì´ìƒì¸ì§€ í™•ì¸í•˜ì„¸ìš”</li>
                <li>ì¤‘ë³µ ì œê±° ì „í›„ì˜ ë¦¬ë“œ ìˆ˜ ë³€í™”ë¥¼ ë¹„êµí•˜ì„¸ìš”</li>
                <li>ì°¸ì¡° ê²Œë†ˆì˜ ì»¤ë²„ë¦¬ì§€ ë¶„í¬ë¥¼ ë¶„ì„í•˜ì„¸ìš”</li>
                <li>ì •ë ¬ í’ˆì§ˆ ì ìˆ˜ ë¶„í¬ë¥¼ ì‹œê°í™”í•˜ì„¸ìš”</li>
            </ol>
        </div>

        <div class="warning-box">
            <h4><i class="fas fa-exclamation-triangle"></i> ì£¼ì˜ì‚¬í•­</h4>
            <ul>
                <li><strong>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰:</strong> ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì‹œ ì¶©ë¶„í•œ ë©”ëª¨ë¦¬ í™•ë³´</li>
                <li><strong>ë””ìŠ¤í¬ ê³µê°„:</strong> ì„ì‹œ íŒŒì¼ë¡œ ì¸í•œ ë””ìŠ¤í¬ ê³µê°„ ë¶€ì¡± ì£¼ì˜</li>
                <li><strong>Read Group ì •ë³´:</strong> ë‹¤ìŒ ë‹¨ê³„ ë¶„ì„ì„ ìœ„í•´ í•„ìˆ˜</li>
                <li><strong>íŒŒì¼ ë°±ì—…:</strong> ì¤‘ê°„ ê²°ê³¼ íŒŒì¼ ë°±ì—… ê¶Œì¥</li>
            </ul>
        </div>

    </div>
</div>

<div class="navigation">
    <button class="nav-btn" onclick="window.location.href='slide05.html'">â—€ ì´ì „</button>
    <button class="nav-btn" onclick="window.location.href='slide07.html'">ë‹¤ìŒ â–¶</button>
    <button class="fullscreen-btn" onclick="toggleFullscreen()">â›¶</button>
    <button class="jump-btn" onclick="jumpToSlide()">ì´ë™</button>
</div>

<div class="slide-number">ìŠ¬ë¼ì´ë“œ 6</div>

<script>
    function prevSlide() {
        window.location.href = "slide05.html";
    }
    
    function nextSlide() {
        window.location.href = "slide07.html";
    }
    
    function jumpToIndex() {
        window.location.href = "index.html";
    }
    
    function toggleFullscreen() {
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }
    
    // Keyboard navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
            nextSlide();
        } else if (e.key === 'ArrowLeft') {
            prevSlide();
        } else if (e.key === 'Home') {
            jumpToIndex();
        } else if (e.key === 'F11') {
            e.preventDefault();
            toggleFullscreen();
        }
    });
    
    // Syntax highlighting function
    function highlightCode() {
        const codeBlocks = document.querySelectorAll('.code-block');
        
        codeBlocks.forEach(block => {
            const code = block.textContent;
            const language = block.classList.contains('python') ? 'python' : 
                           block.classList.contains('bash') ? 'bash' : 'python'; // default to python
            
            const highlightedCode = highlightSyntax(code, language);
            block.innerHTML = highlightedCode;
            
            // Add copy button
            addCopyButton(block, code);
        });
    }
    
    // Add copy button to code block
    function addCopyButton(codeBlock, originalCode) {
        // Check if copy button already exists
        const container = codeBlock.parentElement;
        if (container && container.querySelector('.copy-button')) {
            return; // Copy button already exists
        }
        
        const copyButton = document.createElement('button');
        copyButton.className = 'copy-button';
        copyButton.textContent = 'Copy';
        copyButton.title = 'Copy code to clipboard';
        
        copyButton.addEventListener('click', function() {
            copyToClipboard(originalCode, copyButton);
        });
        
        // Append to container if it exists, otherwise to code block
        if (container && container.classList.contains('code-block-container')) {
            container.appendChild(copyButton);
        } else {
            codeBlock.style.position = 'relative'; // Ensure positioning context
            codeBlock.appendChild(copyButton);
        }
    }
    
    // Copy text to clipboard
    function copyToClipboard(text, button) {
        if (navigator.clipboard && navigator.clipboard.writeText) {
            // Modern approach
            navigator.clipboard.writeText(text).then(function() {
                showCopySuccess(button);
            }).catch(function() {
                fallbackCopyToClipboard(text, button);
            });
        } else {
            // Fallback for older browsers
            fallbackCopyToClipboard(text, button);
        }
    }
    
    // Fallback copy method
    function fallbackCopyToClipboard(text, button) {
        const textArea = document.createElement('textarea');
        textArea.value = text;
        textArea.style.position = 'fixed';
        textArea.style.left = '-999999px';
        textArea.style.top = '-999999px';
        document.body.appendChild(textArea);
        textArea.focus();
        textArea.select();
        
        try {
            document.execCommand('copy');
            showCopySuccess(button);
        } catch (err) {
            console.error('Copy failed:', err);
        }
        
        document.body.removeChild(textArea);
    }
    
    // Show copy success feedback
    function showCopySuccess(button) {
        const originalText = button.textContent;
        button.textContent = 'Copied!';
        button.classList.add('copied');
        
        setTimeout(function() {
            button.textContent = originalText;
            button.classList.remove('copied');
        }, 2000);
    }
    
    function highlightSyntax(code, language) {
        if (language === 'python') {
            return highlightPython(code);
        } else if (language === 'bash') {
            return highlightBash(code);
        }
        return code;
    }
    
    function highlightPython(code) {
        let highlighted = code;
        
        // 1. Highlight strings first
        highlighted = highlighted.replace(/"[^"]*"/g, '<span class="string">$&</span>');
        highlighted = highlighted.replace(/'[^']*'/g, '<span class="string">$&</span>');
        
        // 2. Highlight comments
        highlighted = highlighted.replace(/#.*$/gm, '<span class="comment">$&</span>');
        
        // 3. Highlight keywords
        const keywords = ['import', 'from', 'def', 'if', 'else', 'elif', 'for', 'while', 'try', 'except', 'with', 'as', 'return', 'and', 'or', 'not', 'in', 'is', 'True', 'False', 'None'];
        keywords.forEach(keyword => {
            const regex = new RegExp(`\\b${keyword}\\b`, 'g');
            highlighted = highlighted.replace(regex, `<span class="keyword">${keyword}</span>`);
        });
        
        // 4. Highlight built-in functions
        const builtins = ['print', 'len', 'open', 'range', 'enumerate', 'gzip', 'os', 'plt', 'np', 'Counter', 'subprocess', 'pd', 'sns', 'matplotlib'];
        builtins.forEach(builtin => {
            const regex = new RegExp(`\\b${builtin}\\b`, 'g');
            highlighted = highlighted.replace(regex, `<span class="builtin">${builtin}</span>`);
        });
        
        // 5. Highlight function definitions
        highlighted = highlighted.replace(/\b(def\s+)(\w+)/g, '$1<span class="function">$2</span>');
        
        // 6. Highlight numbers
        highlighted = highlighted.replace(/\b\d+\b/g, '<span class="number">$&</span>');
        
        return highlighted;
    }
    
    function highlightBash(code) {
        const keywords = ['if', 'then', 'else', 'elif', 'fi', 'for', 'while', 'do', 'done', 'case', 'esac', 'function', 'return', 'local', 'export', 'echo', 'cd', 'ls', 'mkdir', 'cp', 'mv', 'rm', 'chmod', 'chown', 'grep', 'sed', 'awk', 'sort', 'uniq', 'wc', 'cat', 'head', 'tail', 'bwa', 'samtools', 'java'];
        
        // Split into lines to process line by line (avoids conflicts)
        const lines = code.split('\n');
        const highlightedLines = [];
        
        for (let line of lines) {
            let highlighted = line;
            
            // Skip if line is empty
            if (!highlighted.trim()) {
                highlightedLines.push(highlighted);
                continue;
            }
            
            // 1. Highlight shebang
            if (highlighted.match(/^#!/)) {
                highlighted = highlighted.replace(/^(#!.*)$/, '<span class="shebang">$1</span>');
                highlightedLines.push(highlighted);
                continue;
            }
            
            // 2. Highlight full-line comments
            if (highlighted.trim().startsWith('#')) {
                highlighted = highlighted.replace(/^(\s*)(#.*)$/, '$1<span class="comment">$2</span>');
                highlightedLines.push(highlighted);
                continue;
            }
            
            // 3. Highlight strings
            highlighted = highlighted.replace(/("[^"]*")/g, '<span class="string">$1</span>');
            highlighted = highlighted.replace(/('[^']*')/g, '<span class="string">$1</span>');
            
            // 4. Highlight inline comments (after code)
            highlighted = highlighted.replace(/(\s+)(#.*)$/, '$1<span class="comment">$2</span>');
            
            // 5. Highlight variables
            highlighted = highlighted.replace(/(\$\w+)/g, '<span class="variable">$1</span>');
            
            // 6. Highlight keywords
            keywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'g');
                highlighted = highlighted.replace(regex, `<span class="keyword">${keyword}</span>`);
            });
            
            highlightedLines.push(highlighted);
        }
        
        return highlightedLines.join('\n');
    }
    
    // Apply syntax highlighting when page loads
    document.addEventListener('DOMContentLoaded', highlightCode);
</script>

</body>
</html>